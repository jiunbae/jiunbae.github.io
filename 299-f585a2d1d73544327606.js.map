{"version":3,"file":"299-f585a2d1d73544327606.js","mappings":"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","sources":["webpack://jiunbae.github.io/./src/views/TerrainGen/engine.ts"],"sourcesContent":["/**\n * Three.js terrain generator with multi-octave simplex noise,\n * hydraulic erosion, biome coloring, and water plane.\n */\n\nimport * as THREE from 'three'\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js'\n\n// ── Seeded PRNG (mulberry32) ────────────────────────────────────────\n\nfunction mulberry32(seed: number): () => number {\n  return () => {\n    seed |= 0\n    seed = (seed + 0x6d2b79f5) | 0\n    let t = Math.imul(seed ^ (seed >>> 15), 1 | seed)\n    t = (t + Math.imul(t ^ (t >>> 7), 61 | t)) ^ t\n    return ((t ^ (t >>> 14)) >>> 0) / 4294967296\n  }\n}\n\n// ── Simplex-like 2D noise ───────────────────────────────────────────\n\nclass SimplexNoise2D {\n  private perm: number[]\n  private grad: [number, number][] = [\n    [1, 1], [-1, 1], [1, -1], [-1, -1],\n    [1, 0], [-1, 0], [0, 1], [0, -1]\n  ]\n\n  constructor(rng: () => number) {\n    const p: number[] = []\n    for (let i = 0; i < 256; i++) p[i] = i\n    // Fisher-Yates shuffle with seeded rng\n    for (let i = 255; i > 0; i--) {\n      const j = Math.floor(rng() * (i + 1));\n      [p[i], p[j]] = [p[j], p[i]]\n    }\n    this.perm = [...p, ...p]\n  }\n\n  private dot(g: [number, number], x: number, y: number): number {\n    return g[0] * x + g[1] * y\n  }\n\n  noise(xin: number, yin: number): number {\n    const F2 = 0.5 * (Math.sqrt(3) - 1)\n    const G2 = (3 - Math.sqrt(3)) / 6\n    const s = (xin + yin) * F2\n    const i = Math.floor(xin + s)\n    const j = Math.floor(yin + s)\n    const t = (i + j) * G2\n    const X0 = i - t\n    const Y0 = j - t\n    const x0 = xin - X0\n    const y0 = yin - Y0\n\n    let i1: number, j1: number\n    if (x0 > y0) { i1 = 1; j1 = 0 }\n    else { i1 = 0; j1 = 1 }\n\n    const x1 = x0 - i1 + G2\n    const y1 = y0 - j1 + G2\n    const x2 = x0 - 1 + 2 * G2\n    const y2 = y0 - 1 + 2 * G2\n\n    const ii = i & 255\n    const jj = j & 255\n    const gi0 = this.perm[ii + this.perm[jj]] % 8\n    const gi1 = this.perm[ii + i1 + this.perm[jj + j1]] % 8\n    const gi2 = this.perm[ii + 1 + this.perm[jj + 1]] % 8\n\n    let n0 = 0, n1 = 0, n2 = 0\n    let t0 = 0.5 - x0 * x0 - y0 * y0\n    if (t0 >= 0) { t0 *= t0; n0 = t0 * t0 * this.dot(this.grad[gi0], x0, y0) }\n    let t1 = 0.5 - x1 * x1 - y1 * y1\n    if (t1 >= 0) { t1 *= t1; n1 = t1 * t1 * this.dot(this.grad[gi1], x1, y1) }\n    let t2 = 0.5 - x2 * x2 - y2 * y2\n    if (t2 >= 0) { t2 *= t2; n2 = t2 * t2 * this.dot(this.grad[gi2], x2, y2) }\n\n    // Result in [-1, 1]\n    return 70 * (n0 + n1 + n2)\n  }\n}\n\n// ── Biome color palette ─────────────────────────────────────────────\n\n// Pre-allocated Color instance reused by getBiomeColor (H-3 fix: avoids 65K allocations per rebuild)\nconst _biomeColor = new THREE.Color()\n\nfunction getBiomeColor(height: number, moisture: number): THREE.Color {\n  // height: 0..1 normalized, moisture: 0..1\n\n  if (height < 0.28) {\n    return _biomeColor.setRGB(0.05, 0.1, 0.35)\n  }\n  if (height < 0.35) {\n    const t = (height - 0.28) / 0.07\n    return _biomeColor.setRGB(0.1 + t * 0.15, 0.25 + t * 0.15, 0.5 + t * 0.1)\n  }\n  if (height < 0.38) {\n    return _biomeColor.setRGB(0.76, 0.7, 0.5)\n  }\n  if (height < 0.55) {\n    if (moisture > 0.5) {\n      return _biomeColor.setRGB(0.1, 0.3, 0.08)\n    }\n    return _biomeColor.setRGB(0.25, 0.5, 0.15)\n  }\n  if (height < 0.7) {\n    if (moisture > 0.4) {\n      return _biomeColor.setRGB(0.08, 0.25, 0.06)\n    }\n    const t = (height - 0.55) / 0.15\n    return _biomeColor.setRGB(0.25 + t * 0.2, 0.5 - t * 0.25, 0.15 - t * 0.05)\n  }\n  if (height < 0.85) {\n    const t = (height - 0.7) / 0.15\n    return _biomeColor.setRGB(0.4 + t * 0.1, 0.38 + t * 0.1, 0.35 + t * 0.1)\n  }\n  const t = Math.min((height - 0.85) / 0.15, 1.0)\n  return _biomeColor.setRGB(0.7 + t * 0.2, 0.72 + t * 0.2, 0.78 + t * 0.17)\n}\n\n// ── Terrain Engine ──────────────────────────────────────────────────\n\nexport class TerrainEngine {\n  private scene: THREE.Scene\n  private camera: THREE.PerspectiveCamera\n  private renderer: THREE.WebGLRenderer\n  private controls: OrbitControls\n  private terrain: THREE.Mesh | null = null\n  private waterPlane: THREE.Mesh | null = null\n\n  private animId = 0\n  private disposed = false\n  private resizeObserver: ResizeObserver | null = null\n\n  private currentSeed: number\n  private rng!: () => number\n  private noise!: SimplexNoise2D\n\n  private noiseScale = 2.0\n  private octaveCount = 5\n  private erosionSteps = 500\n  private waterLevelValue = 0.35\n\n  private static readonly GRID_SIZE = 256\n\n  constructor(private container: HTMLDivElement) {\n    // Renderer\n    this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: false })\n    this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))\n    this.renderer.setSize(container.clientWidth, container.clientHeight)\n    this.renderer.setClearColor(0x1a1a2e)\n    this.renderer.shadowMap.enabled = true\n    this.renderer.shadowMap.type = THREE.PCFSoftShadowMap\n    container.appendChild(this.renderer.domElement)\n\n    this.renderer.domElement.addEventListener('webglcontextlost', this.handleContextLost)\n    this.renderer.domElement.addEventListener('webglcontextrestored', this.handleContextRestored)\n\n    // Scene\n    this.scene = new THREE.Scene()\n    this.scene.fog = new THREE.FogExp2(0x1a1a2e, 0.015)\n\n    // Camera\n    this.camera = new THREE.PerspectiveCamera(\n      55,\n      container.clientWidth / container.clientHeight,\n      0.1,\n      200\n    )\n    this.camera.position.set(35, 25, 35)\n\n    // Controls\n    this.controls = new OrbitControls(this.camera, this.renderer.domElement)\n    this.controls.enableDamping = true\n    this.controls.dampingFactor = 0.05\n    this.controls.autoRotate = true\n    this.controls.autoRotateSpeed = 0.5\n    this.controls.maxPolarAngle = Math.PI * 0.48\n    this.controls.minDistance = 15\n    this.controls.maxDistance = 80\n    this.controls.target.set(0, 0, 0)\n\n    // Lights\n    const ambient = new THREE.AmbientLight(0x404060, 0.6)\n    this.scene.add(ambient)\n\n    const directional = new THREE.DirectionalLight(0xfff4e0, 1.2)\n    directional.position.set(30, 40, 20)\n    directional.castShadow = true\n    directional.shadow.mapSize.width = 1024\n    directional.shadow.mapSize.height = 1024\n    directional.shadow.camera.near = 1\n    directional.shadow.camera.far = 100\n    directional.shadow.camera.left = -40\n    directional.shadow.camera.right = 40\n    directional.shadow.camera.top = 40\n    directional.shadow.camera.bottom = -40\n    this.scene.add(directional)\n\n    const hemiLight = new THREE.HemisphereLight(0x87ceeb, 0x362d1b, 0.3)\n    this.scene.add(hemiLight)\n\n    // Generate initial terrain\n    this.currentSeed = Math.floor(Math.random() * 2147483647)\n    this.buildTerrain()\n\n    // Resize\n    this.resizeObserver = new ResizeObserver(() => {\n      if (!this.disposed) this.handleResize()\n    })\n    this.resizeObserver.observe(container)\n\n    this.animate()\n  }\n\n  // ── Public API ────────────────────────────────────────────────\n\n  generate(seed?: number) {\n    this.currentSeed = seed ?? Math.floor(Math.random() * 2147483647)\n    this.buildTerrain()\n  }\n\n  setNoiseScale(v: number) {\n    this.noiseScale = Math.max(0.5, Math.min(5, v))\n    this.buildTerrain()\n  }\n\n  setOctaves(v: number) {\n    this.octaveCount = Math.max(1, Math.min(8, Math.round(v)))\n    this.buildTerrain()\n  }\n\n  setErosionSteps(v: number) {\n    this.erosionSteps = Math.max(0, Math.min(5000, Math.round(v)))\n    this.buildTerrain()\n  }\n\n  setWaterLevel(v: number) {\n    this.waterLevelValue = Math.max(0, Math.min(1, v))\n    this.updateWaterPlane()\n    this.updateTerrainColors()\n  }\n\n  get autoRotate(): boolean {\n    return this.controls.autoRotate\n  }\n\n  set autoRotate(value: boolean) {\n    this.controls.autoRotate = value\n  }\n\n  get seed(): number {\n    return this.currentSeed\n  }\n\n  dispose() {\n    this.disposed = true\n    cancelAnimationFrame(this.animId)\n\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect()\n      this.resizeObserver = null\n    }\n\n    this.controls.dispose()\n\n    // Dispose scene objects\n    this.scene.traverse(obj => {\n      if (obj instanceof THREE.Mesh) {\n        obj.geometry.dispose()\n        if (Array.isArray(obj.material)) {\n          obj.material.forEach(m => m.dispose())\n        } else {\n          obj.material.dispose()\n        }\n      }\n    })\n\n    this.renderer.domElement.removeEventListener('webglcontextlost', this.handleContextLost)\n    this.renderer.domElement.removeEventListener('webglcontextrestored', this.handleContextRestored)\n    this.renderer.dispose()\n    if (this.renderer.domElement.parentElement) {\n      this.renderer.domElement.parentElement.removeChild(this.renderer.domElement)\n    }\n  }\n\n  // ── Terrain generation ────────────────────────────────────────\n\n  private buildTerrain() {\n    this.rng = mulberry32(this.currentSeed)\n    this.noise = new SimplexNoise2D(this.rng)\n\n    const size = TerrainEngine.GRID_SIZE\n    const heightMap = this.generateHeightMap(size)\n\n    // Apply erosion\n    if (this.erosionSteps > 0) {\n      this.erode(heightMap, size, this.erosionSteps)\n    }\n\n    // Build geometry\n    this.buildGeometry(heightMap, size)\n    this.updateWaterPlane()\n  }\n\n  private generateHeightMap(size: number): Float32Array {\n    const heightMap = new Float32Array((size + 1) * (size + 1))\n    const scale = this.noiseScale\n    const octaves = this.octaveCount\n\n    for (let z = 0; z <= size; z++) {\n      for (let x = 0; x <= size; x++) {\n        const nx = (x / size - 0.5) * scale\n        const nz = (z / size - 0.5) * scale\n\n        let height = 0\n        let amplitude = 1\n        let frequency = 1\n        let maxAmp = 0\n\n        for (let o = 0; o < octaves; o++) {\n          height += this.noise.noise(nx * frequency, nz * frequency) * amplitude\n          maxAmp += amplitude\n          amplitude *= 0.5\n          frequency *= 2.1\n        }\n\n        height /= maxAmp\n        // Normalize to 0..1\n        height = (height + 1) * 0.5\n\n        // Island falloff: push edges down\n        const dx = (x / size - 0.5) * 2\n        const dz = (z / size - 0.5) * 2\n        const distFromCenter = Math.sqrt(dx * dx + dz * dz)\n        const falloff = Math.max(0, 1 - distFromCenter * distFromCenter)\n        height *= falloff\n\n        heightMap[z * (size + 1) + x] = height\n      }\n    }\n\n    return heightMap\n  }\n\n  // ── Hydraulic erosion (simplified droplet-based) ──────────────\n\n  private erode(heightMap: Float32Array, size: number, iterations: number) {\n    const stride = size + 1\n    const rng = this.rng\n\n    for (let iter = 0; iter < iterations; iter++) {\n      // Random droplet position\n      let x = rng() * (size - 2) + 1\n      let y = rng() * (size - 2) + 1\n      let dx = 0\n      let dy = 0\n      let speed = 0\n      let water = 1\n      let sediment = 0\n\n      const inertia = 0.05\n      const capacity = 4.0\n      const deposition = 0.3\n      const erosion = 0.3\n      const evaporation = 0.01\n      const gravity = 4.0\n      const maxSteps = 80\n\n      for (let step = 0; step < maxSteps; step++) {\n        const ix = Math.floor(x)\n        const iy = Math.floor(y)\n\n        if (ix < 1 || ix >= size - 1 || iy < 1 || iy >= size - 1) break\n\n        // Bilinear interpolation offset\n        const fx = x - ix\n        const fy = y - iy\n\n        // Heights at corners\n        const h00 = heightMap[iy * stride + ix]\n        const h10 = heightMap[iy * stride + ix + 1]\n        const h01 = heightMap[(iy + 1) * stride + ix]\n        const h11 = heightMap[(iy + 1) * stride + ix + 1]\n\n        // Gradient\n        const gx = (h10 - h00) * (1 - fy) + (h11 - h01) * fy\n        const gy = (h01 - h00) * (1 - fx) + (h11 - h10) * fx\n\n        // Update direction with inertia\n        dx = dx * inertia - gx * (1 - inertia)\n        dy = dy * inertia - gy * (1 - inertia)\n\n        // Normalize direction\n        const len = Math.sqrt(dx * dx + dy * dy)\n        if (len < 0.0001) {\n          dx = rng() * 2 - 1\n          dy = rng() * 2 - 1\n        } else {\n          dx /= len\n          dy /= len\n        }\n\n        // Move\n        const newX = x + dx\n        const newY = y + dy\n\n        if (newX < 1 || newX >= size - 1 || newY < 1 || newY >= size - 1) break\n\n        // Height at old and new positions\n        const oldH = h00 * (1 - fx) * (1 - fy) + h10 * fx * (1 - fy) + h01 * (1 - fx) * fy + h11 * fx * fy\n\n        const nix = Math.floor(newX)\n        const niy = Math.floor(newY)\n        const nfx = newX - nix\n        const nfy = newY - niy\n        const nh00 = heightMap[niy * stride + nix]\n        const nh10 = heightMap[niy * stride + nix + 1]\n        const nh01 = heightMap[(niy + 1) * stride + nix]\n        const nh11 = heightMap[(niy + 1) * stride + nix + 1]\n        const newH = nh00 * (1 - nfx) * (1 - nfy) + nh10 * nfx * (1 - nfy) + nh01 * (1 - nfx) * nfy + nh11 * nfx * nfy\n\n        const heightDiff = newH - oldH\n\n        // Sediment capacity\n        const c = Math.max(-heightDiff, 0.01) * speed * water * capacity\n\n        if (sediment > c || heightDiff > 0) {\n          // Deposit\n          const depositAmount = heightDiff > 0\n            ? Math.min(sediment, heightDiff)\n            : (sediment - c) * deposition\n\n          sediment -= depositAmount\n\n          // Distribute deposit to the 4 surrounding cells\n          heightMap[iy * stride + ix] += depositAmount * (1 - fx) * (1 - fy)\n          heightMap[iy * stride + ix + 1] += depositAmount * fx * (1 - fy)\n          heightMap[(iy + 1) * stride + ix] += depositAmount * (1 - fx) * fy\n          heightMap[(iy + 1) * stride + ix + 1] += depositAmount * fx * fy\n        } else {\n          // Erode\n          const erodeAmount = Math.min((c - sediment) * erosion, -heightDiff)\n\n          heightMap[iy * stride + ix] -= erodeAmount * (1 - fx) * (1 - fy)\n          heightMap[iy * stride + ix + 1] -= erodeAmount * fx * (1 - fy)\n          heightMap[(iy + 1) * stride + ix] -= erodeAmount * (1 - fx) * fy\n          heightMap[(iy + 1) * stride + ix + 1] -= erodeAmount * fx * fy\n\n          sediment += erodeAmount\n        }\n\n        // Update speed and water\n        speed = Math.sqrt(Math.max(0, speed * speed + heightDiff * gravity))\n        water *= (1 - evaporation)\n\n        x = newX\n        y = newY\n\n        if (water < 0.001) break\n      }\n    }\n  }\n\n  // ── Geometry construction ─────────────────────────────────────\n\n  private buildGeometry(heightMap: Float32Array, size: number) {\n    // Remove old terrain\n    if (this.terrain) {\n      this.scene.remove(this.terrain)\n      this.terrain.geometry.dispose()\n      ;(this.terrain.material as THREE.Material).dispose()\n    }\n\n    const terrainSize = 50\n    const geometry = new THREE.PlaneGeometry(terrainSize, terrainSize, size, size)\n    geometry.rotateX(-Math.PI / 2)\n\n    const positions = geometry.attributes.position\n    const stride = size + 1\n    const heightScale = 15\n    const colors = new Float32Array(positions.count * 3)\n\n    // Second noise for moisture\n    const moistureRng = mulberry32(this.currentSeed + 12345)\n    const moistureNoise = new SimplexNoise2D(moistureRng)\n\n    for (let i = 0; i < positions.count; i++) {\n      const x = i % stride\n      const z = Math.floor(i / stride)\n      const h = heightMap[z * stride + x]\n\n      // Set Y position\n      positions.setY(i, h * heightScale)\n\n      // Moisture for biome\n      const nx = (x / size - 0.5) * 3\n      const nz = (z / size - 0.5) * 3\n      const moisture = (moistureNoise.noise(nx, nz) + 1) * 0.5\n\n      // Biome color\n      const color = getBiomeColor(h, moisture)\n      colors[i * 3] = color.r\n      colors[i * 3 + 1] = color.g\n      colors[i * 3 + 2] = color.b\n    }\n\n    geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3))\n    geometry.computeVertexNormals()\n\n    const material = new THREE.MeshStandardMaterial({\n      vertexColors: true,\n      roughness: 0.85,\n      metalness: 0.05,\n      flatShading: false\n    })\n\n    this.terrain = new THREE.Mesh(geometry, material)\n    this.terrain.castShadow = true\n    this.terrain.receiveShadow = true\n    this.scene.add(this.terrain)\n  }\n\n  private updateTerrainColors() {\n    if (!this.terrain) return\n\n    const geometry = this.terrain.geometry as THREE.BufferGeometry\n    const positions = geometry.attributes.position\n    const colorAttr = geometry.attributes.color\n    if (!colorAttr) return\n\n    const size = TerrainEngine.GRID_SIZE\n    const stride = size + 1\n    const heightScale = 15\n\n    const moistureRng = mulberry32(this.currentSeed + 12345)\n    const moistureNoise = new SimplexNoise2D(moistureRng)\n\n    for (let i = 0; i < positions.count; i++) {\n      const x = i % stride\n      const z = Math.floor(i / stride)\n      const h = positions.getY(i) / heightScale\n\n      const nx = (x / size - 0.5) * 3\n      const nz = (z / size - 0.5) * 3\n      const moisture = (moistureNoise.noise(nx, nz) + 1) * 0.5\n\n      const color = getBiomeColor(h, moisture)\n      colorAttr.setXYZ(i, color.r, color.g, color.b)\n    }\n\n    colorAttr.needsUpdate = true\n  }\n\n  private updateWaterPlane() {\n    const heightScale = 15\n    const waterY = this.waterLevelValue * heightScale\n\n    if (this.waterPlane) {\n      this.waterPlane.position.y = waterY\n    } else {\n      const waterGeom = new THREE.PlaneGeometry(55, 55)\n      waterGeom.rotateX(-Math.PI / 2)\n\n      const waterMat = new THREE.MeshStandardMaterial({\n        color: 0x1a6eb5,\n        transparent: true,\n        opacity: 0.55,\n        roughness: 0.1,\n        metalness: 0.3,\n        side: THREE.DoubleSide\n      })\n\n      this.waterPlane = new THREE.Mesh(waterGeom, waterMat)\n      this.waterPlane.position.y = waterY\n      this.waterPlane.receiveShadow = true\n      this.scene.add(this.waterPlane)\n    }\n  }\n\n  // ── Resize / animate ──────────────────────────────────────────\n\n  private handleResize() {\n    const w = this.container.clientWidth\n    const h = this.container.clientHeight\n    this.camera.aspect = w / h\n    this.camera.updateProjectionMatrix()\n    this.renderer.setSize(w, h)\n  }\n\n  private handleContextLost = (e: Event) => {\n    e.preventDefault()\n    cancelAnimationFrame(this.animId)\n    const overlay = document.createElement('div')\n    overlay.style.cssText = 'position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.8);color:#fff;font:14px/1.5 sans-serif;cursor:pointer;z-index:100'\n    overlay.textContent = 'WebGL context lost — click to reload'\n    overlay.addEventListener('click', () => location.reload())\n    this.container.style.position = 'relative'\n    this.container.appendChild(overlay)\n  }\n\n  private handleContextRestored = () => {\n    location.reload()\n  }\n\n  private animate = () => {\n    if (this.disposed) return\n    this.animId = requestAnimationFrame(this.animate)\n    this.controls.update()\n    this.renderer.render(this.scene, this.camera)\n  }\n}\n"],"names":["mulberry32","seed","t","Math","imul","SimplexNoise2D","rng","grad","p","i","j","floor","this","perm","concat","_proto","prototype","dot","g","x","y","noise","xin","yin","F2","sqrt","G2","s","x0","y0","i1","j1","x1","y1","x2","y2","ii","jj","gi0","gi1","gi2","n0","n1","n2","t0","t1","t2","_biomeColor","THREE","getBiomeColor","height","moisture","setRGB","min","TerrainEngine","container","terrain","waterPlane","animId","disposed","resizeObserver","noiseScale","octaveCount","erosionSteps","waterLevelValue","handleContextLost","e","preventDefault","cancelAnimationFrame","overlay","document","createElement","style","cssText","textContent","addEventListener","location","reload","position","appendChild","handleContextRestored","animate","requestAnimationFrame","controls","update","renderer","render","scene","camera","antialias","alpha","setPixelRatio","window","devicePixelRatio","setSize","clientWidth","clientHeight","setClearColor","shadowMap","enabled","type","domElement","fog","set","OrbitControls","enableDamping","dampingFactor","autoRotate","autoRotateSpeed","maxPolarAngle","PI","minDistance","maxDistance","target","ambient","add","directional","castShadow","shadow","mapSize","width","near","far","left","right","top","bottom","hemiLight","currentSeed","random","buildTerrain","ResizeObserver","handleResize","observe","_proto2","generate","setNoiseScale","v","max","setOctaves","round","setErosionSteps","setWaterLevel","updateWaterPlane","updateTerrainColors","dispose","disconnect","traverse","obj","geometry","Array","isArray","material","forEach","m","removeEventListener","parentElement","removeChild","size","GRID_SIZE","heightMap","generateHeightMap","erode","buildGeometry","Float32Array","scale","octaves","z","nx","nz","amplitude","frequency","maxAmp","o","dx","dz","distFromCenter","iterations","stride","iter","dy","speed","water","sediment","inertia","capacity","deposition","erosion","evaporation","gravity","maxSteps","step","ix","iy","fx","fy","h00","h10","h01","h11","len","newX","newY","oldH","nix","niy","nfx","nfy","heightDiff","c","depositAmount","erodeAmount","remove","rotateX","positions","attributes","colors","count","moistureRng","moistureNoise","h","setY","color","r","b","setAttribute","computeVertexNormals","vertexColors","roughness","metalness","flatShading","receiveShadow","colorAttr","getY","setXYZ","needsUpdate","waterY","waterGeom","waterMat","transparent","opacity","side","w","aspect","updateProjectionMatrix","_createClass","key","get","value"],"sourceRoot":""}