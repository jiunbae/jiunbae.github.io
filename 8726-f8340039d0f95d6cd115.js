"use strict";(self.webpackChunkjiunbae_github_io=self.webpackChunkjiunbae_github_io||[]).push([[8726],{546:function(t,e,n){function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=i(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,o(i.key),i)}}function r(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}n.d(e,{A:function(){return r}})},8726:function(t,e,n){n.r(e),n.d(e,{MandelbrotEngine:function(){return s}});var i=n(546);function o(t,e,n){const i=t.createShader(e);if(!i)throw new Error("Failed to create shader — WebGL context may be lost");if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(i);throw t.deleteShader(i),new Error(`Shader compile error: ${e}`)}return i}let s=function(){function t(t){this._centerX=-.5,this._centerY=0,this._zoom=1.5,this._maxIter=200,this._palette=0,this.dragging=!1,this.dragStartX=0,this.dragStartY=0,this.dragCenterStartX=0,this.dragCenterStartY=0,this.lastPinchDist=0,this.touchStartX=0,this.touchStartY=0,this.touchCenterStartX=0,this.touchCenterStartY=0,this.animationId=0,this.needsRender=!0,this.disposed=!1,this.resizeObserver=null,this.onViewChange=null,this.handleContextLost=t=>{t.preventDefault(),cancelAnimationFrame(this.animationId),function(t){const e=document.createElement("div");e.style.cssText="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.8);color:#fff;font:14px/1.5 sans-serif;cursor:pointer;z-index:100",e.textContent="WebGL context lost — click to reload",e.addEventListener("click",()=>location.reload()),t.style.position="relative",t.appendChild(e)}(this.container)},this.handleContextRestored=()=>{location.reload()},this.onWheel=t=>{t.preventDefault();const e=t.deltaY>0?1.15:1/1.15;this.zoomAt(t.clientX,t.clientY,e)},this.onMouseDown=t=>{0===t.button&&(this.dragging=!0,this.dragStartX=t.clientX,this.dragStartY=t.clientY,this.dragCenterStartX=this._centerX,this.dragCenterStartY=this._centerY,this.canvas.style.cursor="grabbing")},this.onMouseMove=t=>{if(!this.dragging)return;const e=t.clientX-this.dragStartX,n=t.clientY-this.dragStartY,i=this.canvas.getBoundingClientRect(),o=this.canvas.width/this.canvas.height;this._centerX=this.dragCenterStartX-e/i.width*2*this._zoom*o,this._centerY=this.dragCenterStartY+n/i.height*2*this._zoom,this.needsRender=!0},this.onMouseUp=()=>{this.dragging=!1,this.canvas.style.cursor="grab"},this.onTouchStart=t=>{if(t.preventDefault(),1===t.touches.length){const e=t.touches[0];this.touchStartX=e.clientX,this.touchStartY=e.clientY,this.touchCenterStartX=this._centerX,this.touchCenterStartY=this._centerY,this.dragging=!0}else if(2===t.touches.length){this.dragging=!1;const e=t.touches[0],n=t.touches[1];this.lastPinchDist=Math.hypot(n.clientX-e.clientX,n.clientY-e.clientY)}},this.onTouchMove=t=>{if(t.preventDefault(),1===t.touches.length&&this.dragging){const e=t.touches[0],n=e.clientX-this.touchStartX,i=e.clientY-this.touchStartY,o=this.canvas.getBoundingClientRect(),s=this.canvas.width/this.canvas.height;this._centerX=this.touchCenterStartX-n/o.width*2*this._zoom*s,this._centerY=this.touchCenterStartY+i/o.height*2*this._zoom,this.needsRender=!0}else if(2===t.touches.length){const e=t.touches[0],n=t.touches[1],i=Math.hypot(n.clientX-e.clientX,n.clientY-e.clientY);if(this.lastPinchDist>0){const t=.5*(e.clientX+n.clientX),o=.5*(e.clientY+n.clientY),s=this.lastPinchDist/i;this.zoomAt(t,o,s)}this.lastPinchDist=i}},this.onTouchEnd=t=>{if(t.touches.length<2&&(this.lastPinchDist=0),0===t.touches.length)this.dragging=!1;else if(1===t.touches.length){const e=t.touches[0];this.touchStartX=e.clientX,this.touchStartY=e.clientY,this.touchCenterStartX=this._centerX,this.touchCenterStartY=this._centerY,this.dragging=!0}},this.animate=()=>{var t;this.disposed||(this.animationId=requestAnimationFrame(this.animate),this.needsRender&&(this.needsRender=!1,this.render(),null===(t=this.onViewChange)||void 0===t||t.call(this,this._centerX,this._centerY,this._zoom)))},this.container=t,this.canvas=document.createElement("canvas"),this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.canvas.style.cursor="grab",t.appendChild(this.canvas);const e=this.canvas.getContext("webgl",{alpha:!1,depth:!1,stencil:!1,antialias:!1,preserveDrawingBuffer:!1});if(!e)throw new Error("WebGL not supported");this.gl=e,this.program=function(t,e,n){const i=t.createProgram();if(!i)throw new Error("Failed to create program — WebGL context may be lost");if(t.attachShader(i,o(t,t.VERTEX_SHADER,e)),t.attachShader(i,o(t,t.FRAGMENT_SHADER,n)),t.bindAttribLocation(i,0,"aPosition"),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))throw new Error(`Program link error: ${t.getProgramInfoLog(i)}`);return i}(e,"\nattribute vec2 aPosition;\nvarying vec2 vUv;\nvoid main() {\n  vUv = aPosition * 0.5 + 0.5;\n  gl_Position = vec4(aPosition, 0.0, 1.0);\n}\n","\nprecision highp float;\nvarying vec2 vUv;\n\nuniform vec2 uCenterHi;   // high part of center (complex plane)\nuniform vec2 uCenterLo;   // low part of center (for double emulation)\nuniform float uZoom;       // zoom level (half-width of view in complex plane)\nuniform int uMaxIter;\nuniform int uPalette;\nuniform vec2 uResolution;\n\n// Double-float add: (a_hi, a_lo) + (b_hi, b_lo) = (s_hi, s_lo)\nvec2 df_add(vec2 a, vec2 b) {\n  float s = a.x + b.x;\n  float e = s - a.x;\n  float t = ((b.x - e) + (a.x - (s - e))) + a.y + b.y;\n  return vec2(s + t, t - ((s + t) - s));\n}\n\n// Double-float multiply: (a_hi, a_lo) * (b_hi, b_lo) = (p_hi, p_lo)\nvec2 df_mul(vec2 a, vec2 b) {\n  float p = a.x * b.x;\n  float e = a.x * b.x - p; // fma approximation\n  // For WebGL without fma, use split approach\n  float t = a.x * b.y + a.y * b.x + e;\n  return vec2(p + t, t - ((p + t) - p));\n}\n\n// Palette functions\nvec3 palette0(float t) {\n  // Ultra Fractal classic: blue-white-orange-black\n  vec3 a = vec3(0.5, 0.5, 0.5);\n  vec3 b = vec3(0.5, 0.5, 0.5);\n  vec3 c = vec3(1.0, 1.0, 1.0);\n  vec3 d = vec3(0.0, 0.10, 0.20);\n  return a + b * cos(6.28318 * (c * t + d));\n}\n\nvec3 palette1(float t) {\n  // Fire: black-red-orange-yellow-white\n  vec3 a = vec3(0.5, 0.5, 0.5);\n  vec3 b = vec3(0.5, 0.5, 0.5);\n  vec3 c = vec3(1.0, 1.0, 0.5);\n  vec3 d = vec3(0.80, 0.90, 0.30);\n  return a + b * cos(6.28318 * (c * t + d));\n}\n\nvec3 palette2(float t) {\n  // Ocean: deep blue to cyan to white\n  vec3 a = vec3(0.5, 0.5, 0.5);\n  vec3 b = vec3(0.5, 0.5, 0.5);\n  vec3 c = vec3(1.0, 0.7, 0.4);\n  vec3 d = vec3(0.0, 0.15, 0.20);\n  return a + b * cos(6.28318 * (c * t + d));\n}\n\nvec3 palette3(float t) {\n  // Neon: magenta-cyan-green\n  vec3 a = vec3(0.5, 0.5, 0.5);\n  vec3 b = vec3(0.5, 0.5, 0.5);\n  vec3 c = vec3(2.0, 1.0, 0.0);\n  vec3 d = vec3(0.50, 0.20, 0.25);\n  return a + b * cos(6.28318 * (c * t + d));\n}\n\nvec3 palette4(float t) {\n  // Grayscale with blue tint\n  float v = t;\n  return vec3(v * 0.85, v * 0.9, v);\n}\n\nvec3 getColor(float t, int pal) {\n  if (pal == 0) return palette0(t);\n  if (pal == 1) return palette1(t);\n  if (pal == 2) return palette2(t);\n  if (pal == 3) return palette3(t);\n  return palette4(t);\n}\n\nvoid main() {\n  float aspect = uResolution.x / uResolution.y;\n  vec2 screenPos = (vUv - 0.5) * 2.0;\n  screenPos.x *= aspect;\n\n  // Map screen position to complex plane using double-emulated precision\n  // c = center + screenPos * zoom\n  vec2 cxHi = df_add(vec2(uCenterHi.x, uCenterLo.x), vec2(screenPos.x * uZoom, 0.0));\n  vec2 cyHi = df_add(vec2(uCenterHi.y, uCenterLo.y), vec2(screenPos.y * uZoom, 0.0));\n\n  // Mandelbrot iteration using double-emulated precision\n  // z = 0, iterate z = z^2 + c\n  vec2 zxHi = vec2(0.0, 0.0);\n  vec2 zyHi = vec2(0.0, 0.0);\n\n  float escaped = 0.0;\n  float smoothIter = 0.0;\n\n  // Use standard float for performance at moderate zoom levels,\n  // switch to double-emulated when needed\n  bool useDouble = uZoom < 0.00001;\n\n  if (useDouble) {\n    // Double-emulated precision path\n    for (int i = 0; i < 1000; i++) {\n      if (i >= uMaxIter) break;\n\n      // zx^2, zy^2\n      vec2 zx2 = df_mul(zxHi, zxHi);\n      vec2 zy2 = df_mul(zyHi, zyHi);\n\n      // Bailout check: |z|^2 > 4.0\n      float mag2 = zx2.x + zy2.x;\n      if (mag2 > 256.0) {\n        escaped = 1.0;\n        // Smooth coloring: n - log2(log2(|z|))\n        float logZn = log(mag2) * 0.5;\n        float nu = log(logZn) / log(2.0);\n        smoothIter = float(i) + 1.0 - nu;\n        break;\n      }\n\n      // z = z^2 + c\n      // new_zx = zx^2 - zy^2 + cx\n      // new_zy = 2*zx*zy + cy\n      vec2 zxzy = df_mul(zxHi, zyHi);\n      vec2 newZx = df_add(df_add(zx2, vec2(-zy2.x, -zy2.y)), cxHi);\n      vec2 newZy = df_add(df_add(zxzy, zxzy), cyHi);\n\n      zxHi = newZx;\n      zyHi = newZy;\n    }\n  } else {\n    // Standard float precision path (faster)\n    float zx = 0.0;\n    float zy = 0.0;\n    float cx = cxHi.x;\n    float cy = cyHi.x;\n\n    for (int i = 0; i < 1000; i++) {\n      if (i >= uMaxIter) break;\n\n      float zx2 = zx * zx;\n      float zy2 = zy * zy;\n\n      if (zx2 + zy2 > 256.0) {\n        escaped = 1.0;\n        float logZn = log(zx2 + zy2) * 0.5;\n        float nu = log(logZn) / log(2.0);\n        smoothIter = float(i) + 1.0 - nu;\n        break;\n      }\n\n      float newZx = zx2 - zy2 + cx;\n      zy = 2.0 * zx * zy + cy;\n      zx = newZx;\n    }\n  }\n\n  vec3 col;\n  if (escaped > 0.5) {\n    float t = fract(smoothIter * 0.02);\n    col = getColor(t, uPalette);\n  } else {\n    col = vec3(0.0);\n  }\n\n  gl_FragColor = vec4(col, 1.0);\n}\n"),this.uCenterHi=e.getUniformLocation(this.program,"uCenterHi"),this.uCenterLo=e.getUniformLocation(this.program,"uCenterLo"),this.uZoom=e.getUniformLocation(this.program,"uZoom"),this.uMaxIter=e.getUniformLocation(this.program,"uMaxIter"),this.uPalette=e.getUniformLocation(this.program,"uPalette"),this.uResolution=e.getUniformLocation(this.program,"uResolution"),this.quadBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.quadBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),e.STATIC_DRAW),this.canvas.addEventListener("webglcontextlost",this.handleContextLost),this.canvas.addEventListener("webglcontextrestored",this.handleContextRestored),this.resizeCanvas(),this.initListeners(),this.animate()}var e=t.prototype;return e.zoomAt=function(t,e,n){const i=this.canvas.getBoundingClientRect(),o=this.canvas.width/this.canvas.height,s=2*((t-i.left)/i.width-.5)*o,r=2*-((e-i.top)/i.height-.5),a=this._centerX+s*this._zoom,c=this._centerY+r*this._zoom;this._zoom*=n,this._centerX=a-s*this._zoom,this._centerY=c-r*this._zoom,this.needsRender=!0},e.pan=function(t,e){const n=this.canvas.width/this.canvas.height,i=this.canvas.getBoundingClientRect();this._centerX-=t/i.width*2*this._zoom*n,this._centerY+=e/i.height*2*this._zoom,this.needsRender=!0},e.resetView=function(){this._centerX=-.5,this._centerY=0,this._zoom=1.5,this._maxIter=200,this.needsRender=!0},e.setPalette=function(t){this._palette=Math.max(0,Math.min(4,t)),this.needsRender=!0},e.setMaxIterations=function(t){this._maxIter=Math.max(50,Math.min(1e3,t)),this.needsRender=!0},e.dispose=function(){var t;this.disposed=!0,cancelAnimationFrame(this.animationId),this.removeListeners(),this.canvas.removeEventListener("webglcontextlost",this.handleContextLost),this.canvas.removeEventListener("webglcontextrestored",this.handleContextRestored),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null);const e=this.gl;e.deleteProgram(this.program),e.deleteBuffer(this.quadBuffer),null===(t=e.getExtension("WEBGL_lose_context"))||void 0===t||t.loseContext(),this.canvas.parentElement&&this.canvas.parentElement.removeChild(this.canvas)},e.resizeCanvas=function(){const t=Math.min(window.devicePixelRatio,2),e=this.container.clientWidth,n=this.container.clientHeight;this.canvas.width=Math.floor(e*t),this.canvas.height=Math.floor(n*t),this.needsRender=!0},e.splitDouble=function(t){const e=Math.fround(t);return[e,t-e]},e.render=function(){const t=this.gl;t.viewport(0,0,this.canvas.width,this.canvas.height),t.useProgram(this.program);const[e,n]=this.splitDouble(this._centerX),[i,o]=this.splitDouble(this._centerY);t.uniform2f(this.uCenterHi,e,i),t.uniform2f(this.uCenterLo,n,o),t.uniform1f(this.uZoom,this._zoom),t.uniform1i(this.uMaxIter,this._maxIter),t.uniform1i(this.uPalette,this._palette),t.uniform2f(this.uResolution,this.canvas.width,this.canvas.height),t.bindBuffer(t.ARRAY_BUFFER,this.quadBuffer),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,2,t.FLOAT,!1,0,0),t.drawArrays(t.TRIANGLE_FAN,0,4)},e.initListeners=function(){this.canvas.addEventListener("wheel",this.onWheel,{passive:!1}),this.canvas.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),this.canvas.addEventListener("touchstart",this.onTouchStart,{passive:!1}),this.canvas.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.canvas.addEventListener("touchend",this.onTouchEnd),this.resizeObserver=new ResizeObserver(()=>{this.disposed||this.resizeCanvas()}),this.resizeObserver.observe(this.container)},e.removeListeners=function(){this.canvas.removeEventListener("wheel",this.onWheel),this.canvas.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),this.canvas.removeEventListener("touchstart",this.onTouchStart),this.canvas.removeEventListener("touchmove",this.onTouchMove),this.canvas.removeEventListener("touchend",this.onTouchEnd)},(0,i.A)(t,[{key:"center",get:function(){return[this._centerX,this._centerY]}},{key:"zoom",get:function(){return this._zoom}},{key:"maxIterations",get:function(){return this._maxIter}},{key:"palette",get:function(){return this._palette}}])}()}}]);
//# sourceMappingURL=8726-f8340039d0f95d6cd115.js.map