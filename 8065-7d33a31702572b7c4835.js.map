{"version":3,"file":"8065-7d33a31702572b7c4835.js","mappings":"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","sources":["webpack://jiunbae.github.io/./node_modules/.pnpm/@babel+runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://jiunbae.github.io/./node_modules/.pnpm/@babel+runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://jiunbae.github.io/./node_modules/.pnpm/@babel+runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://jiunbae.github.io/./node_modules/.pnpm/@babel+runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://jiunbae.github.io/./src/views/Boids/engine.ts"],"sourcesContent":["function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nexport { _createClass as default };","/**\n * Boids flocking simulation using Craig Reynolds' algorithm.\n *\n * Features:\n *   - 1000-3000 boids as directional triangles\n *   - Three classic rules: separation, alignment, cohesion\n *   - Spatial hashing for efficient O(n) neighbor lookup\n *   - Mouse interaction (attract / repel / none)\n *   - Optional predator that chases nearest boid\n *   - Optional trails (last 5 positions)\n *   - HSL heading-based coloring\n *   - Toroidal (wrapping) space\n */\n\n// ---------------------------------------------------------------------------\n// Vec2 helpers\n// ---------------------------------------------------------------------------\n\ninterface Vec2 {\n  x: number\n  y: number\n}\n\nfunction v2(x: number, y: number): Vec2 {\n  return { x, y }\n}\n\nfunction v2add(a: Vec2, b: Vec2): Vec2 {\n  return { x: a.x + b.x, y: a.y + b.y }\n}\n\nfunction v2sub(a: Vec2, b: Vec2): Vec2 {\n  return { x: a.x - b.x, y: a.y - b.y }\n}\n\nfunction v2scale(a: Vec2, s: number): Vec2 {\n  return { x: a.x * s, y: a.y * s }\n}\n\nfunction v2len(a: Vec2): number {\n  return Math.sqrt(a.x * a.x + a.y * a.y)\n}\n\nfunction v2lenSq(a: Vec2): number {\n  return a.x * a.x + a.y * a.y\n}\n\nfunction v2norm(a: Vec2): Vec2 {\n  const l = v2len(a)\n  if (l < 1e-10) return { x: 0, y: 0 }\n  return { x: a.x / l, y: a.y / l }\n}\n\nfunction v2setMag(a: Vec2, mag: number): Vec2 {\n  const l = v2len(a)\n  if (l < 1e-10) return { x: 0, y: 0 }\n  const s = mag / l\n  return { x: a.x * s, y: a.y * s }\n}\n\nfunction v2limit(a: Vec2, max: number): Vec2 {\n  const lsq = v2lenSq(a)\n  if (lsq > max * max) {\n    return v2setMag(a, max)\n  }\n  return a\n}\n\n// ---------------------------------------------------------------------------\n// Mutable Vec2 helpers (zero-allocation, for hot paths)\n// ---------------------------------------------------------------------------\n\n/** Inline magnitude from raw components (avoids allocating a Vec2 just for v2len). */\nfunction mag2(x: number, y: number): number {\n  return Math.sqrt(x * x + y * y)\n}\n\n/** Scratch Vec2 used by wrapDeltaMut and predator avoidance. */\nconst _wd: Vec2 = { x: 0, y: 0 }\n\n// ---------------------------------------------------------------------------\n// Boid\n// ---------------------------------------------------------------------------\n\ninterface Boid {\n  pos: Vec2\n  vel: Vec2\n  acc: Vec2\n  trail: Vec2[]\n}\n\n// ---------------------------------------------------------------------------\n// Predator\n// ---------------------------------------------------------------------------\n\ninterface Predator {\n  pos: Vec2\n  vel: Vec2\n  acc: Vec2\n}\n\n// ---------------------------------------------------------------------------\n// Spatial hash grid\n// ---------------------------------------------------------------------------\n\nclass SpatialHash {\n  private cellSize: number\n  private cols: number\n  private rows: number\n  private grid: Int32Array\n  private counts: Int32Array\n  private cellCapacity: number\n\n  constructor(width: number, height: number, cellSize: number, maxBoidsPerCell: number) {\n    this.cellSize = cellSize\n    this.cols = Math.ceil(width / cellSize)\n    this.rows = Math.ceil(height / cellSize)\n    this.cellCapacity = maxBoidsPerCell\n    const totalCells = this.cols * this.rows\n    this.grid = new Int32Array(totalCells * maxBoidsPerCell)\n    this.counts = new Int32Array(totalCells)\n  }\n\n  clear() {\n    this.counts.fill(0)\n  }\n\n  insert(index: number, x: number, y: number) {\n    const col = Math.floor(x / this.cellSize)\n    const row = Math.floor(y / this.cellSize)\n    if (col < 0 || col >= this.cols || row < 0 || row >= this.rows) return\n    const cellIdx = row * this.cols + col\n    const count = this.counts[cellIdx]\n    if (count < this.cellCapacity) {\n      this.grid[cellIdx * this.cellCapacity + count] = index\n      this.counts[cellIdx] = count + 1\n    }\n  }\n\n  query(x: number, y: number, radius: number, callback: (index: number) => void) {\n    const minCol = Math.max(0, Math.floor((x - radius) / this.cellSize))\n    const maxCol = Math.min(this.cols - 1, Math.floor((x + radius) / this.cellSize))\n    const minRow = Math.max(0, Math.floor((y - radius) / this.cellSize))\n    const maxRow = Math.min(this.rows - 1, Math.floor((y + radius) / this.cellSize))\n\n    for (let r = minRow; r <= maxRow; r++) {\n      for (let c = minCol; c <= maxCol; c++) {\n        const cellIdx = r * this.cols + c\n        const count = this.counts[cellIdx]\n        const base = cellIdx * this.cellCapacity\n        for (let i = 0; i < count; i++) {\n          callback(this.grid[base + i])\n        }\n      }\n    }\n  }\n\n  resize(width: number, height: number) {\n    this.cols = Math.ceil(width / this.cellSize)\n    this.rows = Math.ceil(height / this.cellSize)\n    const totalCells = this.cols * this.rows\n    this.grid = new Int32Array(totalCells * this.cellCapacity)\n    this.counts = new Int32Array(totalCells)\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Engine\n// ---------------------------------------------------------------------------\n\ntype MouseMode = 'attract' | 'repel' | 'none'\n\nexport class BoidsEngine {\n  private canvas: HTMLCanvasElement\n  private ctx: CanvasRenderingContext2D\n\n  private boids: Boid[] = []\n  private predator: Predator | null = null\n  private hasPredator = false\n  private showTrails = false\n\n  private separationWeight = 1.5\n  private alignmentWeight = 1.0\n  private cohesionWeight = 1.0\n  private perceptionRadius = 50\n\n  private maxSpeed = 3\n  private minSpeed = 1.5\n  private maxForce = 0.15\n\n  private mouseMode: MouseMode = 'none'\n  private mousePos: Vec2 = v2(0, 0)\n  private mouseInCanvas = false\n  private mouseInfluenceRadius = 150\n\n  private spatialHash!: SpatialHash\n  private w = 0\n  private h = 0\n\n  private animationId = 0\n  private disposed = false\n  private resizeObserver: ResizeObserver | null = null\n\n  constructor(private container: HTMLDivElement) {\n    this.canvas = document.createElement('canvas')\n    this.canvas.style.width = '100%'\n    this.canvas.style.height = '100%'\n    this.canvas.style.display = 'block'\n    container.appendChild(this.canvas)\n\n    this.ctx = this.canvas.getContext('2d')!\n\n    this.resizeCanvas()\n    this.spatialHash = new SpatialHash(this.w, this.h, this.perceptionRadius, 30)\n    this.initBoids(1500)\n    this.initListeners()\n    this.animate()\n  }\n\n  // --- Public API ---\n\n  setBoidCount(n: number) {\n    const target = Math.max(100, Math.min(n, 5000))\n    if (target > this.boids.length) {\n      while (this.boids.length < target) {\n        this.boids.push(this.createRandomBoid())\n      }\n    } else {\n      this.boids.length = target\n    }\n  }\n\n  setSeparation(v: number) { this.separationWeight = v }\n  setAlignment(v: number) { this.alignmentWeight = v }\n  setCohesion(v: number) { this.cohesionWeight = v }\n\n  setPerceptionRadius(v: number) {\n    this.perceptionRadius = v\n    this.spatialHash = new SpatialHash(this.w, this.h, v, 30)\n  }\n\n  setMouseMode(mode: MouseMode) { this.mouseMode = mode }\n\n  togglePredator(): boolean {\n    this.hasPredator = !this.hasPredator\n    if (this.hasPredator && !this.predator) {\n      this.predator = {\n        pos: v2(this.w * 0.5, this.h * 0.5),\n        vel: v2(Math.random() * 2 - 1, Math.random() * 2 - 1),\n        acc: v2(0, 0),\n      }\n    }\n    if (!this.hasPredator) this.predator = null\n    return this.hasPredator\n  }\n\n  toggleTrails(): boolean {\n    this.showTrails = !this.showTrails\n    if (!this.showTrails) {\n      for (const b of this.boids) b.trail = []\n    }\n    return this.showTrails\n  }\n\n  get boidCount(): number {\n    return this.boids.length\n  }\n\n  dispose() {\n    this.disposed = true\n    cancelAnimationFrame(this.animationId)\n    this.removeListeners()\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect()\n      this.resizeObserver = null\n    }\n    if (this.canvas.parentElement) {\n      this.canvas.parentElement.removeChild(this.canvas)\n    }\n  }\n\n  // --- Init ---\n\n  private resizeCanvas() {\n    const dpr = Math.min(window.devicePixelRatio, 2)\n    this.w = this.container.clientWidth\n    this.h = this.container.clientHeight\n    this.canvas.width = this.w * dpr\n    this.canvas.height = this.h * dpr\n    this.ctx.setTransform(dpr, 0, 0, dpr, 0, 0)\n  }\n\n  private createRandomBoid(): Boid {\n    const angle = Math.random() * Math.PI * 2\n    const speed = this.minSpeed + Math.random() * (this.maxSpeed - this.minSpeed)\n    return {\n      pos: v2(Math.random() * this.w, Math.random() * this.h),\n      vel: v2(Math.cos(angle) * speed, Math.sin(angle) * speed),\n      acc: v2(0, 0),\n      trail: [],\n    }\n  }\n\n  private initBoids(n: number) {\n    this.boids = []\n    for (let i = 0; i < n; i++) {\n      this.boids.push(this.createRandomBoid())\n    }\n  }\n\n  // --- Input ---\n\n  private onMouseMove = (e: MouseEvent) => {\n    const rect = this.canvas.getBoundingClientRect()\n    this.mousePos = v2(e.clientX - rect.left, e.clientY - rect.top)\n    this.mouseInCanvas = true\n  }\n\n  private onMouseLeave = () => {\n    this.mouseInCanvas = false\n  }\n\n  private onTouchMove = (e: TouchEvent) => {\n    e.preventDefault()\n    const rect = this.canvas.getBoundingClientRect()\n    const touch = e.touches[0]\n    this.mousePos = v2(touch.clientX - rect.left, touch.clientY - rect.top)\n    this.mouseInCanvas = true\n  }\n\n  private onTouchEnd = () => {\n    this.mouseInCanvas = false\n  }\n\n  private initListeners() {\n    this.canvas.addEventListener('mousemove', this.onMouseMove)\n    this.canvas.addEventListener('mouseleave', this.onMouseLeave)\n    this.canvas.addEventListener('touchmove', this.onTouchMove, { passive: false })\n    window.addEventListener('touchend', this.onTouchEnd)\n\n    this.resizeObserver = new ResizeObserver(() => {\n      if (!this.disposed) {\n        this.resizeCanvas()\n        this.spatialHash.resize(this.w, this.h)\n      }\n    })\n    this.resizeObserver.observe(this.container)\n  }\n\n  private removeListeners() {\n    this.canvas.removeEventListener('mousemove', this.onMouseMove)\n    this.canvas.removeEventListener('mouseleave', this.onMouseLeave)\n    this.canvas.removeEventListener('touchmove', this.onTouchMove)\n    window.removeEventListener('touchend', this.onTouchEnd)\n  }\n\n  // --- Flocking ---\n\n  private wrapDelta(dx: number, dy: number): Vec2 {\n    if (dx > this.w * 0.5) dx -= this.w\n    else if (dx < -this.w * 0.5) dx += this.w\n    if (dy > this.h * 0.5) dy -= this.h\n    else if (dy < -this.h * 0.5) dy += this.h\n    return v2(dx, dy)\n  }\n\n  /**\n   * Same as wrapDelta but writes into the module-level _wd scratch object.\n   * The returned reference is _wd; callers must consume values before the\n   * next call to wrapDeltaMut.\n   */\n  private wrapDeltaMut(dx: number, dy: number): Vec2 {\n    if (dx > this.w * 0.5) dx -= this.w\n    else if (dx < -this.w * 0.5) dx += this.w\n    if (dy > this.h * 0.5) dy -= this.h\n    else if (dy < -this.h * 0.5) dy += this.h\n    _wd.x = dx\n    _wd.y = dy\n    return _wd\n  }\n\n  private updateBoids() {\n    const w = this.w\n    const h = this.h\n    const boids = this.boids\n    const n = boids.length\n    const pr = this.perceptionRadius\n    const prSq = pr * pr\n\n    // Rebuild spatial hash\n    this.spatialHash.clear()\n    for (let i = 0; i < n; i++) {\n      // Wrap position for insertion\n      const b = boids[i]\n      this.spatialHash.insert(i, b.pos.x, b.pos.y)\n\n      // Also insert ghost copies near edges for wrapping queries\n      if (b.pos.x < pr) this.spatialHash.insert(i, b.pos.x + w, b.pos.y)\n      else if (b.pos.x > w - pr) this.spatialHash.insert(i, b.pos.x - w, b.pos.y)\n      if (b.pos.y < pr) this.spatialHash.insert(i, b.pos.x, b.pos.y + h)\n      else if (b.pos.y > h - pr) this.spatialHash.insert(i, b.pos.x, b.pos.y - h)\n    }\n\n    // Compute steering forces for each boid\n    for (let i = 0; i < n; i++) {\n      const boid = boids[i]\n      let sepX = 0, sepY = 0, sepCount = 0\n      let aliX = 0, aliY = 0, aliCount = 0\n      let cohX = 0, cohY = 0, cohCount = 0\n\n      this.spatialHash.query(boid.pos.x, boid.pos.y, pr, (j: number) => {\n        if (j === i) return\n        const other = boids[j]\n        const delta = this.wrapDeltaMut(other.pos.x - boid.pos.x, other.pos.y - boid.pos.y)\n        const dx = delta.x, dy = delta.y\n        const dSq = dx * dx + dy * dy\n        if (dSq > prSq || dSq < 1e-6) return\n\n        const d = Math.sqrt(dSq)\n\n        // Separation - weight inversely by distance\n        sepX -= dx / d\n        sepY -= dy / d\n        sepCount++\n\n        // Alignment\n        aliX += other.vel.x\n        aliY += other.vel.y\n        aliCount++\n\n        // Cohesion\n        cohX += dx\n        cohY += dy\n        cohCount++\n      })\n\n      let steerX = 0, steerY = 0\n\n      // Separation\n      if (sepCount > 0) {\n        sepX /= sepCount\n        sepY /= sepCount\n        const sepMag = mag2(sepX, sepY)\n        if (sepMag > 0) {\n          sepX = sepX / sepMag * this.maxSpeed - boid.vel.x\n          sepY = sepY / sepMag * this.maxSpeed - boid.vel.y\n          const l = mag2(sepX, sepY)\n          if (l > this.maxForce) {\n            sepX = sepX / l * this.maxForce\n            sepY = sepY / l * this.maxForce\n          }\n        }\n        steerX += sepX * this.separationWeight\n        steerY += sepY * this.separationWeight\n      }\n\n      // Alignment\n      if (aliCount > 0) {\n        aliX /= aliCount\n        aliY /= aliCount\n        const aliMag = mag2(aliX, aliY)\n        if (aliMag > 0) {\n          aliX = aliX / aliMag * this.maxSpeed - boid.vel.x\n          aliY = aliY / aliMag * this.maxSpeed - boid.vel.y\n          const l = mag2(aliX, aliY)\n          if (l > this.maxForce) {\n            aliX = aliX / l * this.maxForce\n            aliY = aliY / l * this.maxForce\n          }\n        }\n        steerX += aliX * this.alignmentWeight\n        steerY += aliY * this.alignmentWeight\n      }\n\n      // Cohesion\n      if (cohCount > 0) {\n        cohX /= cohCount\n        cohY /= cohCount\n        const cohMag = mag2(cohX, cohY)\n        if (cohMag > 0) {\n          cohX = cohX / cohMag * this.maxSpeed - boid.vel.x\n          cohY = cohY / cohMag * this.maxSpeed - boid.vel.y\n          const l = mag2(cohX, cohY)\n          if (l > this.maxForce) {\n            cohX = cohX / l * this.maxForce\n            cohY = cohY / l * this.maxForce\n          }\n        }\n        steerX += cohX * this.cohesionWeight\n        steerY += cohY * this.cohesionWeight\n      }\n\n      // Mouse influence\n      if (this.mouseInCanvas && this.mouseMode !== 'none') {\n        const mdx = this.mousePos.x - boid.pos.x\n        const mdy = this.mousePos.y - boid.pos.y\n        const mdSq = mdx * mdx + mdy * mdy\n        if (mdSq < this.mouseInfluenceRadius * this.mouseInfluenceRadius && mdSq > 1) {\n          const md = Math.sqrt(mdSq)\n          const factor = this.mouseMode === 'attract' ? 1 : -1\n          const mx = (mdx / md * this.maxSpeed - boid.vel.x) * factor\n          const my = (mdy / md * this.maxSpeed - boid.vel.y) * factor\n          const ml = mag2(mx, my)\n          const cap = this.maxForce * 3\n          if (ml > cap) {\n            steerX += mx / ml * cap\n            steerY += my / ml * cap\n          } else {\n            steerX += mx\n            steerY += my\n          }\n        }\n      }\n\n      // Predator avoidance\n      if (this.predator) {\n        const pd = this.wrapDeltaMut(this.predator.pos.x - boid.pos.x, this.predator.pos.y - boid.pos.y)\n        const pdx = pd.x, pdy = pd.y\n        const pdSq = pdx * pdx + pdy * pdy\n        const scatterRadius = pr * 2\n        if (pdSq < scatterRadius * scatterRadius && pdSq > 1) {\n          const pdd = Math.sqrt(pdSq)\n          const fleeX = (-pdx / pdd * this.maxSpeed - boid.vel.x)\n          const fleeY = (-pdy / pdd * this.maxSpeed - boid.vel.y)\n          const fl = mag2(fleeX, fleeY)\n          const cap = this.maxForce * 4\n          if (fl > cap) {\n            steerX += fleeX / fl * cap\n            steerY += fleeY / fl * cap\n          } else {\n            steerX += fleeX\n            steerY += fleeY\n          }\n        }\n      }\n\n      boid.acc.x = steerX\n      boid.acc.y = steerY\n    }\n\n    // Integrate\n    for (let i = 0; i < n; i++) {\n      const b = boids[i]\n\n      // Store trail (allocation is acceptable here; trails are opt-in)\n      if (this.showTrails) {\n        b.trail.push(v2(b.pos.x, b.pos.y))\n        if (b.trail.length > 5) b.trail.shift()\n      }\n\n      b.vel.x += b.acc.x\n      b.vel.y += b.acc.y\n\n      // Clamp speed\n      const speed = mag2(b.vel.x, b.vel.y)\n      if (speed > this.maxSpeed) {\n        const s = this.maxSpeed / speed\n        b.vel.x *= s\n        b.vel.y *= s\n      } else if (speed < this.minSpeed && speed > 1e-10) {\n        const s = this.minSpeed / speed\n        b.vel.x *= s\n        b.vel.y *= s\n      }\n\n      b.pos.x += b.vel.x\n      b.pos.y += b.vel.y\n      b.acc.x = 0\n      b.acc.y = 0\n\n      // Wrap around edges\n      if (b.pos.x < 0) b.pos.x += w\n      else if (b.pos.x > w) b.pos.x -= w\n      if (b.pos.y < 0) b.pos.y += h\n      else if (b.pos.y > h) b.pos.y -= h\n    }\n\n    // Update predator\n    if (this.predator) {\n      this.updatePredator()\n    }\n  }\n\n  private updatePredator() {\n    const pred = this.predator!\n    const w = this.w\n    const h = this.h\n\n    // Chase nearest boid\n    let nearestDist = Infinity\n    let nearestBoid: Boid | null = null\n    for (const b of this.boids) {\n      const d = this.wrapDeltaMut(b.pos.x - pred.pos.x, b.pos.y - pred.pos.y)\n      const dSq = d.x * d.x + d.y * d.y\n      if (dSq < nearestDist) {\n        nearestDist = dSq\n        nearestBoid = b\n      }\n    }\n\n    if (nearestBoid) {\n      // Safe to use allocating wrapDelta here (once per frame)\n      const d = this.wrapDelta(nearestBoid.pos.x - pred.pos.x, nearestBoid.pos.y - pred.pos.y)\n      const dn = v2norm(d)\n      const desired = v2scale(dn, this.maxSpeed * 0.9)\n      const steer = v2limit(v2sub(desired, pred.vel), this.maxForce * 2)\n      pred.acc = steer\n    }\n\n    pred.vel = v2add(pred.vel, pred.acc)\n    const pSpeed = v2len(pred.vel)\n    if (pSpeed > this.maxSpeed * 0.9) {\n      pred.vel = v2setMag(pred.vel, this.maxSpeed * 0.9)\n    }\n    pred.pos = v2add(pred.pos, pred.vel)\n    pred.acc = v2(0, 0)\n\n    if (pred.pos.x < 0) pred.pos.x += w\n    else if (pred.pos.x > w) pred.pos.x -= w\n    if (pred.pos.y < 0) pred.pos.y += h\n    else if (pred.pos.y > h) pred.pos.y -= h\n  }\n\n  // --- Rendering ---\n\n  private draw() {\n    const ctx = this.ctx\n    const w = this.w\n    const h = this.h\n    const boids = this.boids\n\n    // Clear\n    ctx.fillStyle = '#060612'\n    ctx.fillRect(0, 0, w, h)\n\n    // Draw trails\n    if (this.showTrails) {\n      for (const b of boids) {\n        if (b.trail.length < 2) continue\n        const heading = Math.atan2(b.vel.y, b.vel.x)\n        const hue = ((heading / (Math.PI * 2)) * 360 + 360) % 360\n        ctx.beginPath()\n        ctx.moveTo(b.trail[0].x, b.trail[0].y)\n        for (let t = 1; t < b.trail.length; t++) {\n          ctx.lineTo(b.trail[t].x, b.trail[t].y)\n        }\n        ctx.lineTo(b.pos.x, b.pos.y)\n        ctx.strokeStyle = `hsla(${hue | 0}, 80%, 60%, 0.2)`\n        ctx.lineWidth = 1\n        ctx.stroke()\n      }\n    }\n\n    // Draw boids as triangles\n    const size = 4\n    for (const b of boids) {\n      const heading = Math.atan2(b.vel.y, b.vel.x)\n      const hue = ((heading / (Math.PI * 2)) * 360 + 360) % 360\n\n      ctx.save()\n      ctx.translate(b.pos.x, b.pos.y)\n      ctx.rotate(heading)\n\n      ctx.fillStyle = `hsl(${hue | 0}, 80%, 60%)`\n      ctx.beginPath()\n      ctx.moveTo(size * 2, 0)\n      ctx.lineTo(-size, size)\n      ctx.lineTo(-size, -size)\n      ctx.closePath()\n      ctx.fill()\n\n      ctx.restore()\n    }\n\n    // Draw predator\n    if (this.predator) {\n      const p = this.predator\n      const heading = Math.atan2(p.vel.y, p.vel.x)\n\n      ctx.save()\n      ctx.translate(p.pos.x, p.pos.y)\n      ctx.rotate(heading)\n\n      ctx.fillStyle = '#ff3030'\n      ctx.beginPath()\n      ctx.moveTo(14, 0)\n      ctx.lineTo(-7, 7)\n      ctx.lineTo(-4, 0)\n      ctx.lineTo(-7, -7)\n      ctx.closePath()\n      ctx.fill()\n\n      ctx.shadowColor = '#ff3030'\n      ctx.shadowBlur = 12\n      ctx.fill()\n      ctx.shadowBlur = 0\n\n      ctx.restore()\n    }\n\n    // Mouse indicator\n    if (this.mouseInCanvas && this.mouseMode !== 'none') {\n      ctx.strokeStyle = this.mouseMode === 'attract'\n        ? 'rgba(100, 200, 255, 0.2)'\n        : 'rgba(255, 100, 100, 0.2)'\n      ctx.lineWidth = 1\n      ctx.beginPath()\n      ctx.arc(this.mousePos.x, this.mousePos.y, this.mouseInfluenceRadius, 0, Math.PI * 2)\n      ctx.stroke()\n    }\n  }\n\n  // --- Main loop ---\n\n  private animate = () => {\n    if (this.disposed) return\n    this.animationId = requestAnimationFrame(this.animate)\n    this.updateBoids()\n    this.draw()\n  }\n}\n"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","toPropertyKey","t","i","r","e","toPrimitive","call","TypeError","String","Number","_defineProperties","length","enumerable","configurable","writable","Object","defineProperty","key","_createClass","v2","x","y","v2add","a","b","v2len","Math","sqrt","v2setMag","mag","l","s","mag2","_wd","SpatialHash","width","height","cellSize","maxBoidsPerCell","this","cols","ceil","rows","cellCapacity","totalCells","grid","Int32Array","counts","_proto","clear","fill","insert","index","col","floor","row","cellIdx","count","query","radius","callback","minCol","max","maxCol","min","minRow","maxRow","c","base","resize","BoidsEngine","container","boids","predator","hasPredator","showTrails","separationWeight","alignmentWeight","cohesionWeight","perceptionRadius","maxSpeed","minSpeed","maxForce","mouseMode","mousePos","mouseInCanvas","mouseInfluenceRadius","w","h","animationId","disposed","resizeObserver","onMouseMove","rect","canvas","getBoundingClientRect","clientX","left","clientY","top","onMouseLeave","onTouchMove","preventDefault","touch","touches","onTouchEnd","animate","requestAnimationFrame","updateBoids","draw","document","createElement","style","display","appendChild","ctx","getContext","resizeCanvas","spatialHash","initBoids","initListeners","_proto2","setBoidCount","n","target","push","createRandomBoid","setSeparation","v","setAlignment","setCohesion","setPerceptionRadius","setMouseMode","mode","togglePredator","pos","vel","random","acc","toggleTrails","trail","dispose","cancelAnimationFrame","removeListeners","disconnect","parentElement","removeChild","dpr","window","devicePixelRatio","clientWidth","clientHeight","setTransform","angle","PI","speed","cos","sin","addEventListener","passive","ResizeObserver","observe","removeEventListener","wrapDelta","dx","dy","wrapDeltaMut","pr","prSq","boid","sepX","sepY","sepCount","aliX","aliY","aliCount","cohX","cohY","cohCount","j","other","delta","dSq","d","steerX","steerY","sepMag","aliMag","cohMag","mdx","mdy","mdSq","md","factor","mx","my","ml","cap","pd","pdx","pdy","pdSq","scatterRadius","pdd","fleeX","fleeY","fl","shift","updatePredator","pred","nearestDist","Infinity","nearestBoid","dn","v2norm","steer","lsq","v2lenSq","v2limit","v2sub","fillStyle","fillRect","hue","atan2","beginPath","moveTo","lineTo","strokeStyle","lineWidth","stroke","heading","save","translate","rotate","size","closePath","restore","p","shadowColor","shadowBlur","arc","get"],"sourceRoot":""}