{"version":3,"file":"3322-586a0d7fa48d609e3b85.js","mappings":"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","sources":["webpack://jiunbae.github.io/./node_modules/.pnpm/@babel+runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://jiunbae.github.io/./node_modules/.pnpm/@babel+runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://jiunbae.github.io/./node_modules/.pnpm/@babel+runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://jiunbae.github.io/./node_modules/.pnpm/@babel+runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://jiunbae.github.io/./src/views/ShaderArt/engine.ts"],"sourcesContent":["function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nexport { _createClass as default };","/**\n * Shader Art Gallery Engine\n *\n * Pure WebGL renderer that displays a full-screen quad with\n * interchangeable fragment shaders. Each shader receives\n * uTime, uResolution, and uMouse uniforms.\n */\n\n// ---------------------------------------------------------------------------\n// Helpers\n// ---------------------------------------------------------------------------\n\nfunction compileShader(gl: WebGLRenderingContext, type: number, source: string): WebGLShader {\n  const shader = gl.createShader(type)\n  if (!shader) throw new Error('Failed to create shader — WebGL context may be lost')\n  gl.shaderSource(shader, source)\n  gl.compileShader(shader)\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    const info = gl.getShaderInfoLog(shader)\n    gl.deleteShader(shader)\n    throw new Error(`Shader compile error: ${info}`)\n  }\n  return shader\n}\n\nfunction createProgram(gl: WebGLRenderingContext, vertSrc: string, fragSrc: string): WebGLProgram {\n  const program = gl.createProgram()\n  if (!program) throw new Error('Failed to create program — WebGL context may be lost')\n  gl.attachShader(program, compileShader(gl, gl.VERTEX_SHADER, vertSrc))\n  gl.attachShader(program, compileShader(gl, gl.FRAGMENT_SHADER, fragSrc))\n  gl.linkProgram(program)\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n    throw new Error(`Program link error: ${gl.getProgramInfoLog(program)}`)\n  }\n  return program\n}\n\n// ---------------------------------------------------------------------------\n// Vertex shader (shared)\n// ---------------------------------------------------------------------------\n\nconst VERT_SRC = `\nattribute vec2 aPosition;\nvarying vec2 vUv;\nvoid main() {\n  vUv = aPosition * 0.5 + 0.5;\n  gl_Position = vec4(aPosition, 0.0, 1.0);\n}\n`\n\n// ---------------------------------------------------------------------------\n// Fragment shaders\n// ---------------------------------------------------------------------------\n\nconst SHADER_NAMES = [\n  'Plasma',\n  'Kaleidoscope',\n  'Metaballs',\n  'Fractal Flames',\n  'Voronoi Cells',\n  'Aurora',\n  'Liquid Metal',\n  'Neon Grid',\n]\n\nconst FRAG_PREFIX = `\nprecision highp float;\nvarying vec2 vUv;\nuniform float uTime;\nuniform vec2 uResolution;\nuniform vec2 uMouse;\n`\n\nconst FRAG_SHADERS: string[] = [\n  // 0 - Plasma\n  FRAG_PREFIX + `\nvoid main() {\n  vec2 uv = vUv;\n  float t = uTime * 0.8;\n  float v = 0.0;\n  vec2 c = uv * 6.0 - 3.0;\n  v += sin(c.x + t);\n  v += sin((c.y + t) * 0.5);\n  v += sin((c.x + c.y + t) * 0.5);\n  c += vec2(sin(t * 0.3), cos(t * 0.5)) * 2.0;\n  v += sin(sqrt(c.x * c.x + c.y * c.y + 1.0) + t);\n  v *= 0.5;\n\n  vec3 col = vec3(\n    sin(v * 3.14159 + 0.0) * 0.5 + 0.5,\n    sin(v * 3.14159 + 2.094) * 0.5 + 0.5,\n    sin(v * 3.14159 + 4.188) * 0.5 + 0.5\n  );\n\n  // Mouse interaction: shift colors near cursor\n  float md = length(uv - uMouse) * 3.0;\n  col = mix(col.gbr, col, smoothstep(0.0, 1.0, md));\n\n  gl_FragColor = vec4(col, 1.0);\n}\n`,\n\n  // 1 - Kaleidoscope\n  FRAG_PREFIX + `\nvoid main() {\n  vec2 uv = (vUv - 0.5) * 2.0;\n  float aspect = uResolution.x / uResolution.y;\n  uv.x *= aspect;\n\n  float t = uTime * 0.5;\n  float angle = atan(uv.y, uv.x) + t * 0.3;\n  float r = length(uv);\n\n  // Kaleidoscope fold\n  float segments = 8.0;\n  angle = mod(angle, 3.14159 * 2.0 / segments);\n  angle = abs(angle - 3.14159 / segments);\n\n  vec2 p = vec2(cos(angle), sin(angle)) * r;\n\n  // Pattern\n  float v = 0.0;\n  v += sin(p.x * 8.0 + t * 2.0) * 0.5;\n  v += cos(p.y * 6.0 - t * 1.5) * 0.5;\n  v += sin((p.x + p.y) * 10.0 + t) * 0.3;\n  v += sin(r * 12.0 - t * 3.0) * 0.4;\n\n  vec3 col;\n  col.r = sin(v * 3.0 + t) * 0.5 + 0.5;\n  col.g = sin(v * 3.0 + t + 2.094) * 0.5 + 0.5;\n  col.b = sin(v * 3.0 + t + 4.188) * 0.5 + 0.5;\n\n  // Brighten center\n  col *= 1.0 - r * 0.3;\n  // Mouse shifts pattern\n  col *= 1.0 + 0.3 * sin(r * 6.0 + uMouse.x * 6.28);\n\n  gl_FragColor = vec4(col, 1.0);\n}\n`,\n\n  // 2 - Metaballs\n  FRAG_PREFIX + `\nvoid main() {\n  vec2 uv = vUv;\n  float aspect = uResolution.x / uResolution.y;\n  uv.x *= aspect;\n\n  float t = uTime * 0.7;\n  float sum = 0.0;\n\n  // 6 metaballs\n  for (int i = 0; i < 6; i++) {\n    float fi = float(i);\n    vec2 center = vec2(\n      0.5 * aspect + sin(t * (0.3 + fi * 0.1) + fi * 1.2) * 0.35 * aspect,\n      0.5 + cos(t * (0.4 + fi * 0.12) + fi * 0.8) * 0.35\n    );\n    float d = length(uv - center);\n    sum += 0.015 / (d * d + 0.001);\n  }\n\n  // Mouse-controlled metaball\n  vec2 mousePos = vec2(uMouse.x * aspect, uMouse.y);\n  float md = length(uv - mousePos);\n  sum += 0.02 / (md * md + 0.001);\n\n  // Color based on field strength\n  float edge = smoothstep(8.0, 12.0, sum);\n  float glow = smoothstep(3.0, 8.0, sum);\n\n  vec3 neon1 = vec3(0.0, 1.0, 0.8);\n  vec3 neon2 = vec3(1.0, 0.0, 0.6);\n  vec3 neon3 = vec3(0.2, 0.4, 1.0);\n\n  vec3 col = mix(neon3, neon1, sin(sum * 0.3 + t) * 0.5 + 0.5);\n  col = mix(col, neon2, sin(sum * 0.2 + t * 0.5 + 1.0) * 0.5 + 0.5);\n\n  col *= glow;\n  col += vec3(1.0) * edge * 0.3;\n\n  // Subtle dark background\n  col = mix(vec3(0.02, 0.01, 0.05), col, smoothstep(2.0, 5.0, sum));\n\n  gl_FragColor = vec4(col, 1.0);\n}\n`,\n\n  // 3 - Fractal Flames\n  FRAG_PREFIX + `\nvec2 variation1(vec2 p, float t) {\n  return vec2(sin(p.x + t), sin(p.y + t));\n}\nvec2 variation2(vec2 p) {\n  float r2 = dot(p, p);\n  return p / (r2 + 0.001);\n}\nvec2 variation3(vec2 p, float t) {\n  float r = length(p);\n  float theta = atan(p.y, p.x);\n  return r * vec2(sin(theta + r + t), cos(theta - r + t));\n}\n\nvoid main() {\n  vec2 uv = (vUv - 0.5) * 4.0;\n  float t = uTime * 0.3;\n\n  vec3 accum = vec3(0.0);\n  vec2 p = uv + (uMouse - 0.5) * 2.0;\n\n  for (int i = 0; i < 20; i++) {\n    float fi = float(i);\n    float w = fract(fi * 0.618 + t * 0.1);\n\n    if (w < 0.33) {\n      p = variation1(p * 0.7, t + fi * 0.1);\n    } else if (w < 0.66) {\n      p = variation2(p * 0.8);\n    } else {\n      p = variation3(p * 0.6, t + fi * 0.05);\n    }\n\n    // Accumulate color\n    float intensity = exp(-length(p) * 0.5) * 0.15;\n    vec3 c = vec3(\n      sin(fi * 0.3 + t) * 0.5 + 0.5,\n      sin(fi * 0.3 + t + 2.0) * 0.5 + 0.5,\n      sin(fi * 0.3 + t + 4.0) * 0.5 + 0.5\n    );\n    accum += c * intensity;\n  }\n\n  // Tone mapping\n  accum = 1.0 - exp(-accum * 3.0);\n\n  // Vignette\n  float vig = 1.0 - dot(vUv - 0.5, vUv - 0.5) * 1.5;\n  accum *= vig;\n\n  gl_FragColor = vec4(accum, 1.0);\n}\n`,\n\n  // 4 - Voronoi Cells\n  FRAG_PREFIX + `\nvec2 hash2(vec2 p) {\n  p = vec2(dot(p, vec2(127.1, 311.7)), dot(p, vec2(269.5, 183.3)));\n  return fract(sin(p) * 43758.5453);\n}\n\nvoid main() {\n  vec2 uv = vUv;\n  float aspect = uResolution.x / uResolution.y;\n  uv.x *= aspect;\n  float t = uTime * 0.5;\n\n  float scale = 6.0;\n  vec2 st = uv * scale;\n  vec2 i_st = floor(st);\n  vec2 f_st = fract(st);\n\n  float minDist = 10.0;\n  float secondDist = 10.0;\n  vec2 minPoint = vec2(0.0);\n\n  for (int y = -1; y <= 1; y++) {\n    for (int x = -1; x <= 1; x++) {\n      vec2 neighbor = vec2(float(x), float(y));\n      vec2 point = hash2(i_st + neighbor);\n      // Animate points\n      point = 0.5 + 0.5 * sin(t + 6.2831 * point);\n      vec2 diff = neighbor + point - f_st;\n      float d = length(diff);\n      if (d < minDist) {\n        secondDist = minDist;\n        minDist = d;\n        minPoint = point;\n      } else if (d < secondDist) {\n        secondDist = d;\n      }\n    }\n  }\n\n  float edge = secondDist - minDist;\n\n  // Coloring\n  vec3 cellColor = vec3(\n    sin(minPoint.x * 6.28 + t) * 0.5 + 0.5,\n    sin(minPoint.y * 6.28 + t + 2.0) * 0.5 + 0.5,\n    sin((minPoint.x + minPoint.y) * 6.28 + t + 4.0) * 0.5 + 0.5\n  );\n\n  // Edge glow\n  float edgeLine = 1.0 - smoothstep(0.0, 0.08, edge);\n  vec3 edgeColor = vec3(0.9, 0.95, 1.0);\n\n  // Distance gradient inside cell\n  cellColor *= 0.3 + 0.7 * (1.0 - minDist);\n\n  vec3 col = mix(cellColor, edgeColor, edgeLine);\n\n  // Mouse proximity brightening\n  float mouseDist = length(vUv - uMouse);\n  col += 0.15 * exp(-mouseDist * 4.0);\n\n  gl_FragColor = vec4(col, 1.0);\n}\n`,\n\n  // 5 - Aurora\n  FRAG_PREFIX + `\nfloat noise(vec2 p) {\n  vec2 i = floor(p);\n  vec2 f = fract(p);\n  f = f * f * (3.0 - 2.0 * f);\n  float a = sin(dot(i, vec2(127.1, 311.7))) * 43758.5453;\n  float b = sin(dot(i + vec2(1.0, 0.0), vec2(127.1, 311.7))) * 43758.5453;\n  float c = sin(dot(i + vec2(0.0, 1.0), vec2(127.1, 311.7))) * 43758.5453;\n  float d = sin(dot(i + vec2(1.0, 1.0), vec2(127.1, 311.7))) * 43758.5453;\n  a = fract(a); b = fract(b); c = fract(c); d = fract(d);\n  return mix(mix(a, b, f.x), mix(c, d, f.x), f.y);\n}\n\nfloat fbm(vec2 p) {\n  float v = 0.0;\n  float a = 0.5;\n  vec2 shift = vec2(100.0);\n  mat2 rot = mat2(cos(0.5), sin(0.5), -sin(0.5), cos(0.5));\n  for (int i = 0; i < 6; i++) {\n    v += a * noise(p);\n    p = rot * p * 2.0 + shift;\n    a *= 0.5;\n  }\n  return v;\n}\n\nvoid main() {\n  vec2 uv = vUv;\n  float t = uTime * 0.2;\n\n  // Sky gradient (dark to deep blue)\n  vec3 skyBottom = vec3(0.01, 0.01, 0.03);\n  vec3 skyTop = vec3(0.02, 0.05, 0.15);\n  vec3 sky = mix(skyBottom, skyTop, uv.y);\n\n  // Aurora layers\n  vec3 aurora = vec3(0.0);\n\n  for (int i = 0; i < 4; i++) {\n    float fi = float(i);\n    float yOffset = 0.4 + fi * 0.1;\n    float scale = 3.0 + fi * 0.5;\n\n    vec2 p = vec2(uv.x * scale + t * (0.5 + fi * 0.2), uv.y * 2.0);\n    p.x += uMouse.x * 0.5;\n    float n = fbm(p + fi * 1.3);\n    float n2 = fbm(p * 1.5 + fi * 2.7 + t * 0.3);\n\n    // Vertical curtain shape\n    float curtain = exp(-pow((uv.y - yOffset - n * 0.15) * 4.0, 2.0));\n    curtain *= smoothstep(0.2, 0.5, uv.y) * smoothstep(0.95, 0.7, uv.y);\n\n    float intensity = curtain * n2 * (0.8 + fi * 0.1);\n\n    vec3 green = vec3(0.1, 0.9, 0.3);\n    vec3 teal = vec3(0.0, 0.6, 0.8);\n    vec3 purple = vec3(0.5, 0.1, 0.8);\n    vec3 pink = vec3(0.8, 0.2, 0.5);\n\n    vec3 layerCol;\n    if (i == 0) layerCol = mix(green, teal, n);\n    else if (i == 1) layerCol = mix(teal, purple, n);\n    else if (i == 2) layerCol = mix(purple, pink, n);\n    else layerCol = mix(green, purple, n);\n\n    aurora += layerCol * intensity;\n  }\n\n  // Stars\n  vec2 starUv = uv * vec2(uResolution.x / uResolution.y, 1.0) * 40.0;\n  float star = noise(floor(starUv));\n  star = step(0.98, star) * star;\n  float twinkle = sin(star * 400.0 + t * 3.0) * 0.5 + 0.5;\n  vec3 stars = vec3(star * twinkle * 0.8);\n\n  vec3 col = sky + aurora * 1.5 + stars * (1.0 - length(aurora) * 0.5);\n\n  gl_FragColor = vec4(col, 1.0);\n}\n`,\n\n  // 6 - Liquid Metal\n  FRAG_PREFIX + `\nfloat hash(vec2 p) {\n  return fract(sin(dot(p, vec2(127.1, 311.7))) * 43758.5453);\n}\n\nfloat noise(vec2 p) {\n  vec2 i = floor(p);\n  vec2 f = fract(p);\n  f = f * f * (3.0 - 2.0 * f);\n  float a = hash(i);\n  float b = hash(i + vec2(1.0, 0.0));\n  float c = hash(i + vec2(0.0, 1.0));\n  float d = hash(i + vec2(1.0, 1.0));\n  return mix(mix(a, b, f.x), mix(c, d, f.x), f.y);\n}\n\nfloat fbm(vec2 p) {\n  float v = 0.0;\n  float a = 0.5;\n  for (int i = 0; i < 5; i++) {\n    v += a * noise(p);\n    p *= 2.0;\n    a *= 0.5;\n  }\n  return v;\n}\n\nvoid main() {\n  vec2 uv = vUv;\n  float aspect = uResolution.x / uResolution.y;\n  vec2 p = (uv - 0.5) * vec2(aspect, 1.0);\n  float t = uTime * 0.4;\n\n  // Distorted reflection coordinates\n  vec2 distort = vec2(\n    fbm(p * 3.0 + vec2(t, 0.0)),\n    fbm(p * 3.0 + vec2(0.0, t))\n  );\n  vec2 distort2 = vec2(\n    fbm(p * 3.0 + distort * 2.0 + vec2(t * 0.7, t * 0.3)),\n    fbm(p * 3.0 + distort * 2.0 + vec2(t * 0.3, t * 0.7))\n  );\n\n  // Chrome-like reflections\n  float n = fbm(p * 2.0 + distort2 * 3.0);\n\n  // Surface normal approximation\n  float eps = 0.01;\n  float nx = fbm(p * 2.0 + distort2 * 3.0 + vec2(eps, 0.0)) - n;\n  float ny = fbm(p * 2.0 + distort2 * 3.0 + vec2(0.0, eps)) - n;\n  vec3 normal = normalize(vec3(nx, ny, eps * 2.0));\n\n  // Fake environment reflection\n  vec3 viewDir = normalize(vec3(p - (uMouse - 0.5) * 0.5, 1.0));\n  vec3 reflected = reflect(viewDir, normal);\n\n  // Gradient environment\n  float envAngle = atan(reflected.y, reflected.x) * 0.318;\n  float envHeight = reflected.z * 0.5 + 0.5;\n\n  vec3 envColor = vec3(0.0);\n  envColor += vec3(0.8, 0.85, 0.9) * smoothstep(0.3, 0.7, envHeight);\n  envColor += vec3(0.2, 0.3, 0.5) * (1.0 - envHeight);\n  envColor += vec3(0.15) * sin(envAngle * 12.0 + t) * 0.5;\n\n  // Fresnel\n  float fresnel = pow(1.0 - abs(dot(vec3(0.0, 0.0, 1.0), normal)), 3.0);\n  vec3 col = mix(envColor * 0.4, envColor, fresnel + 0.5);\n\n  // Chrome specular highlights\n  float spec = pow(max(reflected.z, 0.0), 20.0);\n  col += vec3(1.0, 0.95, 0.9) * spec * 0.8;\n\n  // Warm/cool color variation\n  col *= 0.8 + 0.4 * vec3(\n    sin(n * 6.0 + t) * 0.5 + 0.5,\n    sin(n * 6.0 + t + 1.0) * 0.3 + 0.7,\n    sin(n * 6.0 + t + 2.0) * 0.5 + 0.5\n  );\n\n  gl_FragColor = vec4(col, 1.0);\n}\n`,\n\n  // 7 - Neon Grid\n  FRAG_PREFIX + `\nvoid main() {\n  vec2 uv = vUv;\n  float t = uTime;\n\n  // Sky gradient\n  vec3 col = mix(\n    vec3(0.0, 0.0, 0.02),\n    vec3(0.05, 0.0, 0.15),\n    uv.y\n  );\n\n  // Horizon line\n  float horizon = 0.35;\n\n  // Sun\n  float sunY = horizon + 0.18;\n  vec2 sunCenter = vec2(0.5, sunY);\n  float sunDist = length((uv - sunCenter) * vec2(uResolution.x / uResolution.y, 1.0));\n  vec3 sunColor = mix(vec3(1.0, 0.3, 0.6), vec3(1.0, 0.8, 0.2), smoothstep(0.0, 0.12, sunDist));\n\n  // Sun body with scanlines\n  float sunMask = smoothstep(0.12, 0.115, sunDist);\n  float scanline = step(0.5, fract(uv.y * 60.0));\n  // Clip bottom half of sun with scanline gap\n  float sunClip = smoothstep(horizon + 0.01, horizon + 0.16, uv.y);\n  sunMask *= sunClip;\n  sunMask *= mix(1.0, scanline, smoothstep(sunY - 0.05, sunY - 0.12, uv.y));\n  col = mix(col, sunColor, sunMask);\n\n  // Sun glow\n  float glow = exp(-sunDist * 6.0) * 0.6;\n  col += vec3(1.0, 0.2, 0.5) * glow;\n\n  // Grid (below horizon)\n  if (uv.y < horizon) {\n    // Perspective transform\n    float perspective = (horizon - uv.y) / horizon;\n    float z = 1.0 / (perspective + 0.01);\n    float x = (uv.x - 0.5) * z * 2.0;\n\n    // Grid lines with scrolling\n    float speed = t * 2.0;\n    float gridZ = fract(z * 0.3 - speed * 0.1);\n    float gridX = fract(x * 0.5);\n\n    float lineZ = smoothstep(0.02, 0.0, abs(gridZ - 0.5) - 0.48);\n    float lineX = smoothstep(0.02, 0.0, abs(gridX - 0.5) - 0.48);\n\n    float grid = max(lineZ, lineX);\n\n    // Fade with distance\n    float fade = exp(-perspective * 0.3);\n    grid *= fade;\n\n    // Grid color (neon cyan/pink)\n    vec3 gridColor = mix(\n      vec3(0.0, 0.8, 1.0),\n      vec3(1.0, 0.0, 0.8),\n      sin(z * 0.1 + t * 0.5) * 0.5 + 0.5\n    );\n\n    // Mouse moves grid color\n    gridColor = mix(gridColor, vec3(0.5, 0.0, 1.0), uMouse.x * 0.3);\n\n    col += gridColor * grid * 0.8;\n\n    // Fog at horizon\n    col = mix(col, vec3(0.1, 0.0, 0.2), smoothstep(0.1, 0.0, perspective));\n  }\n\n  // Horizontal glow line at horizon\n  float horizGlow = exp(-abs(uv.y - horizon) * 40.0) * 0.5;\n  col += vec3(1.0, 0.3, 0.7) * horizGlow;\n\n  // Vignette\n  float vig = 1.0 - dot((uv - 0.5) * 1.2, (uv - 0.5) * 1.2);\n  col *= vig;\n\n  gl_FragColor = vec4(col, 1.0);\n}\n`,\n]\n\n// ---------------------------------------------------------------------------\n// Context loss overlay\n// ---------------------------------------------------------------------------\n\nfunction showContextLostOverlay(container: HTMLElement): HTMLDivElement {\n  const overlay = document.createElement('div')\n  overlay.style.cssText = 'position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.8);color:#fff;font:14px/1.5 sans-serif;cursor:pointer;z-index:100'\n  overlay.textContent = 'WebGL context lost — click to reload'\n  overlay.addEventListener('click', () => location.reload())\n  container.style.position = 'relative'\n  container.appendChild(overlay)\n  return overlay\n}\n\n// ---------------------------------------------------------------------------\n// Engine\n// ---------------------------------------------------------------------------\n\nexport class ShaderArtEngine {\n  private canvas: HTMLCanvasElement\n  private gl: WebGLRenderingContext\n  private quadBuffer: WebGLBuffer\n  private vertShader: WebGLShader\n\n  private programs: WebGLProgram[] = []\n  private _currentIndex = 0\n\n  // Crossfade state\n  private prevProgram: WebGLProgram | null = null\n  private fadeAlpha = 1.0 // 1 = fully current, 0 = fully previous\n  private fading = false\n\n  // Uniforms cache per program\n  private uniformCache = new Map<WebGLProgram, {\n    uTime: WebGLUniformLocation | null\n    uResolution: WebGLUniformLocation | null\n    uMouse: WebGLUniformLocation | null\n  }>()\n\n  // State\n  private mouse = { x: 0.5, y: 0.5 }\n  private time = 0\n  private animationId = 0\n  private lastTime = 0\n  private disposed = false\n  private resizeObserver: ResizeObserver | null = null\n\n  // Crossfade FBOs\n  private fboA: { framebuffer: WebGLFramebuffer; texture: WebGLTexture } | null = null\n  private fboB: { framebuffer: WebGLFramebuffer; texture: WebGLTexture } | null = null\n  private blendProgram: WebGLProgram | null = null\n  private blendUniforms: {\n    uTexA: WebGLUniformLocation | null\n    uTexB: WebGLUniformLocation | null\n    uMix: WebGLUniformLocation | null\n  } | null = null\n\n  constructor(private container: HTMLDivElement) {\n    this.canvas = document.createElement('canvas')\n    this.canvas.style.width = '100%'\n    this.canvas.style.height = '100%'\n    this.canvas.style.display = 'block'\n    container.appendChild(this.canvas)\n\n    const gl = this.canvas.getContext('webgl', {\n      alpha: false,\n      depth: false,\n      stencil: false,\n      antialias: false,\n      preserveDrawingBuffer: false,\n    })\n    if (!gl) throw new Error('WebGL not supported')\n    this.gl = gl\n\n    this.canvas.addEventListener('webglcontextlost', this.handleContextLost)\n    this.canvas.addEventListener('webglcontextrestored', this.handleContextRestored)\n\n    // Vertex shader (shared)\n    this.vertShader = compileShader(gl, gl.VERTEX_SHADER, VERT_SRC)\n\n    // Quad buffer\n    this.quadBuffer = gl.createBuffer()!\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer)\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1, -1, -1, 1, 1, 1, 1, -1]), gl.STATIC_DRAW)\n\n    // Compile all shader programs\n    for (const fragSrc of FRAG_SHADERS) {\n      const program = this.buildProgram(fragSrc)\n      this.programs.push(program)\n    }\n\n    // Blend program for crossfade\n    this.initBlendProgram()\n\n    this.resizeCanvas()\n    this.initFBOs()\n    this.initListeners()\n    this.lastTime = performance.now()\n    this.animate()\n  }\n\n  // --- Public API ---\n\n  get shaderCount(): number {\n    return this.programs.length\n  }\n\n  get shaderNames(): string[] {\n    return [...SHADER_NAMES]\n  }\n\n  get currentIndex(): number {\n    return this._currentIndex\n  }\n\n  setShader(index: number) {\n    if (index < 0 || index >= this.programs.length) return\n    if (index === this._currentIndex && !this.fading) return\n\n    this.prevProgram = this.programs[this._currentIndex]\n    this._currentIndex = index\n    this.fadeAlpha = 0.0\n    this.fading = true\n  }\n\n  dispose() {\n    this.disposed = true\n    cancelAnimationFrame(this.animationId)\n    this.removeListeners()\n    this.canvas.removeEventListener('webglcontextlost', this.handleContextLost)\n    this.canvas.removeEventListener('webglcontextrestored', this.handleContextRestored)\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect()\n      this.resizeObserver = null\n    }\n    this.gl.getExtension('WEBGL_lose_context')?.loseContext()\n    if (this.canvas.parentElement) {\n      this.canvas.parentElement.removeChild(this.canvas)\n    }\n  }\n\n  // --- Internal ---\n\n  private buildProgram(fragSrc: string): WebGLProgram {\n    const gl = this.gl\n    const fragShader = compileShader(gl, gl.FRAGMENT_SHADER, fragSrc)\n    const program = gl.createProgram()\n    if (!program) throw new Error('Failed to create program — WebGL context may be lost')\n    gl.attachShader(program, this.vertShader)\n    gl.attachShader(program, fragShader)\n    gl.bindAttribLocation(program, 0, 'aPosition')\n    gl.linkProgram(program)\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      throw new Error(`Program link error: ${gl.getProgramInfoLog(program)}`)\n    }\n    // Cache uniforms\n    this.uniformCache.set(program, {\n      uTime: gl.getUniformLocation(program, 'uTime'),\n      uResolution: gl.getUniformLocation(program, 'uResolution'),\n      uMouse: gl.getUniformLocation(program, 'uMouse'),\n    })\n    return program\n  }\n\n  private initBlendProgram() {\n    const gl = this.gl\n    const fragSrc = `\n      precision highp float;\n      varying vec2 vUv;\n      uniform sampler2D uTexA;\n      uniform sampler2D uTexB;\n      uniform float uMix;\n      void main() {\n        vec4 a = texture2D(uTexA, vUv);\n        vec4 b = texture2D(uTexB, vUv);\n        gl_FragColor = mix(a, b, uMix);\n      }\n    `\n    this.blendProgram = createProgram(gl, VERT_SRC, fragSrc)\n    gl.bindAttribLocation(this.blendProgram, 0, 'aPosition')\n    gl.linkProgram(this.blendProgram)\n    this.blendUniforms = {\n      uTexA: gl.getUniformLocation(this.blendProgram, 'uTexA'),\n      uTexB: gl.getUniformLocation(this.blendProgram, 'uTexB'),\n      uMix: gl.getUniformLocation(this.blendProgram, 'uMix'),\n    }\n  }\n\n  private createFBO() {\n    const gl = this.gl\n    const texture = gl.createTexture()!\n    gl.bindTexture(gl.TEXTURE_2D, texture)\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.canvas.width, this.canvas.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE)\n\n    const framebuffer = gl.createFramebuffer()!\n    gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer)\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0)\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null)\n\n    return { framebuffer, texture }\n  }\n\n  private initFBOs() {\n    this.fboA = this.createFBO()\n    this.fboB = this.createFBO()\n  }\n\n  private resizeCanvas() {\n    const dpr = Math.min(window.devicePixelRatio, 2)\n    const w = this.container.clientWidth\n    const h = this.container.clientHeight\n    this.canvas.width = Math.floor(w * dpr)\n    this.canvas.height = Math.floor(h * dpr)\n  }\n\n  private resizeFBOs() {\n    const gl = this.gl\n    const w = this.canvas.width\n    const h = this.canvas.height\n\n    if (this.fboA) {\n      gl.bindTexture(gl.TEXTURE_2D, this.fboA.texture)\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, w, h, 0, gl.RGBA, gl.UNSIGNED_BYTE, null)\n    }\n    if (this.fboB) {\n      gl.bindTexture(gl.TEXTURE_2D, this.fboB.texture)\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, w, h, 0, gl.RGBA, gl.UNSIGNED_BYTE, null)\n    }\n  }\n\n  private renderProgram(program: WebGLProgram, target: WebGLFramebuffer | null) {\n    const gl = this.gl\n    gl.bindFramebuffer(gl.FRAMEBUFFER, target)\n    gl.viewport(0, 0, this.canvas.width, this.canvas.height)\n    gl.useProgram(program)\n\n    const u = this.uniformCache.get(program)\n    if (u) {\n      if (u.uTime) gl.uniform1f(u.uTime, this.time)\n      if (u.uResolution) gl.uniform2f(u.uResolution, this.canvas.width, this.canvas.height)\n      if (u.uMouse) gl.uniform2f(u.uMouse, this.mouse.x, this.mouse.y)\n    }\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer)\n    gl.enableVertexAttribArray(0)\n    gl.vertexAttribPointer(0, 2, gl.FLOAT, false, 0, 0)\n    gl.drawArrays(gl.TRIANGLE_FAN, 0, 4)\n  }\n\n  private renderBlend(texA: WebGLTexture, texB: WebGLTexture, mix: number) {\n    const gl = this.gl\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null)\n    gl.viewport(0, 0, this.canvas.width, this.canvas.height)\n\n    gl.useProgram(this.blendProgram!)\n\n    gl.activeTexture(gl.TEXTURE0)\n    gl.bindTexture(gl.TEXTURE_2D, texA)\n    gl.uniform1i(this.blendUniforms!.uTexA, 0)\n\n    gl.activeTexture(gl.TEXTURE1)\n    gl.bindTexture(gl.TEXTURE_2D, texB)\n    gl.uniform1i(this.blendUniforms!.uTexB, 1)\n\n    gl.uniform1f(this.blendUniforms!.uMix, mix)\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer)\n    gl.enableVertexAttribArray(0)\n    gl.vertexAttribPointer(0, 2, gl.FLOAT, false, 0, 0)\n    gl.drawArrays(gl.TRIANGLE_FAN, 0, 4)\n  }\n\n  // --- Listeners ---\n\n  private onMouseMove = (e: MouseEvent) => {\n    const rect = this.canvas.getBoundingClientRect()\n    this.mouse.x = (e.clientX - rect.left) / rect.width\n    this.mouse.y = 1.0 - (e.clientY - rect.top) / rect.height\n  }\n\n  private onTouchMove = (e: TouchEvent) => {\n    if (e.touches.length > 0) {\n      const touch = e.touches[0]\n      const rect = this.canvas.getBoundingClientRect()\n      this.mouse.x = (touch.clientX - rect.left) / rect.width\n      this.mouse.y = 1.0 - (touch.clientY - rect.top) / rect.height\n    }\n  }\n\n  private onResize = () => {\n    this.resizeCanvas()\n    this.resizeFBOs()\n  }\n\n  private initListeners() {\n    this.canvas.addEventListener('mousemove', this.onMouseMove)\n    this.canvas.addEventListener('touchmove', this.onTouchMove, { passive: true })\n\n    this.resizeObserver = new ResizeObserver(() => {\n      if (!this.disposed) this.onResize()\n    })\n    this.resizeObserver.observe(this.container)\n  }\n\n  private removeListeners() {\n    this.canvas.removeEventListener('mousemove', this.onMouseMove)\n    this.canvas.removeEventListener('touchmove', this.onTouchMove)\n  }\n\n  // --- Context loss ---\n\n  private handleContextLost = (e: Event) => {\n    e.preventDefault()\n    cancelAnimationFrame(this.animationId)\n    showContextLostOverlay(this.container)\n  }\n\n  private handleContextRestored = () => {\n    location.reload()\n  }\n\n  // --- Animation loop ---\n\n  private animate = () => {\n    if (this.disposed) return\n    this.animationId = requestAnimationFrame(this.animate)\n\n    const now = performance.now()\n    const dt = Math.min((now - this.lastTime) * 0.001, 0.05)\n    this.lastTime = now\n    this.time += dt\n\n    const currentProgram = this.programs[this._currentIndex]\n\n    if (this.fading && this.prevProgram && this.fboA && this.fboB) {\n      // Render previous shader to FBO A\n      this.renderProgram(this.prevProgram, this.fboA.framebuffer)\n      // Render current shader to FBO B\n      this.renderProgram(currentProgram, this.fboB.framebuffer)\n\n      // Advance fade\n      this.fadeAlpha = Math.min(this.fadeAlpha + dt * 2.5, 1.0)\n      if (this.fadeAlpha >= 1.0) {\n        this.fading = false\n        this.prevProgram = null\n      }\n\n      // Blend to screen\n      this.renderBlend(this.fboA.texture, this.fboB.texture, this.fadeAlpha)\n    } else {\n      // Direct render to screen\n      this.renderProgram(currentProgram, null)\n    }\n  }\n}\n"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","toPropertyKey","t","i","r","e","toPrimitive","call","TypeError","String","Number","_defineProperties","length","enumerable","configurable","writable","Object","defineProperty","key","_createClass","compileShader","gl","type","source","shader","createShader","Error","shaderSource","getShaderParameter","COMPILE_STATUS","info","getShaderInfoLog","deleteShader","VERT_SRC","SHADER_NAMES","FRAG_PREFIX","FRAG_SHADERS","ShaderArtEngine","container","programs","_currentIndex","prevProgram","fadeAlpha","fading","uniformCache","Map","mouse","x","y","time","animationId","lastTime","disposed","resizeObserver","fboA","fboB","blendProgram","blendUniforms","onMouseMove","rect","this","canvas","getBoundingClientRect","clientX","left","width","clientY","top","height","onTouchMove","touches","touch","onResize","resizeCanvas","resizeFBOs","handleContextLost","preventDefault","cancelAnimationFrame","overlay","document","createElement","style","cssText","textContent","addEventListener","location","reload","position","appendChild","showContextLostOverlay","handleContextRestored","animate","requestAnimationFrame","now","performance","dt","Math","min","currentProgram","renderProgram","framebuffer","renderBlend","texture","display","getContext","alpha","depth","stencil","antialias","preserveDrawingBuffer","vertShader","VERTEX_SHADER","quadBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","fragSrc","program","buildProgram","push","initBlendProgram","initFBOs","initListeners","_proto","setShader","index","dispose","_this$gl$getExtension","removeListeners","removeEventListener","disconnect","getExtension","loseContext","parentElement","removeChild","fragShader","FRAGMENT_SHADER","createProgram","attachShader","bindAttribLocation","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","set","uTime","getUniformLocation","uResolution","uMouse","vertSrc","uTexA","uTexB","uMix","createFBO","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","createFramebuffer","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","dpr","window","devicePixelRatio","w","clientWidth","h","clientHeight","floor","target","viewport","useProgram","u","get","uniform1f","uniform2f","enableVertexAttribArray","vertexAttribPointer","FLOAT","drawArrays","TRIANGLE_FAN","texA","texB","mix","activeTexture","TEXTURE0","uniform1i","TEXTURE1","passive","ResizeObserver","observe","concat"],"sourceRoot":""}