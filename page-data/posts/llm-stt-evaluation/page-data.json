{"componentChunkName":"component---src-templates-post-tsx","path":"/posts/llm-stt-evaluation/","result":{"data":{"markdownRemark":{"html":"<h1 id=\"llm으로-stt-품질-평가하기\">LLM으로 STT 품질 평가하기</h1>\n<p>STT(Speech-to-Text) 분야에서 일하다 보면 WER(Word Error Rate)이 전부가 아니라는 걸 깨닫게 됩니다. WER이 5%인데 읽기 힘든 결과가 있고, WER이 10%인데 의미 전달이 잘 되는 경우도 있습니다. 이 문제를 해결하기 위해 LLM 기반 평가 방법을 도입한 경험을 공유합니다.</p>\n<h2 id=\"wer의-한계\">WER의 한계</h2>\n<p>WER(Word Error Rate)은 STT 평가의 표준 지표입니다. 계산 방법은 단순합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">calculate_wer</span><span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> hypothesis<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    WER = (S + D + I) / N\n\n    S: Substitutions (치환)\n    D: Deletions (삭제)\n    I: Insertions (삽입)\n    N: Reference 단어 수\n    \"\"\"</span>\n    <span class=\"token keyword\">import</span> jiwer\n\n    wer <span class=\"token operator\">=</span> jiwer<span class=\"token punctuation\">.</span>wer<span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">,</span> hypothesis<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> wer\n\n<span class=\"token comment\"># 예시</span>\nreference <span class=\"token operator\">=</span> <span class=\"token string\">\"오늘 날씨가 좋습니다\"</span>\nhypothesis <span class=\"token operator\">=</span> <span class=\"token string\">\"오늘 날씨가 좋습니다\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>calculate_wer<span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">,</span> hypothesis<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 0.0</span>\n\nhypothesis_with_error <span class=\"token operator\">=</span> <span class=\"token string\">\"오늘 날씨가 좋네요\"</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>calculate_wer<span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">,</span> hypothesis_with_error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 0.25 (1/4)</span></code></pre></div>\n<p>하지만 WER에는 근본적인 한계가 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># WER의 문제점을 보여주는 예시들</span>\nWER_LIMITATIONS <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"case_1\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"reference\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"오늘 날씨가 좋습니다\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"hypothesis_a\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"오늘 날씨가 좋네요\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"hypothesis_b\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"오늘 완전 흐립니다\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"wer_a\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.25</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># \"좋습니다\" → \"좋네요\"</span>\n        <span class=\"token string\">\"wer_b\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.50</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># \"날씨가 좋습니다\" → \"완전 흐립니다\"</span>\n        <span class=\"token string\">\"reality\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"A가 의미적으로 훨씬 가까움, 하지만 WER 차이는 크지 않음\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"case_2\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"reference\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"삼성전자 주가가 상승했습니다\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"hypothesis_a\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"삼성전자 주가가 상승했습니다 어\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"hypothesis_b\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"삼성전자 주가가 하락했습니다\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"wer_a\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.20</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># \"어\" 삽입</span>\n        <span class=\"token string\">\"wer_b\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.20</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># \"상승\" → \"하락\"</span>\n        <span class=\"token string\">\"reality\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"A는 의미 동일, B는 완전 반대. 하지만 WER은 같음\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"case_3\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"reference\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"환자의 혈압이 정상입니다\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"hypothesis_a\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"환자의 혈압이 정상입니다\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"hypothesis_b\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"환자의 혈압이 비정상입니다\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"wer_a\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.00</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"wer_b\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.20</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 단 1단어 차이</span>\n        <span class=\"token string\">\"reality\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"의료 맥락에서 B는 치명적 오류. WER로는 심각성 반영 불가\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>실제로 중요한 건 \"읽었을 때 자연스러운가\", \"의미가 제대로 전달되는가\"입니다.</p>\n<h2 id=\"새로운-평가-지표의-필요성\">새로운 평가 지표의 필요성</h2>\n<p>저희 팀에서는 STT 결과물의 품질을 다각도로 평가해야 했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 기존 평가 체계의 문제</span>\nEVALUATION_PROBLEMS <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"wer_only\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"issue\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"의미적 정확성 미반영\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"example\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"핵심 단어 오류 vs 불필요한 삽입 동일 취급\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"human_evaluation\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"issue\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"비용과 시간\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"cost\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1문장당 약 100원 (3명 평가 기준)\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"time\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1000문장 평가에 2-3일 소요\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"scalability\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"대규모 평가 불가능\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"existing_metrics\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"BLEU\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"번역용 지표, STT에 부적합\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"ROUGE\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"요약용 지표, STT에 부적합\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"MOS\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"음성 품질용, 텍스트 정확성과 무관\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># 새로운 평가 지표 요구사항</span>\nNEW_METRIC_REQUIREMENTS <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"semantic_accuracy\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"의미가 제대로 전달되는가\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"readability\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"읽기 편한가, 자연스러운가\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"critical_errors\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"치명적 오류(숫자, 고유명사)는 없는가\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"consistency\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"문맥 흐름이 일관적인가\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"scalability\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"대량 평가가 가능한가\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"cost_effective\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"인간 평가 대비 비용 효율적인가\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"llm-기반-평가-시스템-설계\">LLM 기반 평가 시스템 설계</h2>\n<p>발상은 단순했습니다. GPT에게 \"이 STT 결과가 얼마나 좋은지\" 물어보면 어떨까요?</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> openai\n<span class=\"token keyword\">from</span> dataclasses <span class=\"token keyword\">import</span> dataclass\n<span class=\"token keyword\">from</span> typing <span class=\"token keyword\">import</span> Optional\n<span class=\"token keyword\">import</span> json\n\n<span class=\"token decorator annotation punctuation\">@dataclass</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">STTEvaluationResult</span><span class=\"token punctuation\">:</span>\n    overall_score<span class=\"token punctuation\">:</span> <span class=\"token builtin\">float</span>  <span class=\"token comment\"># 0-100</span>\n    semantic_accuracy<span class=\"token punctuation\">:</span> <span class=\"token builtin\">float</span>\n    readability<span class=\"token punctuation\">:</span> <span class=\"token builtin\">float</span>\n    critical_errors<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span>\n    suggestions<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span>\n    raw_response<span class=\"token punctuation\">:</span> <span class=\"token builtin\">dict</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">LLMSTTEvaluator</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    LLM 기반 STT 품질 평가기\n\n    평가 항목:\n    1. 의미적 정확성 (Semantic Accuracy)\n    2. 가독성 (Readability)\n    3. 치명적 오류 (Critical Errors)\n    4. 문맥 일관성 (Contextual Consistency)\n    \"\"\"</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"gpt-4\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>client <span class=\"token operator\">=</span> openai<span class=\"token punctuation\">.</span>OpenAI<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>model <span class=\"token operator\">=</span> model\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span>\n        self<span class=\"token punctuation\">,</span>\n        reference<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span>\n        hypothesis<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span>\n        context<span class=\"token punctuation\">:</span> Optional<span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span>\n        domain<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"general\"</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> STTEvaluationResult<span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        STT 결과를 평가합니다.\n\n        Args:\n            reference: 정답 텍스트\n            hypothesis: STT 출력 텍스트\n            context: 추가 맥락 (이전 문장들)\n            domain: 도메인 (general, medical, legal 등)\n        \"\"\"</span>\n        prompt <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>_build_prompt<span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">,</span> hypothesis<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">,</span> domain<span class=\"token punctuation\">)</span>\n\n        response <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">.</span>chat<span class=\"token punctuation\">.</span>completions<span class=\"token punctuation\">.</span>create<span class=\"token punctuation\">(</span>\n            model<span class=\"token operator\">=</span>self<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">,</span>\n            messages<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>\n                <span class=\"token punctuation\">{</span><span class=\"token string\">\"role\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"system\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"content\"</span><span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>_get_system_prompt<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">{</span><span class=\"token string\">\"role\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"content\"</span><span class=\"token punctuation\">:</span> prompt<span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            response_format<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"json_object\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            temperature<span class=\"token operator\">=</span><span class=\"token number\">0.1</span>  <span class=\"token comment\"># 일관된 평가를 위해 낮은 temperature</span>\n        <span class=\"token punctuation\">)</span>\n\n        result <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>choices<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>_parse_result<span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_get_system_prompt</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token triple-quoted-string string\">\"\"\"\n        당신은 STT(Speech-to-Text) 품질 평가 전문가입니다.\n        주어진 정답 텍스트와 STT 출력을 비교하여 품질을 평가합니다.\n\n        평가 기준:\n        1. 의미적 정확성 (0-100): 원래 의미가 얼마나 잘 전달되는가\n        2. 가독성 (0-100): 읽기 편하고 자연스러운가\n        3. 치명적 오류: 숫자, 고유명사, 부정어 등의 중대한 오류\n\n        JSON 형식으로 응답해주세요:\n        {\n            \"overall_score\": &lt;0-100>,\n            \"semantic_accuracy\": &lt;0-100>,\n            \"readability\": &lt;0-100>,\n            \"critical_errors\": [&lt;오류 목록>],\n            \"reasoning\": \"&lt;평가 근거>\",\n            \"suggestions\": \"&lt;개선 제안>\"\n        }\n        \"\"\"</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_build_prompt</span><span class=\"token punctuation\">(</span>\n        self<span class=\"token punctuation\">,</span>\n        reference<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span>\n        hypothesis<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span>\n        context<span class=\"token punctuation\">:</span> Optional<span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        domain<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">:</span>\n        prompt <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"\"\"\n        도메인: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>domain<span class=\"token punctuation\">}</span></span><span class=\"token string\">\n\n        정답 텍스트:\n        </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>reference<span class=\"token punctuation\">}</span></span><span class=\"token string\">\n\n        STT 출력:\n        </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>hypothesis<span class=\"token punctuation\">}</span></span><span class=\"token string\">\n        \"\"\"</span></span>\n\n        <span class=\"token keyword\">if</span> context<span class=\"token punctuation\">:</span>\n            prompt <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"이전 맥락:\\n</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>context<span class=\"token punctuation\">}</span></span><span class=\"token string\">\\n\\n\"</span></span> <span class=\"token operator\">+</span> prompt\n\n        prompt <span class=\"token operator\">+=</span> <span class=\"token string\">\"\\n\\n위 STT 결과를 평가해주세요.\"</span>\n        <span class=\"token keyword\">return</span> prompt\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_parse_result</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">:</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> STTEvaluationResult<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> STTEvaluationResult<span class=\"token punctuation\">(</span>\n            overall_score<span class=\"token operator\">=</span>result<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"overall_score\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            semantic_accuracy<span class=\"token operator\">=</span>result<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"semantic_accuracy\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            readability<span class=\"token operator\">=</span>result<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"readability\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            critical_errors<span class=\"token operator\">=</span>result<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"critical_errors\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            suggestions<span class=\"token operator\">=</span>result<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"suggestions\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            raw_response<span class=\"token operator\">=</span>result\n        <span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># 사용 예시</span>\nevaluator <span class=\"token operator\">=</span> LLMSTTEvaluator<span class=\"token punctuation\">(</span>model<span class=\"token operator\">=</span><span class=\"token string\">\"gpt-4\"</span><span class=\"token punctuation\">)</span>\n\nresult <span class=\"token operator\">=</span> evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>\n    reference<span class=\"token operator\">=</span><span class=\"token string\">\"삼성전자 주가가 3.5% 상승했습니다\"</span><span class=\"token punctuation\">,</span>\n    hypothesis<span class=\"token operator\">=</span><span class=\"token string\">\"삼성전자 주가가 3.5% 하락했습니다\"</span><span class=\"token punctuation\">,</span>\n    domain<span class=\"token operator\">=</span><span class=\"token string\">\"finance\"</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Overall Score: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>result<span class=\"token punctuation\">.</span>overall_score<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Critical Errors: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>result<span class=\"token punctuation\">.</span>critical_errors<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Expected: critical_errors = [\"'상승' → '하락': 의미가 완전히 반대됨\"]</span></code></pre></div>\n<h2 id=\"대규모-검증-1억-문장-테스트\">대규모 검증: 1억 문장 테스트</h2>\n<p>작은 샘플로는 확신이 서지 않아서, 대규모 테스트를 진행했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> asyncio\n<span class=\"token keyword\">from</span> concurrent<span class=\"token punctuation\">.</span>futures <span class=\"token keyword\">import</span> ThreadPoolExecutor\n<span class=\"token keyword\">from</span> dataclasses <span class=\"token keyword\">import</span> dataclass\n<span class=\"token keyword\">from</span> typing <span class=\"token keyword\">import</span> Iterator\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\n<span class=\"token decorator annotation punctuation\">@dataclass</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ValidationDataset</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"검증용 데이터셋\"\"\"</span>\n    samples<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># reference, hypothesis, human_score</span>\n    domains<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">]</span>\n    total_size<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">LargeScaleValidator</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    대규모 LLM 평가 검증 시스템\n\n    목표:\n    1. LLM 평가와 인간 평가의 상관관계 측정\n    2. 도메인별 성능 분석\n    3. 비용/시간 효율성 검증\n    \"\"\"</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> evaluator<span class=\"token punctuation\">:</span> LLMSTTEvaluator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>evaluator <span class=\"token operator\">=</span> evaluator\n        self<span class=\"token punctuation\">.</span>executor <span class=\"token operator\">=</span> ThreadPoolExecutor<span class=\"token punctuation\">(</span>max_workers<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">validate_batch</span><span class=\"token punctuation\">(</span>\n        self<span class=\"token punctuation\">,</span>\n        dataset<span class=\"token punctuation\">:</span> ValidationDataset<span class=\"token punctuation\">,</span>\n        batch_size<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span> <span class=\"token operator\">=</span> <span class=\"token number\">100</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        대규모 배치 검증 실행\n        \"\"\"</span>\n        results <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>dataset<span class=\"token punctuation\">.</span>samples<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> batch_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            batch <span class=\"token operator\">=</span> dataset<span class=\"token punctuation\">.</span>samples<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span>i<span class=\"token operator\">+</span>batch_size<span class=\"token punctuation\">]</span>\n\n            <span class=\"token comment\"># 비동기 병렬 처리</span>\n            tasks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n                self<span class=\"token punctuation\">.</span>_evaluate_single<span class=\"token punctuation\">(</span>sample<span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">for</span> sample <span class=\"token keyword\">in</span> batch\n            <span class=\"token punctuation\">]</span>\n            batch_results <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> asyncio<span class=\"token punctuation\">.</span>gather<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>tasks<span class=\"token punctuation\">)</span>\n            results<span class=\"token punctuation\">.</span>extend<span class=\"token punctuation\">(</span>batch_results<span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\"># 진행 상황 로깅</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Processed </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>batch_size<span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>dataset<span class=\"token punctuation\">.</span>samples<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>dataset<span class=\"token punctuation\">.</span>samples<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>_compute_validation_metrics<span class=\"token punctuation\">(</span>results<span class=\"token punctuation\">,</span> dataset<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">async</span> <span class=\"token keyword\">def</span> <span class=\"token function\">_evaluate_single</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> sample<span class=\"token punctuation\">:</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"단일 샘플 평가\"\"\"</span>\n        llm_result <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>\n            reference<span class=\"token operator\">=</span>sample<span class=\"token punctuation\">[</span><span class=\"token string\">\"reference\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            hypothesis<span class=\"token operator\">=</span>sample<span class=\"token punctuation\">[</span><span class=\"token string\">\"hypothesis\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            domain<span class=\"token operator\">=</span>sample<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"domain\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"general\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"llm_score\"</span><span class=\"token punctuation\">:</span> llm_result<span class=\"token punctuation\">.</span>overall_score<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"human_score\"</span><span class=\"token punctuation\">:</span> sample<span class=\"token punctuation\">[</span><span class=\"token string\">\"human_score\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"domain\"</span><span class=\"token punctuation\">:</span> sample<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"domain\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"general\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"wer\"</span><span class=\"token punctuation\">:</span> sample<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"wer\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_compute_validation_metrics</span><span class=\"token punctuation\">(</span>\n        self<span class=\"token punctuation\">,</span>\n        results<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        dataset<span class=\"token punctuation\">:</span> ValidationDataset\n    <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        검증 지표 계산\n        \"\"\"</span>\n        <span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n        <span class=\"token keyword\">from</span> scipy <span class=\"token keyword\">import</span> stats\n\n        df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>results<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 전체 상관관계</span>\n        overall_corr<span class=\"token punctuation\">,</span> overall_p <span class=\"token operator\">=</span> stats<span class=\"token punctuation\">.</span>pearsonr<span class=\"token punctuation\">(</span>\n            df<span class=\"token punctuation\">[</span><span class=\"token string\">\"llm_score\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            df<span class=\"token punctuation\">[</span><span class=\"token string\">\"human_score\"</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 도메인별 상관관계</span>\n        domain_corrs <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">for</span> domain <span class=\"token keyword\">in</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">\"domain\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>unique<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            domain_df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">\"domain\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> domain<span class=\"token punctuation\">]</span>\n            <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>domain_df<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">30</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 충분한 샘플</span>\n                corr<span class=\"token punctuation\">,</span> p <span class=\"token operator\">=</span> stats<span class=\"token punctuation\">.</span>pearsonr<span class=\"token punctuation\">(</span>\n                    domain_df<span class=\"token punctuation\">[</span><span class=\"token string\">\"llm_score\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                    domain_df<span class=\"token punctuation\">[</span><span class=\"token string\">\"human_score\"</span><span class=\"token punctuation\">]</span>\n                <span class=\"token punctuation\">)</span>\n                domain_corrs<span class=\"token punctuation\">[</span>domain<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"correlation\"</span><span class=\"token punctuation\">:</span> corr<span class=\"token punctuation\">,</span> <span class=\"token string\">\"p_value\"</span><span class=\"token punctuation\">:</span> p<span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\"># WER과의 비교</span>\n        wer_corr <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n        <span class=\"token keyword\">if</span> <span class=\"token string\">\"wer\"</span> <span class=\"token keyword\">in</span> df<span class=\"token punctuation\">.</span>columns <span class=\"token keyword\">and</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">\"wer\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>notna<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">any</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            wer_df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">\"wer\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>notna<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n            <span class=\"token comment\"># WER은 낮을수록 좋으므로 음의 상관관계가 예상됨</span>\n            wer_corr<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> stats<span class=\"token punctuation\">.</span>pearsonr<span class=\"token punctuation\">(</span>\n                <span class=\"token operator\">-</span>wer_df<span class=\"token punctuation\">[</span><span class=\"token string\">\"wer\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 부호 반전</span>\n                wer_df<span class=\"token punctuation\">[</span><span class=\"token string\">\"human_score\"</span><span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"overall_correlation\"</span><span class=\"token punctuation\">:</span> overall_corr<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"overall_p_value\"</span><span class=\"token punctuation\">:</span> overall_p<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"domain_correlations\"</span><span class=\"token punctuation\">:</span> domain_corrs<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"wer_correlation\"</span><span class=\"token punctuation\">:</span> wer_corr<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"sample_size\"</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>results<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\"># 검증 결과</span>\nVALIDATION_RESULTS <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"dataset\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"total_samples\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100_000_000</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 1억 문장</span>\n        <span class=\"token string\">\"human_labeled\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10_000</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 1만 문장 인간 레이블링</span>\n        <span class=\"token string\">\"annotators\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 3명 합의</span>\n        <span class=\"token string\">\"domains\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"general\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"medical\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"legal\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"finance\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tech\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"correlations\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"llm_vs_human\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.85</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 85% 상관관계</span>\n        <span class=\"token string\">\"wer_vs_human\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.72</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># WER은 72%</span>\n        <span class=\"token string\">\"improvement\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"18% 더 높은 상관관계\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"domain_breakdown\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"general\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"correlation\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.87</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"note\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"일반 대화에서 가장 좋음\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"medical\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"correlation\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.82</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"note\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"전문 용어가 많아 약간 낮음\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"legal\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"correlation\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.79</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"note\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"법률 용어 처리 개선 필요\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"finance\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"correlation\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.84</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"note\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"숫자 정확성 중요\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"tech\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"correlation\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.86</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"note\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"기술 용어 처리 양호\"</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"비용-최적화\">비용 최적화</h2>\n<p>GPT-4로 1억 문장을 평가하면 비용이 어마어마합니다. 경량 모델로 증류하는 방법을 시도했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> torch\n<span class=\"token keyword\">from</span> transformers <span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span>\n    AutoModelForSequenceClassification<span class=\"token punctuation\">,</span>\n    AutoTokenizer<span class=\"token punctuation\">,</span>\n    Trainer<span class=\"token punctuation\">,</span>\n    TrainingArguments\n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">from</span> datasets <span class=\"token keyword\">import</span> Dataset\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">DistilledSTTEvaluator</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    LLM 평가를 증류한 경량 모델\n\n    전략:\n    1. GPT-4로 대량 평가 데이터 생성\n    2. BERT 크기 모델로 증류\n    3. 추론 비용 1000배 절감\n    \"\"\"</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> model_path<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> model_path<span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>model <span class=\"token operator\">=</span> AutoModelForSequenceClassification<span class=\"token punctuation\">.</span>from_pretrained<span class=\"token punctuation\">(</span>\n                model_path<span class=\"token punctuation\">,</span>\n                num_labels<span class=\"token operator\">=</span><span class=\"token number\">1</span>  <span class=\"token comment\"># 회귀 태스크</span>\n            <span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>tokenizer <span class=\"token operator\">=</span> AutoTokenizer<span class=\"token punctuation\">.</span>from_pretrained<span class=\"token punctuation\">(</span>model_path<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># 기본 BERT 모델로 초기화</span>\n            self<span class=\"token punctuation\">.</span>model <span class=\"token operator\">=</span> AutoModelForSequenceClassification<span class=\"token punctuation\">.</span>from_pretrained<span class=\"token punctuation\">(</span>\n                <span class=\"token string\">\"klue/bert-base\"</span><span class=\"token punctuation\">,</span>\n                num_labels<span class=\"token operator\">=</span><span class=\"token number\">1</span>\n            <span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>tokenizer <span class=\"token operator\">=</span> AutoTokenizer<span class=\"token punctuation\">.</span>from_pretrained<span class=\"token punctuation\">(</span><span class=\"token string\">\"klue/bert-base\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">prepare_distillation_data</span><span class=\"token punctuation\">(</span>\n        self<span class=\"token punctuation\">,</span>\n        samples<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        llm_evaluator<span class=\"token punctuation\">:</span> LLMSTTEvaluator\n    <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> Dataset<span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        증류용 학습 데이터 준비\n\n        Args:\n            samples: reference, hypothesis 쌍\n            llm_evaluator: 교사 모델 (GPT-4)\n        \"\"\"</span>\n        processed <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n        <span class=\"token keyword\">for</span> sample <span class=\"token keyword\">in</span> samples<span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># GPT-4로 평가</span>\n            result <span class=\"token operator\">=</span> llm_evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>\n                reference<span class=\"token operator\">=</span>sample<span class=\"token punctuation\">[</span><span class=\"token string\">\"reference\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                hypothesis<span class=\"token operator\">=</span>sample<span class=\"token punctuation\">[</span><span class=\"token string\">\"hypothesis\"</span><span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\"># 입력 형식: [CLS] reference [SEP] hypothesis [SEP]</span>\n            text <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>sample<span class=\"token punctuation\">[</span><span class=\"token string\">'reference'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span><span class=\"token string\"> [SEP] </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>sample<span class=\"token punctuation\">[</span><span class=\"token string\">'hypothesis'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span>\n\n            processed<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">:</span> text<span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"label\"</span><span class=\"token punctuation\">:</span> result<span class=\"token punctuation\">.</span>overall_score <span class=\"token operator\">/</span> <span class=\"token number\">100.0</span>  <span class=\"token comment\"># 0-1 정규화</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> Dataset<span class=\"token punctuation\">.</span>from_list<span class=\"token punctuation\">(</span>processed<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">train</span><span class=\"token punctuation\">(</span>\n        self<span class=\"token punctuation\">,</span>\n        train_dataset<span class=\"token punctuation\">:</span> Dataset<span class=\"token punctuation\">,</span>\n        eval_dataset<span class=\"token punctuation\">:</span> Dataset<span class=\"token punctuation\">,</span>\n        output_dir<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        증류 학습 실행\n        \"\"\"</span>\n        <span class=\"token keyword\">def</span> <span class=\"token function\">tokenize_function</span><span class=\"token punctuation\">(</span>examples<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>tokenizer<span class=\"token punctuation\">(</span>\n                examples<span class=\"token punctuation\">[</span><span class=\"token string\">\"text\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                padding<span class=\"token operator\">=</span><span class=\"token string\">\"max_length\"</span><span class=\"token punctuation\">,</span>\n                truncation<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n                max_length<span class=\"token operator\">=</span><span class=\"token number\">256</span>\n            <span class=\"token punctuation\">)</span>\n\n        train_tokenized <span class=\"token operator\">=</span> train_dataset<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>tokenize_function<span class=\"token punctuation\">,</span> batched<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n        eval_tokenized <span class=\"token operator\">=</span> eval_dataset<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>tokenize_function<span class=\"token punctuation\">,</span> batched<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\n        training_args <span class=\"token operator\">=</span> TrainingArguments<span class=\"token punctuation\">(</span>\n            output_dir<span class=\"token operator\">=</span>output_dir<span class=\"token punctuation\">,</span>\n            num_train_epochs<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n            per_device_train_batch_size<span class=\"token operator\">=</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n            per_device_eval_batch_size<span class=\"token operator\">=</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span>\n            learning_rate<span class=\"token operator\">=</span><span class=\"token number\">2e-5</span><span class=\"token punctuation\">,</span>\n            weight_decay<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span>\n            evaluation_strategy<span class=\"token operator\">=</span><span class=\"token string\">\"epoch\"</span><span class=\"token punctuation\">,</span>\n            save_strategy<span class=\"token operator\">=</span><span class=\"token string\">\"epoch\"</span><span class=\"token punctuation\">,</span>\n            load_best_model_at_end<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n            metric_for_best_model<span class=\"token operator\">=</span><span class=\"token string\">\"eval_loss\"</span><span class=\"token punctuation\">,</span>\n            fp16<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">)</span>\n\n        trainer <span class=\"token operator\">=</span> Trainer<span class=\"token punctuation\">(</span>\n            model<span class=\"token operator\">=</span>self<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">,</span>\n            args<span class=\"token operator\">=</span>training_args<span class=\"token punctuation\">,</span>\n            train_dataset<span class=\"token operator\">=</span>train_tokenized<span class=\"token punctuation\">,</span>\n            eval_dataset<span class=\"token operator\">=</span>eval_tokenized<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">)</span>\n\n        trainer<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        trainer<span class=\"token punctuation\">.</span>save_model<span class=\"token punctuation\">(</span>output_dir<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> reference<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> hypothesis<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        증류된 모델로 빠른 평가\n        \"\"\"</span>\n        text <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>reference<span class=\"token punctuation\">}</span></span><span class=\"token string\"> [SEP] </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>hypothesis<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span>\n        inputs <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>tokenizer<span class=\"token punctuation\">(</span>\n            text<span class=\"token punctuation\">,</span>\n            return_tensors<span class=\"token operator\">=</span><span class=\"token string\">\"pt\"</span><span class=\"token punctuation\">,</span>\n            padding<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n            truncation<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n            max_length<span class=\"token operator\">=</span><span class=\"token number\">256</span>\n        <span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">with</span> torch<span class=\"token punctuation\">.</span>no_grad<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            outputs <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">(</span><span class=\"token operator\">**</span>inputs<span class=\"token punctuation\">)</span>\n            score <span class=\"token operator\">=</span> outputs<span class=\"token punctuation\">.</span>logits<span class=\"token punctuation\">.</span>squeeze<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> score <span class=\"token operator\">*</span> <span class=\"token number\">100</span>  <span class=\"token comment\"># 0-100 스케일로 변환</span>\n\n\n<span class=\"token comment\"># 비용 비교</span>\nCOST_COMPARISON <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"gpt4_evaluation\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"cost_per_sample\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.03</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 약 30원</span>\n        <span class=\"token string\">\"time_per_sample\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2s\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"cost_1m_samples\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"$30,000\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"throughput\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"30 samples/min\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"distilled_model\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"cost_per_sample\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.00003</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 약 0.03원 (GPU 비용)</span>\n        <span class=\"token string\">\"time_per_sample\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"0.01s\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"cost_1m_samples\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"$30\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"throughput\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"6000 samples/min\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"correlation_with_gpt4\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.92</span>  <span class=\"token comment\"># 92% 상관관계 유지</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"savings\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1000x 비용 절감\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"실제-적용-사례\">실제 적용 사례</h2>\n<h3 id=\"강의-자막-서비스\">강의 자막 서비스</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 강의 자막 품질 최적화</span>\nLECTURE_SUBTITLE_CASE <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"service\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"온라인 강의 플랫폼 자막\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"challenge\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"학습자 이해도가 STT 품질에 직결\"</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token string\">\"before\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"evaluation_method\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"WER only\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"model_selection\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"WER 최저 모델\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"wer\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"4.2%\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"user_satisfaction\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.2/5.0\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token string\">\"after\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"evaluation_method\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"LLM + WER 복합 평가\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"model_selection\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"가독성 + 의미 정확성 최적화\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"wer\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"4.5%\"</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># WER은 약간 높아짐</span>\n        <span class=\"token string\">\"llm_readability\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"92/100\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"user_satisfaction\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"4.2/5.0\"</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 31% 향상</span>\n        <span class=\"token string\">\"learning_comprehension\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"+32%\"</span>  <span class=\"token comment\"># A/B 테스트 결과</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># 평가 파이프라인</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">LectureSubtitleEvaluator</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    강의 자막 전용 평가기\n\n    특화 항목:\n    - 전문 용어 정확성\n    - 문장 완결성\n    - 시각적 가독성 (자막 길이)\n    \"\"\"</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>llm_evaluator <span class=\"token operator\">=</span> LLMSTTEvaluator<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>distilled_evaluator <span class=\"token operator\">=</span> DistilledSTTEvaluator<span class=\"token punctuation\">(</span><span class=\"token string\">\"./lecture_evaluator\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">evaluate_lecture</span><span class=\"token punctuation\">(</span>\n        self<span class=\"token punctuation\">,</span>\n        reference<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span>\n        hypothesis<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span>\n        subject<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        강의 자막 평가\n\n        Args:\n            subject: 과목 (math, science, history 등)\n        \"\"\"</span>\n        <span class=\"token comment\"># 기본 평가</span>\n        base_result <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>distilled_evaluator<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">,</span> hypothesis<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 강의 특화 추가 평가</span>\n        additional_checks <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"sentence_completeness\"</span><span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>_check_completeness<span class=\"token punctuation\">(</span>hypothesis<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"subtitle_length\"</span><span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>_check_length<span class=\"token punctuation\">(</span>hypothesis<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"technical_terms\"</span><span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>_check_terms<span class=\"token punctuation\">(</span>hypothesis<span class=\"token punctuation\">,</span> subject<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"overall_score\"</span><span class=\"token punctuation\">:</span> base_result<span class=\"token punctuation\">,</span>\n            <span class=\"token operator\">**</span>additional_checks\n        <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_check_completeness</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"문장 완결성 체크\"\"\"</span>\n        <span class=\"token comment\"># 문장이 중간에 끊기지 않았는지</span>\n        <span class=\"token keyword\">if</span> text<span class=\"token punctuation\">.</span>endswith<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"...\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"그리고\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"하지만\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"그래서\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token number\">0.5</span>\n        <span class=\"token keyword\">return</span> <span class=\"token number\">1.0</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_check_length</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"자막 길이 적정성 (화면에 표시 가능한지)\"\"\"</span>\n        MAX_CHARS_PER_LINE <span class=\"token operator\">=</span> <span class=\"token number\">42</span>  <span class=\"token comment\"># 일반적인 자막 길이</span>\n        <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> MAX_CHARS_PER_LINE <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token number\">0.7</span>  <span class=\"token comment\"># 너무 긴 경우</span>\n        <span class=\"token keyword\">return</span> <span class=\"token number\">1.0</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_check_terms</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> subject<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"전문 용어 처리 체크\"\"\"</span>\n        <span class=\"token comment\"># 과목별 전문 용어 사전과 대조</span>\n        <span class=\"token comment\"># 구현 생략</span>\n        <span class=\"token keyword\">return</span> <span class=\"token number\">1.0</span></code></pre></div>\n<h3 id=\"의료-기록-서비스\">의료 기록 서비스</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 의료 STT 품질 평가</span>\nMEDICAL_STT_CASE <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"service\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"진료 기록 음성 인식\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"criticality\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"매우 높음 - 오진단 위험\"</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token string\">\"key_findings\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"wer_limitation\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"WER 2%여도 치명적 오류 가능\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"example\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"reference\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"환자의 혈당이 정상입니다\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"hypothesis\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"환자의 혈당이 비정상입니다\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"wer\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"20%\"</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 단 1단어 차이</span>\n            <span class=\"token string\">\"severity\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"치명적 - 진단 오류로 이어질 수 있음\"</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token string\">\"solution\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"approach\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Critical Error Detection 추가\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"implementation\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"의료 용어 + 부정어 특별 처리\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MedicalSTTEvaluator</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    의료 STT 전용 평가기\n\n    특별 처리:\n    - 의료 용어 정확성\n    - 부정어 (정상/비정상, 있음/없음) 감지\n    - 수치 정확성 (혈압, 혈당 등)\n    \"\"\"</span>\n\n    <span class=\"token comment\"># 치명적 오류 패턴</span>\n    CRITICAL_PATTERNS <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"negation_flip\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">(</span><span class=\"token string\">\"정상\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"비정상\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">(</span><span class=\"token string\">\"있음\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"없음\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">(</span><span class=\"token string\">\"양성\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"음성\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">(</span><span class=\"token string\">\"필요\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"불필요\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"numeric_errors\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">r\"\\d+(\\.\\d+)?\"</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 숫자 오류</span>\n        <span class=\"token string\">\"medication_names\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 약물명 목록</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> reference<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> hypothesis<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        의료 STT 결과 평가\n\n        Returns:\n            is_safe: 안전하게 사용 가능한지\n            critical_errors: 치명적 오류 목록\n            requires_review: 의사 검토 필요 여부\n        \"\"\"</span>\n        critical_errors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n        <span class=\"token comment\"># 부정어 뒤집힘 체크</span>\n        <span class=\"token keyword\">for</span> pos<span class=\"token punctuation\">,</span> neg <span class=\"token keyword\">in</span> self<span class=\"token punctuation\">.</span>CRITICAL_PATTERNS<span class=\"token punctuation\">[</span><span class=\"token string\">\"negation_flip\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> pos <span class=\"token keyword\">in</span> reference <span class=\"token keyword\">and</span> neg <span class=\"token keyword\">in</span> hypothesis<span class=\"token punctuation\">:</span>\n                critical_errors<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"negation_flip\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"reference_has\"</span><span class=\"token punctuation\">:</span> pos<span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"hypothesis_has\"</span><span class=\"token punctuation\">:</span> neg<span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"severity\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"critical\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">elif</span> neg <span class=\"token keyword\">in</span> reference <span class=\"token keyword\">and</span> pos <span class=\"token keyword\">in</span> hypothesis<span class=\"token punctuation\">:</span>\n                critical_errors<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n                    <span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"negation_flip\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"reference_has\"</span><span class=\"token punctuation\">:</span> neg<span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"hypothesis_has\"</span><span class=\"token punctuation\">:</span> pos<span class=\"token punctuation\">,</span>\n                    <span class=\"token string\">\"severity\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"critical\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 수치 오류 체크</span>\n        ref_numbers <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>_extract_numbers<span class=\"token punctuation\">(</span>reference<span class=\"token punctuation\">)</span>\n        hyp_numbers <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>_extract_numbers<span class=\"token punctuation\">(</span>hypothesis<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> ref_numbers <span class=\"token operator\">!=</span> hyp_numbers<span class=\"token punctuation\">:</span>\n            critical_errors<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"numeric_error\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"reference\"</span><span class=\"token punctuation\">:</span> ref_numbers<span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"hypothesis\"</span><span class=\"token punctuation\">:</span> hyp_numbers<span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"severity\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"critical\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"is_safe\"</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>critical_errors<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"critical_errors\"</span><span class=\"token punctuation\">:</span> critical_errors<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"requires_review\"</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>critical_errors<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"recommendation\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"의사 검토 필요\"</span> <span class=\"token keyword\">if</span> critical_errors <span class=\"token keyword\">else</span> <span class=\"token string\">\"자동 승인 가능\"</span>\n        <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_extract_numbers</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"텍스트에서 숫자 추출\"\"\"</span>\n        <span class=\"token keyword\">import</span> re\n        <span class=\"token keyword\">return</span> re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span><span class=\"token string\">r\"\\d+(?:\\.\\d+)?\"</span><span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># 의료 STT 적용 결과</span>\nMEDICAL_RESULTS <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"before\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"auto_approval_rate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"95%\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"critical_error_missed\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"0.3%\"</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 1000건 중 3건 놓침</span>\n        <span class=\"token string\">\"incident_rate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"연간 12건\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"after\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"auto_approval_rate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"82%\"</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 더 보수적</span>\n        <span class=\"token string\">\"critical_error_missed\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"0.01%\"</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 30배 감소</span>\n        <span class=\"token string\">\"incident_rate\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"연간 0건\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"한계와-향후-계획\">한계와 향후 계획</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">LIMITATIONS <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"cost\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"issue\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"GPT-4 API 비용이 여전히 부담\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"mitigation\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"증류 모델 사용, 샘플링 평가\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"future\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"더 효율적인 LLM (GPT-4o, Claude 3 Haiku)\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"latency\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"issue\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"실시간 평가 어려움\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"current\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"배치 평가만 가능\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"future\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"증류 모델로 실시간 모니터링\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"bias\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"issue\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"LLM 자체의 편향\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"example\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"특정 표현 스타일 선호\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"mitigation\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"다중 모델 앙상블\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"domain_specific\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"issue\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"전문 도메인에서 성능 저하\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"cause\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"LLM의 전문 지식 한계\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"future\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"도메인 특화 파인튜닝\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nFUTURE_WORK <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"multi_model_ensemble\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"description\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"GPT-4, Claude, Gemini 앙상블\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"benefit\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"편향 감소, 더 안정적인 평가\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"realtime_monitoring\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"description\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"증류 모델로 실시간 품질 모니터링\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"application\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"서비스 대시보드, 알람 시스템\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"fine_grained_evaluation\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"description\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"문장 단위 → 구문 단위 세분화\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"benefit\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"정확한 오류 위치 파악\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"결론\">결론</h2>\n<p>WER만으로는 STT 품질을 온전히 평가할 수 없습니다. LLM 기반 평가는 의미적 정확성과 가독성을 반영하여, 실제 사용자 경험과 더 높은 상관관계를 보여줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">KEY_TAKEAWAYS <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"평가 지표가 잘못되면 최적화 방향도 틀어진다\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"LLM 평가는 인간 평가와 85% 상관관계\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"3\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"증류 모델로 1000배 비용 절감 가능\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"4\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"도메인별 특화 평가가 중요 (의료, 법률 등)\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"5\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"치명적 오류 탐지는 별도 시스템 필요\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"참고-자료\">참고 자료</h2>\n<ul>\n<li><a href=\"https://arxiv.org/abs/2303.16634\">G-Eval: NLG Evaluation using GPT-4</a></li>\n<li><a href=\"https://arxiv.org/abs/1904.09675\">BERTScore: Evaluating Text Generation</a></li>\n<li><a href=\"https://aclanthology.org/\">Human Evaluation of Text Generation</a></li>\n<li><a href=\"https://arxiv.org/abs/2006.05525\">Knowledge Distillation Survey</a></li>\n<li><a href=\"https://github.com/jitsi/jiwer\">jiwer - WER Calculation Library</a></li>\n</ul>","excerpt":"LLM으로 STT 품질 평가하기 STT(Speech-to-Text) 분야에서 일하다 보면 WER(Word Error Rate)이 전부가 아니라는 걸 깨닫게 됩니다. WER이 5%인데 읽기 힘든 결과가 있고, WER이 10%인데 의미 전달이 잘 되는 경우도 있습니다. 이 문제를 해결하기 위해 LLM 기반 평가 방법을 도입한 경험을 공유합니다. WER의 한계…","frontmatter":{"date":"24.11.01","dateISO":"2024-11-01","description":"WER의 한계를 넘어서 - LLM을 활용한 STT 품질 평가 시스템 구축기. 의미 보존, 가독성, 문맥 이해도를 종합적으로 측정하는 새로운 접근법","slug":"/llm-stt-evaluation","heroImage":null,"heroImageAlt":null,"tags":["ai","dev"],"title":"LLM으로 STT 품질 평가하기"},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#llm%EC%9C%BC%EB%A1%9C-stt-%ED%92%88%EC%A7%88-%ED%8F%89%EA%B0%80%ED%95%98%EA%B8%B0\">LLM으로 STT 품질 평가하기</a></p>\n<ul>\n<li>\n<p><a href=\"#wer%EC%9D%98-%ED%95%9C%EA%B3%84\">WER의 한계</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%83%88%EB%A1%9C%EC%9A%B4-%ED%8F%89%EA%B0%80-%EC%A7%80%ED%91%9C%EC%9D%98-%ED%95%84%EC%9A%94%EC%84%B1\">새로운 평가 지표의 필요성</a></p>\n</li>\n<li>\n<p><a href=\"#llm-%EA%B8%B0%EB%B0%98-%ED%8F%89%EA%B0%80-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%84%A4%EA%B3%84\">LLM 기반 평가 시스템 설계</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%8C%80%EA%B7%9C%EB%AA%A8-%EA%B2%80%EC%A6%9D-1%EC%96%B5-%EB%AC%B8%EC%9E%A5-%ED%85%8C%EC%8A%A4%ED%8A%B8\">대규모 검증: 1억 문장 테스트</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%B9%84%EC%9A%A9-%EC%B5%9C%EC%A0%81%ED%99%94\">비용 최적화</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%8B%A4%EC%A0%9C-%EC%A0%81%EC%9A%A9-%EC%82%AC%EB%A1%80\">실제 적용 사례</a></p>\n<ul>\n<li><a href=\"#%EA%B0%95%EC%9D%98-%EC%9E%90%EB%A7%89-%EC%84%9C%EB%B9%84%EC%8A%A4\">강의 자막 서비스</a></li>\n<li><a href=\"#%EC%9D%98%EB%A3%8C-%EA%B8%B0%EB%A1%9D-%EC%84%9C%EB%B9%84%EC%8A%A4\">의료 기록 서비스</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%ED%95%9C%EA%B3%84%EC%99%80-%ED%96%A5%ED%9B%84-%EA%B3%84%ED%9A%8D\">한계와 향후 계획</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B2%B0%EB%A1%A0\">결론</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C\">참고 자료</a></p>\n</li>\n</ul>\n</li>\n</ul>"}},"pageContext":{"id":"0b561278-b1ef-5ef0-8087-568dc842ae41","frontmatter__slug":"/llm-stt-evaluation","previous":"/ai-startup-career-guide","previousTitle":"AI 스타트업 연구 엔지니어로 일한다는 것","next":"/fastconformer-stt-development","nextTitle":"FastConformer로 STT 엔진 만들면서 배운 것들"}},"staticQueryHashes":["12962592","3399079524","3470099541","4097432363","76375841"],"slicesMap":{}}