{"version":3,"file":"7724-56eea426dcbe30fff1a4.js","mappings":"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","sources":["webpack://jiunbae.github.io/./node_modules/.pnpm/@babel+runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://jiunbae.github.io/./node_modules/.pnpm/@babel+runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://jiunbae.github.io/./node_modules/.pnpm/@babel+runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://jiunbae.github.io/./node_modules/.pnpm/@babel+runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://jiunbae.github.io/./src/views/PhysicsSandbox/engine.ts"],"sourcesContent":["function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nexport { _createClass as default };","/**\n * 2D rigid body physics engine with impulse-based collision response.\n *\n * Features:\n *   - Circle and box rigid bodies\n *   - Circle-circle, circle-box, and box-box (SAT) collision detection\n *   - Impulse-based collision response with restitution\n *   - Configurable gravity\n *   - Distance constraints (springs) between bodies\n *   - Boundary walls at canvas edges\n *   - Tools: circle, box, spring, gravity gun, explosion\n */\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\ntype Tool = 'circle' | 'box' | 'spring' | 'gravity' | 'explosion'\n\ninterface Vec2 {\n  x: number\n  y: number\n}\n\nfunction vec2(x: number, y: number): Vec2 {\n  return { x, y }\n}\n\nfunction v2add(a: Vec2, b: Vec2): Vec2 {\n  return { x: a.x + b.x, y: a.y + b.y }\n}\n\nfunction v2sub(a: Vec2, b: Vec2): Vec2 {\n  return { x: a.x - b.x, y: a.y - b.y }\n}\n\nfunction v2scale(a: Vec2, s: number): Vec2 {\n  return { x: a.x * s, y: a.y * s }\n}\n\nfunction v2dot(a: Vec2, b: Vec2): number {\n  return a.x * b.x + a.y * b.y\n}\n\nfunction v2cross(a: Vec2, b: Vec2): number {\n  return a.x * b.y - a.y * b.x\n}\n\nfunction v2len(a: Vec2): number {\n  return Math.sqrt(a.x * a.x + a.y * a.y)\n}\n\nfunction v2lenSq(a: Vec2): number {\n  return a.x * a.x + a.y * a.y\n}\n\nfunction v2norm(a: Vec2): Vec2 {\n  const l = v2len(a)\n  if (l < 1e-10) return { x: 0, y: 0 }\n  return { x: a.x / l, y: a.y / l }\n}\n\nfunction v2perp(a: Vec2): Vec2 {\n  return { x: -a.y, y: a.x }\n}\n\nfunction v2neg(a: Vec2): Vec2 {\n  return { x: -a.x, y: -a.y }\n}\n\nfunction v2rotate(v: Vec2, angle: number): Vec2 {\n  const c = Math.cos(angle)\n  const s = Math.sin(angle)\n  return { x: v.x * c - v.y * s, y: v.x * s + v.y * c }\n}\n\nfunction clamp(val: number, min: number, max: number): number {\n  return val < min ? min : val > max ? max : val\n}\n\n// ---------------------------------------------------------------------------\n// Body\n// ---------------------------------------------------------------------------\n\ntype BodyType = 'circle' | 'box'\n\ninterface Body {\n  type: BodyType\n  pos: Vec2\n  vel: Vec2\n  angle: number\n  angVel: number\n  mass: number\n  invMass: number\n  inertia: number\n  invInertia: number\n  restitution: number\n  // Shape data\n  radius: number     // circle radius, or half-diagonal for boxes (used for broad phase)\n  halfW: number      // box half-width\n  halfH: number      // box half-height\n  // Rendering\n  color: string\n  id: number\n  isStatic: boolean\n}\n\nlet bodyIdCounter = 0\n\nfunction createCircle(x: number, y: number, radius: number, restitution: number): Body {\n  const r = Math.max(radius, 5)\n  const mass = Math.PI * r * r * 0.01\n  const inertia = 0.5 * mass * r * r\n  return {\n    type: 'circle',\n    pos: vec2(x, y),\n    vel: vec2(0, 0),\n    angle: 0,\n    angVel: 0,\n    mass,\n    invMass: 1 / mass,\n    inertia,\n    invInertia: 1 / inertia,\n    restitution,\n    radius: r,\n    halfW: 0,\n    halfH: 0,\n    color: randomPastelColor(),\n    id: bodyIdCounter++,\n    isStatic: false,\n  }\n}\n\nfunction createBox(x: number, y: number, halfW: number, halfH: number, restitution: number): Body {\n  const hw = Math.max(halfW, 5)\n  const hh = Math.max(halfH, 5)\n  const mass = hw * hh * 4 * 0.01\n  const inertia = (mass / 12) * (4 * hw * hw + 4 * hh * hh)\n  return {\n    type: 'box',\n    pos: vec2(x, y),\n    vel: vec2(0, 0),\n    angle: 0,\n    angVel: 0,\n    mass,\n    invMass: 1 / mass,\n    inertia,\n    invInertia: 1 / inertia,\n    restitution,\n    radius: Math.sqrt(hw * hw + hh * hh),\n    halfW: hw,\n    halfH: hh,\n    color: randomPastelColor(),\n    id: bodyIdCounter++,\n    isStatic: false,\n  }\n}\n\nfunction randomPastelColor(): string {\n  const h = Math.random() * 360\n  const s = 50 + Math.random() * 30\n  const l = 55 + Math.random() * 20\n  return `hsl(${h | 0}, ${s | 0}%, ${l | 0}%)`\n}\n\n// ---------------------------------------------------------------------------\n// Spring constraint\n// ---------------------------------------------------------------------------\n\ninterface Spring {\n  bodyA: Body\n  bodyB: Body\n  restLength: number\n  stiffness: number\n  damping: number\n}\n\n// ---------------------------------------------------------------------------\n// Collision manifold\n// ---------------------------------------------------------------------------\n\ninterface Manifold {\n  bodyA: Body\n  bodyB: Body\n  normal: Vec2       // from A to B\n  penetration: number\n  contactPoint: Vec2\n}\n\n// ---------------------------------------------------------------------------\n// Collision detection\n// ---------------------------------------------------------------------------\n\nfunction getBoxCorners(b: Body): Vec2[] {\n  const hw = b.halfW\n  const hh = b.halfH\n  const corners = [\n    vec2(-hw, -hh),\n    vec2(hw, -hh),\n    vec2(hw, hh),\n    vec2(-hw, hh),\n  ]\n  return corners.map(c => v2add(b.pos, v2rotate(c, b.angle)))\n}\n\nfunction getBoxAxes(b: Body): Vec2[] {\n  const ax = v2rotate(vec2(1, 0), b.angle)\n  const ay = v2rotate(vec2(0, 1), b.angle)\n  return [ax, ay]\n}\n\nfunction projectOnAxis(corners: Vec2[], axis: Vec2): { min: number; max: number } {\n  let min = Infinity\n  let max = -Infinity\n  for (const c of corners) {\n    const proj = v2dot(c, axis)\n    if (proj < min) min = proj\n    if (proj > max) max = proj\n  }\n  return { min, max }\n}\n\nfunction collideCircleCircle(a: Body, b: Body): Manifold | null {\n  const diff = v2sub(b.pos, a.pos)\n  const distSq = v2lenSq(diff)\n  const sumR = a.radius + b.radius\n  if (distSq > sumR * sumR) return null\n  const dist = Math.sqrt(distSq)\n  if (dist < 1e-6) {\n    // Bodies at same position, push apart\n    return {\n      bodyA: a,\n      bodyB: b,\n      normal: vec2(0, 1),\n      penetration: sumR,\n      contactPoint: a.pos,\n    }\n  }\n  const normal = v2scale(diff, 1 / dist)\n  const penetration = sumR - dist\n  const contactPoint = v2add(a.pos, v2scale(normal, a.radius - penetration * 0.5))\n  return { bodyA: a, bodyB: b, normal, penetration, contactPoint }\n}\n\nfunction collideCircleBox(circle: Body, box: Body): Manifold | null {\n  // Transform circle center into box's local space\n  const local = v2rotate(v2sub(circle.pos, box.pos), -box.angle)\n  // Find closest point on box to circle center\n  const closest = vec2(\n    clamp(local.x, -box.halfW, box.halfW),\n    clamp(local.y, -box.halfH, box.halfH)\n  )\n  const diff = v2sub(local, closest)\n  const distSq = v2lenSq(diff)\n  if (distSq > circle.radius * circle.radius) return null\n\n  const dist = Math.sqrt(distSq)\n\n  let localNormal: Vec2\n  let penetration: number\n\n  if (dist < 1e-6) {\n    // Circle center is inside the box\n    const dxLeft = local.x + box.halfW\n    const dxRight = box.halfW - local.x\n    const dyBottom = local.y + box.halfH\n    const dyTop = box.halfH - local.y\n    const minDist = Math.min(dxLeft, dxRight, dyBottom, dyTop)\n    if (minDist === dxLeft) localNormal = vec2(-1, 0)\n    else if (minDist === dxRight) localNormal = vec2(1, 0)\n    else if (minDist === dyBottom) localNormal = vec2(0, -1)\n    else localNormal = vec2(0, 1)\n    penetration = circle.radius + minDist\n  } else {\n    localNormal = v2scale(diff, 1 / dist)\n    penetration = circle.radius - dist\n  }\n\n  // Transform normal back to world space\n  const worldNormal = v2rotate(localNormal, box.angle)\n  const contactPoint = v2sub(circle.pos, v2scale(worldNormal, circle.radius - penetration * 0.5))\n\n  return {\n    bodyA: circle,\n    bodyB: box,\n    normal: worldNormal,\n    penetration,\n    contactPoint,\n  }\n}\n\nfunction collideBoxBox(a: Body, b: Body): Manifold | null {\n  const cornersA = getBoxCorners(a)\n  const cornersB = getBoxCorners(b)\n  const axesA = getBoxAxes(a)\n  const axesB = getBoxAxes(b)\n  const axes = [...axesA, ...axesB]\n\n  let minOverlap = Infinity\n  let minAxis = vec2(0, 0)\n\n  for (const axis of axes) {\n    const projA = projectOnAxis(cornersA, axis)\n    const projB = projectOnAxis(cornersB, axis)\n    const overlap = Math.min(projA.max - projB.min, projB.max - projA.min)\n    if (overlap <= 0) return null\n    if (overlap < minOverlap) {\n      minOverlap = overlap\n      minAxis = axis\n    }\n  }\n\n  // Ensure normal points from A to B\n  const d = v2sub(b.pos, a.pos)\n  if (v2dot(d, minAxis) < 0) {\n    minAxis = v2neg(minAxis)\n  }\n\n  // Approximate contact point: midpoint of deepest overlap\n  const contactPoint = v2add(a.pos, v2scale(v2sub(b.pos, a.pos), 0.5))\n\n  return {\n    bodyA: a,\n    bodyB: b,\n    normal: minAxis,\n    penetration: minOverlap,\n    contactPoint,\n  }\n}\n\nfunction detectCollision(a: Body, b: Body): Manifold | null {\n  if (a.type === 'circle' && b.type === 'circle') {\n    return collideCircleCircle(a, b)\n  }\n  if (a.type === 'circle' && b.type === 'box') {\n    return collideCircleBox(a, b)\n  }\n  if (a.type === 'box' && b.type === 'circle') {\n    const m = collideCircleBox(b, a)\n    if (m) {\n      m.bodyA = a\n      m.bodyB = b\n      m.normal = v2neg(m.normal)\n    }\n    return m\n  }\n  if (a.type === 'box' && b.type === 'box') {\n    return collideBoxBox(a, b)\n  }\n  return null\n}\n\n// ---------------------------------------------------------------------------\n// Collision response (impulse-based)\n// ---------------------------------------------------------------------------\n\nfunction resolveCollision(m: Manifold) {\n  const a = m.bodyA\n  const b = m.bodyB\n  const n = m.normal\n\n  // Positional correction (avoid sinking)\n  const percent = 0.6\n  const slop = 0.5\n  const correctionMag = Math.max(m.penetration - slop, 0) / (a.invMass + b.invMass) * percent\n  const correction = v2scale(n, correctionMag)\n  a.pos = v2sub(a.pos, v2scale(correction, a.invMass))\n  b.pos = v2add(b.pos, v2scale(correction, b.invMass))\n\n  // Relative velocity at contact point\n  const rA = v2sub(m.contactPoint, a.pos)\n  const rB = v2sub(m.contactPoint, b.pos)\n  const velA = v2add(a.vel, v2scale(v2perp(rA), a.angVel))\n  const velB = v2add(b.vel, v2scale(v2perp(rB), b.angVel))\n  const relVel = v2sub(velB, velA)\n  const velAlongNormal = v2dot(relVel, n)\n\n  // Separating already\n  if (velAlongNormal > 0) return\n\n  const e = Math.min(a.restitution, b.restitution)\n  const rACrossN = v2cross(rA, n)\n  const rBCrossN = v2cross(rB, n)\n\n  const denominator = a.invMass + b.invMass +\n    rACrossN * rACrossN * a.invInertia +\n    rBCrossN * rBCrossN * b.invInertia\n\n  const j = -(1 + e) * velAlongNormal / denominator\n  const impulse = v2scale(n, j)\n\n  a.vel = v2sub(a.vel, v2scale(impulse, a.invMass))\n  b.vel = v2add(b.vel, v2scale(impulse, b.invMass))\n  a.angVel -= v2cross(rA, impulse) * a.invInertia\n  b.angVel += v2cross(rB, impulse) * b.invInertia\n\n  // Friction impulse (tangent)\n  const relVelAfter = v2sub(\n    v2add(b.vel, v2scale(v2perp(rB), b.angVel)),\n    v2add(a.vel, v2scale(v2perp(rA), a.angVel))\n  )\n  const tangent = v2norm(v2sub(relVelAfter, v2scale(n, v2dot(relVelAfter, n))))\n  const velAlongTangent = v2dot(relVelAfter, tangent)\n  if (Math.abs(velAlongTangent) < 1e-6) return\n\n  const rACrossT = v2cross(rA, tangent)\n  const rBCrossT = v2cross(rB, tangent)\n  const tDenom = a.invMass + b.invMass +\n    rACrossT * rACrossT * a.invInertia +\n    rBCrossT * rBCrossT * b.invInertia\n\n  let jt = -velAlongTangent / tDenom\n  const mu = 0.3\n  if (Math.abs(jt) > j * mu) {\n    jt = j * mu * Math.sign(jt)\n  }\n\n  const frictionImpulse = v2scale(tangent, jt)\n  a.vel = v2sub(a.vel, v2scale(frictionImpulse, a.invMass))\n  b.vel = v2add(b.vel, v2scale(frictionImpulse, b.invMass))\n  a.angVel -= v2cross(rA, frictionImpulse) * a.invInertia\n  b.angVel += v2cross(rB, frictionImpulse) * b.invInertia\n}\n\n// ---------------------------------------------------------------------------\n// Spatial hash grid for broad-phase collision detection\n// ---------------------------------------------------------------------------\n\nclass SpatialGrid {\n  private cellSize: number\n  private cols: number\n  private rows: number\n  private grid: Int32Array\n  private counts: Int32Array\n  private cellCapacity: number\n\n  constructor(width: number, height: number, cellSize: number, maxPerCell: number) {\n    this.cellSize = cellSize\n    this.cols = Math.max(1, Math.ceil(width / cellSize))\n    this.rows = Math.max(1, Math.ceil(height / cellSize))\n    this.cellCapacity = maxPerCell\n    const totalCells = this.cols * this.rows\n    this.grid = new Int32Array(totalCells * maxPerCell)\n    this.counts = new Int32Array(totalCells)\n  }\n\n  clear() {\n    this.counts.fill(0)\n  }\n\n  insert(index: number, x: number, y: number) {\n    const col = Math.floor(x / this.cellSize)\n    const row = Math.floor(y / this.cellSize)\n    if (col < 0 || col >= this.cols || row < 0 || row >= this.rows) return\n    const cellIdx = row * this.cols + col\n    const count = this.counts[cellIdx]\n    if (count < this.cellCapacity) {\n      this.grid[cellIdx * this.cellCapacity + count] = index\n      this.counts[cellIdx] = count + 1\n    }\n  }\n\n  query(x: number, y: number, radius: number, callback: (index: number) => void) {\n    const minCol = Math.max(0, Math.floor((x - radius) / this.cellSize))\n    const maxCol = Math.min(this.cols - 1, Math.floor((x + radius) / this.cellSize))\n    const minRow = Math.max(0, Math.floor((y - radius) / this.cellSize))\n    const maxRow = Math.min(this.rows - 1, Math.floor((y + radius) / this.cellSize))\n\n    for (let r = minRow; r <= maxRow; r++) {\n      for (let c = minCol; c <= maxCol; c++) {\n        const cellIdx = r * this.cols + c\n        const count = this.counts[cellIdx]\n        const base = cellIdx * this.cellCapacity\n        for (let i = 0; i < count; i++) {\n          callback(this.grid[base + i])\n        }\n      }\n    }\n  }\n\n  resize(width: number, height: number) {\n    this.cols = Math.max(1, Math.ceil(width / this.cellSize))\n    this.rows = Math.max(1, Math.ceil(height / this.cellSize))\n    const totalCells = this.cols * this.rows\n    this.grid = new Int32Array(totalCells * this.cellCapacity)\n    this.counts = new Int32Array(totalCells)\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Pre-allocated scratch Vec2 for collision inner loop\n// ---------------------------------------------------------------------------\n\nconst _scratch: Vec2 = { x: 0, y: 0 }\n\n/** Mutable subtract: writes (a - b) into `out` and returns `out`. */\nfunction v2subInto(out: Vec2, a: Vec2, b: Vec2): Vec2 {\n  out.x = a.x - b.x\n  out.y = a.y - b.y\n  return out\n}\n\n// ---------------------------------------------------------------------------\n// Engine\n// ---------------------------------------------------------------------------\n\nexport class PhysicsEngine {\n  private canvas: HTMLCanvasElement\n  private ctx: CanvasRenderingContext2D\n\n  private bodies: Body[] = []\n  private springs: Spring[] = []\n\n  private tool: Tool = 'circle'\n  private gravity: Vec2 = vec2(0, 400)\n  private restitution = 0.5\n\n  // Mouse state\n  private mouse: Vec2 = vec2(0, 0)\n  private mouseDown = false\n  private dragStart: Vec2 | null = null\n  private springAnchor: Body | null = null\n\n  // Fixed timestep\n  private readonly FIXED_DT = 1 / 60\n  private accumulator = 0\n  private lastTime = 0\n\n  private animationId = 0\n  private disposed = false\n  private resizeObserver: ResizeObserver | null = null\n\n  // Grid lines spacing\n  private readonly GRID_SIZE = 40\n\n  // Spatial grid for broad-phase collision detection\n  private spatialGrid!: SpatialGrid\n  private readonly SPATIAL_CELL_SIZE = 80\n\n  // Body count change callback\n  private bodyCountChangeCallback: ((count: number) => void) | null = null\n\n  constructor(private container: HTMLDivElement) {\n    this.canvas = document.createElement('canvas')\n    this.canvas.style.width = '100%'\n    this.canvas.style.height = '100%'\n    this.canvas.style.display = 'block'\n    container.appendChild(this.canvas)\n\n    this.ctx = this.canvas.getContext('2d')!\n\n    this.resizeCanvas()\n    const w = this.container.clientWidth\n    const h = this.container.clientHeight\n    this.spatialGrid = new SpatialGrid(w, h, this.SPATIAL_CELL_SIZE, 20)\n    this.initListeners()\n    this.lastTime = performance.now()\n    this.animate()\n  }\n\n  // --- Public API ---\n\n  setTool(tool: Tool) {\n    this.tool = tool\n    this.springAnchor = null\n  }\n\n  setGravity(strength: number) {\n    this.gravity = vec2(0, strength)\n  }\n\n  setRestitution(value: number) {\n    this.restitution = clamp(value, 0, 1)\n    for (const b of this.bodies) b.restitution = this.restitution\n  }\n\n  clear() {\n    this.bodies = []\n    this.springs = []\n    this.springAnchor = null\n    this.notifyBodyCountChange()\n  }\n\n  get bodyCount(): number {\n    return this.bodies.length\n  }\n\n  onBodyCountChange(callback: ((count: number) => void) | null) {\n    this.bodyCountChangeCallback = callback\n  }\n\n  private notifyBodyCountChange() {\n    if (this.bodyCountChangeCallback) {\n      this.bodyCountChangeCallback(this.bodies.length)\n    }\n  }\n\n  dispose() {\n    this.disposed = true\n    cancelAnimationFrame(this.animationId)\n    this.removeListeners()\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect()\n      this.resizeObserver = null\n    }\n    if (this.canvas.parentElement) {\n      this.canvas.parentElement.removeChild(this.canvas)\n    }\n  }\n\n  // --- Resize ---\n\n  private resizeCanvas() {\n    const dpr = Math.min(window.devicePixelRatio, 2)\n    const w = this.container.clientWidth\n    const h = this.container.clientHeight\n    this.canvas.width = w * dpr\n    this.canvas.height = h * dpr\n    this.ctx.setTransform(dpr, 0, 0, dpr, 0, 0)\n  }\n\n  // --- Input ---\n\n  private getMousePos(e: MouseEvent | Touch): Vec2 {\n    const rect = this.canvas.getBoundingClientRect()\n    return vec2(e.clientX - rect.left, e.clientY - rect.top)\n  }\n\n  private bodyAtPoint(p: Vec2): Body | null {\n    for (let i = this.bodies.length - 1; i >= 0; i--) {\n      const b = this.bodies[i]\n      if (b.type === 'circle') {\n        if (v2lenSq(v2sub(p, b.pos)) <= b.radius * b.radius) return b\n      } else {\n        const local = v2rotate(v2sub(p, b.pos), -b.angle)\n        if (Math.abs(local.x) <= b.halfW && Math.abs(local.y) <= b.halfH) return b\n      }\n    }\n    return null\n  }\n\n  private onMouseDown = (e: MouseEvent) => {\n    this.mouse = this.getMousePos(e)\n    this.mouseDown = true\n\n    if (this.tool === 'circle' || this.tool === 'box') {\n      this.dragStart = { ...this.mouse }\n    } else if (this.tool === 'spring') {\n      const hit = this.bodyAtPoint(this.mouse)\n      if (hit) {\n        this.springAnchor = hit\n      }\n    } else if (this.tool === 'explosion') {\n      this.applyExplosion(this.mouse)\n    }\n  }\n\n  private onMouseMove = (e: MouseEvent) => {\n    this.mouse = this.getMousePos(e)\n  }\n\n  private onMouseUp = (e: MouseEvent) => {\n    this.mouse = this.getMousePos(e)\n    this.mouseDown = false\n\n    if (this.tool === 'circle' && this.dragStart) {\n      const radius = v2len(v2sub(this.mouse, this.dragStart))\n      if (radius > 3) {\n        const body = createCircle(this.dragStart.x, this.dragStart.y, radius, this.restitution)\n        this.bodies.push(body)\n        this.notifyBodyCountChange()\n      }\n      this.dragStart = null\n    } else if (this.tool === 'box' && this.dragStart) {\n      const hw = Math.abs(this.mouse.x - this.dragStart.x) * 0.5\n      const hh = Math.abs(this.mouse.y - this.dragStart.y) * 0.5\n      if (hw > 3 && hh > 3) {\n        const cx = (this.mouse.x + this.dragStart.x) * 0.5\n        const cy = (this.mouse.y + this.dragStart.y) * 0.5\n        const body = createBox(cx, cy, hw, hh, this.restitution)\n        this.bodies.push(body)\n        this.notifyBodyCountChange()\n      }\n      this.dragStart = null\n    } else if (this.tool === 'spring' && this.springAnchor) {\n      const hit = this.bodyAtPoint(this.mouse)\n      if (hit && hit !== this.springAnchor) {\n        const dist = v2len(v2sub(hit.pos, this.springAnchor.pos))\n        this.springs.push({\n          bodyA: this.springAnchor,\n          bodyB: hit,\n          restLength: dist,\n          stiffness: 200,\n          damping: 5,\n        })\n      }\n      this.springAnchor = null\n    }\n\n    this.dragStart = null\n  }\n\n  private onTouchStart = (e: TouchEvent) => {\n    e.preventDefault()\n    const touch = e.touches[0]\n    this.mouse = this.getMousePos(touch)\n    this.mouseDown = true\n\n    if (this.tool === 'circle' || this.tool === 'box') {\n      this.dragStart = { ...this.mouse }\n    } else if (this.tool === 'spring') {\n      const hit = this.bodyAtPoint(this.mouse)\n      if (hit) this.springAnchor = hit\n    } else if (this.tool === 'explosion') {\n      this.applyExplosion(this.mouse)\n    }\n  }\n\n  private onTouchMove = (e: TouchEvent) => {\n    e.preventDefault()\n    this.mouse = this.getMousePos(e.touches[0])\n  }\n\n  private onTouchEnd = () => {\n    // Replicate mouseUp logic\n    this.mouseDown = false\n    if (this.tool === 'circle' && this.dragStart) {\n      const radius = v2len(v2sub(this.mouse, this.dragStart))\n      if (radius > 3) {\n        this.bodies.push(createCircle(this.dragStart.x, this.dragStart.y, radius, this.restitution))\n        this.notifyBodyCountChange()\n      }\n      this.dragStart = null\n    } else if (this.tool === 'box' && this.dragStart) {\n      const hw = Math.abs(this.mouse.x - this.dragStart.x) * 0.5\n      const hh = Math.abs(this.mouse.y - this.dragStart.y) * 0.5\n      if (hw > 3 && hh > 3) {\n        const cx = (this.mouse.x + this.dragStart.x) * 0.5\n        const cy = (this.mouse.y + this.dragStart.y) * 0.5\n        this.bodies.push(createBox(cx, cy, hw, hh, this.restitution))\n        this.notifyBodyCountChange()\n      }\n      this.dragStart = null\n    } else if (this.tool === 'spring' && this.springAnchor) {\n      const hit = this.bodyAtPoint(this.mouse)\n      if (hit && hit !== this.springAnchor) {\n        const dist = v2len(v2sub(hit.pos, this.springAnchor.pos))\n        this.springs.push({\n          bodyA: this.springAnchor,\n          bodyB: hit,\n          restLength: dist,\n          stiffness: 200,\n          damping: 5,\n        })\n      }\n      this.springAnchor = null\n    }\n  }\n\n  private initListeners() {\n    this.canvas.addEventListener('mousedown', this.onMouseDown)\n    this.canvas.addEventListener('mousemove', this.onMouseMove)\n    window.addEventListener('mouseup', this.onMouseUp)\n    this.canvas.addEventListener('touchstart', this.onTouchStart, { passive: false })\n    this.canvas.addEventListener('touchmove', this.onTouchMove, { passive: false })\n    window.addEventListener('touchend', this.onTouchEnd)\n\n    this.resizeObserver = new ResizeObserver(() => {\n      if (!this.disposed) {\n        this.resizeCanvas()\n        this.spatialGrid.resize(this.container.clientWidth, this.container.clientHeight)\n      }\n    })\n    this.resizeObserver.observe(this.container)\n  }\n\n  private removeListeners() {\n    this.canvas.removeEventListener('mousedown', this.onMouseDown)\n    this.canvas.removeEventListener('mousemove', this.onMouseMove)\n    window.removeEventListener('mouseup', this.onMouseUp)\n    this.canvas.removeEventListener('touchstart', this.onTouchStart)\n    this.canvas.removeEventListener('touchmove', this.onTouchMove)\n    window.removeEventListener('touchend', this.onTouchEnd)\n  }\n\n  // --- Tools ---\n\n  private applyGravityGun(dt: number) {\n    if (!this.mouseDown || this.tool !== 'gravity') return\n    const range = 250\n    const strength = 8000\n    for (const b of this.bodies) {\n      const diff = v2sub(this.mouse, b.pos)\n      const dist = v2len(diff)\n      if (dist < range && dist > 1) {\n        const force = v2scale(v2norm(diff), strength * dt / Math.max(dist, 30))\n        b.vel = v2add(b.vel, v2scale(force, b.invMass))\n      }\n    }\n  }\n\n  private applyExplosion(center: Vec2) {\n    const strength = 50000\n    const range = 300\n    for (const b of this.bodies) {\n      const diff = v2sub(b.pos, center)\n      const dist = v2len(diff)\n      if (dist < range && dist > 1) {\n        const force = v2scale(v2norm(diff), strength / Math.max(dist, 20))\n        b.vel = v2add(b.vel, v2scale(force, b.invMass))\n      }\n    }\n  }\n\n  // --- Physics step ---\n\n  private physicsStep(dt: number) {\n    const w = this.container.clientWidth\n    const h = this.container.clientHeight\n\n    // Gravity gun\n    this.applyGravityGun(dt)\n\n    // Apply gravity\n    for (const b of this.bodies) {\n      if (b.isStatic) continue\n      b.vel = v2add(b.vel, v2scale(this.gravity, dt))\n    }\n\n    // Apply spring forces\n    for (const s of this.springs) {\n      const diff = v2sub(s.bodyB.pos, s.bodyA.pos)\n      const dist = v2len(diff)\n      if (dist < 1e-6) continue\n      const n = v2scale(diff, 1 / dist)\n      const displacement = dist - s.restLength\n      const relVel = v2sub(s.bodyB.vel, s.bodyA.vel)\n      const dampingForce = v2dot(relVel, n) * s.damping\n      const forceMag = displacement * s.stiffness + dampingForce\n      const force = v2scale(n, forceMag)\n\n      s.bodyA.vel = v2add(s.bodyA.vel, v2scale(force, s.bodyA.invMass * dt))\n      s.bodyB.vel = v2sub(s.bodyB.vel, v2scale(force, s.bodyB.invMass * dt))\n    }\n\n    // Integrate positions\n    for (const b of this.bodies) {\n      if (b.isStatic) continue\n      b.pos = v2add(b.pos, v2scale(b.vel, dt))\n      b.angle += b.angVel * dt\n      // Angular damping\n      b.angVel *= 0.998\n      // Linear damping\n      b.vel = v2scale(b.vel, 0.999)\n    }\n\n    // Rebuild spatial grid and detect collisions via broad phase\n    const bodies = this.bodies\n    const n = bodies.length\n    this.spatialGrid.clear()\n\n    // Find max radius across all bodies for query range\n    let maxRadius = 0\n    for (let i = 0; i < n; i++) {\n      if (bodies[i].radius > maxRadius) maxRadius = bodies[i].radius\n      this.spatialGrid.insert(i, bodies[i].pos.x, bodies[i].pos.y)\n    }\n\n    // Query radius: each body needs to find neighbors within (its radius + maxRadius)\n    // We use maxRadius * 2 as the query range to cover the worst case pair\n    const queryRange = maxRadius * 2 * 1.1 // 1.1 factor matches the old 1.2 on squared distance\n\n    for (let i = 0; i < n; i++) {\n      const a = bodies[i]\n      this.spatialGrid.query(a.pos.x, a.pos.y, queryRange, (j: number) => {\n        if (j <= i) return // avoid duplicate pairs and self\n        const b = bodies[j]\n        // Narrow broad phase: bounding sphere check with pre-allocated scratch\n        v2subInto(_scratch, a.pos, b.pos)\n        const distSq = _scratch.x * _scratch.x + _scratch.y * _scratch.y\n        const sumR = a.radius + b.radius\n        if (distSq > sumR * sumR * 1.2) return\n\n        const manifold = detectCollision(a, b)\n        if (manifold) {\n          resolveCollision(manifold)\n        }\n      })\n    }\n\n    // Wall collisions\n    for (const b of bodies) {\n      this.resolveWall(b, w, h)\n    }\n\n    // Remove bodies that fell far off-screen\n    const prevCount = this.bodies.length\n    this.bodies = this.bodies.filter(b =>\n      b.pos.y < h + 500 && b.pos.y > -500 && b.pos.x > -500 && b.pos.x < w + 500\n    )\n    if (this.bodies.length !== prevCount) {\n      this.notifyBodyCountChange()\n    }\n\n    // Remove springs whose bodies no longer exist\n    const bodySet = new Set(this.bodies)\n    this.springs = this.springs.filter(s => bodySet.has(s.bodyA) && bodySet.has(s.bodyB))\n  }\n\n  private resolveWall(b: Body, w: number, h: number) {\n    const bounce = b.restitution\n\n    if (b.type === 'circle') {\n      // Bottom\n      if (b.pos.y + b.radius > h) {\n        b.pos.y = h - b.radius\n        b.vel.y = -Math.abs(b.vel.y) * bounce\n        b.angVel += b.vel.x * 0.01\n      }\n      // Top\n      if (b.pos.y - b.radius < 0) {\n        b.pos.y = b.radius\n        b.vel.y = Math.abs(b.vel.y) * bounce\n      }\n      // Right\n      if (b.pos.x + b.radius > w) {\n        b.pos.x = w - b.radius\n        b.vel.x = -Math.abs(b.vel.x) * bounce\n      }\n      // Left\n      if (b.pos.x - b.radius < 0) {\n        b.pos.x = b.radius\n        b.vel.x = Math.abs(b.vel.x) * bounce\n      }\n    } else {\n      // Use bounding radius for approximate wall collision\n      const r = b.radius\n      if (b.pos.y + r > h) {\n        b.pos.y = h - r\n        b.vel.y = -Math.abs(b.vel.y) * bounce\n        b.angVel += b.vel.x * 0.005\n      }\n      if (b.pos.y - r < 0) {\n        b.pos.y = r\n        b.vel.y = Math.abs(b.vel.y) * bounce\n      }\n      if (b.pos.x + r > w) {\n        b.pos.x = w - r\n        b.vel.x = -Math.abs(b.vel.x) * bounce\n      }\n      if (b.pos.x - r < 0) {\n        b.pos.x = r\n        b.vel.x = Math.abs(b.vel.x) * bounce\n      }\n    }\n  }\n\n  // --- Rendering ---\n\n  private draw() {\n    const ctx = this.ctx\n    const w = this.container.clientWidth\n    const h = this.container.clientHeight\n\n    // Clear\n    ctx.fillStyle = '#0a0a0a'\n    ctx.fillRect(0, 0, w, h)\n\n    // Grid\n    ctx.strokeStyle = 'rgba(255, 255, 255, 0.04)'\n    ctx.lineWidth = 1\n    ctx.beginPath()\n    for (let x = 0; x < w; x += this.GRID_SIZE) {\n      ctx.moveTo(x, 0)\n      ctx.lineTo(x, h)\n    }\n    for (let y = 0; y < h; y += this.GRID_SIZE) {\n      ctx.moveTo(0, y)\n      ctx.lineTo(w, y)\n    }\n    ctx.stroke()\n\n    // Springs\n    ctx.setLineDash([6, 4])\n    ctx.lineWidth = 1.5\n    for (const s of this.springs) {\n      const stress = Math.abs(v2len(v2sub(s.bodyB.pos, s.bodyA.pos)) - s.restLength) / s.restLength\n      const r = Math.min(255, 120 + stress * 400)\n      const g = Math.max(0, 180 - stress * 300)\n      ctx.strokeStyle = `rgba(${r | 0}, ${g | 0}, 120, 0.7)`\n      ctx.beginPath()\n      ctx.moveTo(s.bodyA.pos.x, s.bodyA.pos.y)\n      ctx.lineTo(s.bodyB.pos.x, s.bodyB.pos.y)\n      ctx.stroke()\n    }\n    ctx.setLineDash([])\n\n    // Bodies\n    for (const b of this.bodies) {\n      ctx.save()\n      ctx.translate(b.pos.x, b.pos.y)\n      ctx.rotate(b.angle)\n\n      if (b.type === 'circle') {\n        ctx.beginPath()\n        ctx.arc(0, 0, b.radius, 0, Math.PI * 2)\n        ctx.fillStyle = b.color\n        ctx.globalAlpha = 0.85\n        ctx.fill()\n        ctx.globalAlpha = 1\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)'\n        ctx.lineWidth = 1\n        ctx.stroke()\n\n        // Rotation indicator\n        ctx.beginPath()\n        ctx.moveTo(0, 0)\n        ctx.lineTo(b.radius * 0.8, 0)\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)'\n        ctx.lineWidth = 1.5\n        ctx.stroke()\n      } else {\n        ctx.fillStyle = b.color\n        ctx.globalAlpha = 0.85\n        ctx.fillRect(-b.halfW, -b.halfH, b.halfW * 2, b.halfH * 2)\n        ctx.globalAlpha = 1\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)'\n        ctx.lineWidth = 1\n        ctx.strokeRect(-b.halfW, -b.halfH, b.halfW * 2, b.halfH * 2)\n\n        // Corner dot\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.3)'\n        ctx.beginPath()\n        ctx.arc(b.halfW - 4, -b.halfH + 4, 2, 0, Math.PI * 2)\n        ctx.fill()\n      }\n\n      ctx.restore()\n    }\n\n    // Draw tool preview\n    this.drawToolPreview(ctx)\n\n    // Spring anchor line\n    if (this.tool === 'spring' && this.springAnchor) {\n      ctx.strokeStyle = 'rgba(255, 180, 60, 0.6)'\n      ctx.lineWidth = 2\n      ctx.setLineDash([4, 4])\n      ctx.beginPath()\n      ctx.moveTo(this.springAnchor.pos.x, this.springAnchor.pos.y)\n      ctx.lineTo(this.mouse.x, this.mouse.y)\n      ctx.stroke()\n      ctx.setLineDash([])\n    }\n\n    // Gravity gun indicator\n    if (this.tool === 'gravity' && this.mouseDown) {\n      ctx.strokeStyle = 'rgba(100, 200, 255, 0.25)'\n      ctx.lineWidth = 1\n      ctx.beginPath()\n      ctx.arc(this.mouse.x, this.mouse.y, 250, 0, Math.PI * 2)\n      ctx.stroke()\n\n      ctx.fillStyle = 'rgba(100, 200, 255, 0.4)'\n      ctx.beginPath()\n      ctx.arc(this.mouse.x, this.mouse.y, 6, 0, Math.PI * 2)\n      ctx.fill()\n    }\n  }\n\n  private drawToolPreview(ctx: CanvasRenderingContext2D) {\n    if (!this.dragStart || !this.mouseDown) return\n\n    ctx.strokeStyle = 'rgba(255, 255, 255, 0.4)'\n    ctx.lineWidth = 1\n    ctx.setLineDash([4, 4])\n\n    if (this.tool === 'circle') {\n      const r = v2len(v2sub(this.mouse, this.dragStart))\n      ctx.beginPath()\n      ctx.arc(this.dragStart.x, this.dragStart.y, r, 0, Math.PI * 2)\n      ctx.stroke()\n    } else if (this.tool === 'box') {\n      const x = Math.min(this.dragStart.x, this.mouse.x)\n      const y = Math.min(this.dragStart.y, this.mouse.y)\n      const w = Math.abs(this.mouse.x - this.dragStart.x)\n      const h = Math.abs(this.mouse.y - this.dragStart.y)\n      ctx.strokeRect(x, y, w, h)\n    }\n\n    ctx.setLineDash([])\n  }\n\n  // --- Main loop ---\n\n  private animate = () => {\n    if (this.disposed) return\n    this.animationId = requestAnimationFrame(this.animate)\n\n    const now = performance.now()\n    const frameDt = Math.min((now - this.lastTime) * 0.001, 0.1)\n    this.lastTime = now\n\n    this.accumulator += frameDt\n    while (this.accumulator >= this.FIXED_DT) {\n      this.physicsStep(this.FIXED_DT)\n      this.accumulator -= this.FIXED_DT\n    }\n\n    this.draw()\n  }\n}\n"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","toPropertyKey","t","i","r","e","toPrimitive","call","TypeError","String","Number","_defineProperties","length","enumerable","configurable","writable","Object","defineProperty","key","_createClass","vec2","x","y","v2add","a","b","v2sub","v2scale","s","v2dot","v2cross","v2len","Math","sqrt","v2lenSq","v2norm","l","v2perp","v2neg","v2rotate","v","angle","c","cos","sin","clamp","val","min","max","bodyIdCounter","createCircle","radius","restitution","mass","PI","inertia","type","pos","vel","angVel","invMass","invInertia","halfW","halfH","color","randomPastelColor","id","isStatic","createBox","hw","hh","random","getBoxCorners","map","getBoxAxes","projectOnAxis","corners","axis","Infinity","proj","collideCircleBox","circle","box","local","diff","distSq","dist","localNormal","penetration","dxLeft","dxRight","dyBottom","dyTop","minDist","worldNormal","bodyA","bodyB","normal","contactPoint","detectCollision","sumR","collideCircleCircle","m","cornersA","cornersB","axesA","axesB","axes","concat","_toConsumableArray","minOverlap","minAxis","projA","projB","overlap","collideBoxBox","resolveCollision","n","correction","rA","rB","velA","velAlongNormal","rACrossN","rBCrossN","j","impulse","relVelAfter","tangent","velAlongTangent","abs","rACrossT","rBCrossT","jt","sign","frictionImpulse","SpatialGrid","width","height","cellSize","maxPerCell","this","cols","ceil","rows","cellCapacity","totalCells","grid","Int32Array","counts","_proto","clear","fill","insert","index","col","floor","row","cellIdx","count","query","callback","minCol","maxCol","minRow","maxRow","base","resize","_scratch","v2subInto","out","PhysicsEngine","container","bodies","springs","tool","gravity","mouse","mouseDown","dragStart","springAnchor","FIXED_DT","accumulator","lastTime","animationId","disposed","resizeObserver","GRID_SIZE","SPATIAL_CELL_SIZE","bodyCountChangeCallback","onMouseDown","getMousePos","hit","bodyAtPoint","applyExplosion","onMouseMove","onMouseUp","body","push","notifyBodyCountChange","restLength","stiffness","damping","onTouchStart","preventDefault","touch","touches","onTouchMove","onTouchEnd","cx","cy","animate","requestAnimationFrame","now","performance","frameDt","physicsStep","draw","canvas","document","createElement","style","display","appendChild","ctx","getContext","resizeCanvas","w","clientWidth","h","clientHeight","spatialGrid","initListeners","_proto2","setTool","setGravity","strength","setRestitution","value","onBodyCountChange","dispose","cancelAnimationFrame","removeListeners","disconnect","parentElement","removeChild","dpr","window","devicePixelRatio","setTransform","rect","getBoundingClientRect","clientX","left","clientY","top","p","addEventListener","passive","ResizeObserver","observe","removeEventListener","applyGravityGun","dt","force","center","displacement","dampingForce","maxRadius","queryRange","manifold","resolveWall","prevCount","filter","bodySet","Set","has","bounce","fillStyle","fillRect","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","setLineDash","stress","g","save","translate","rotate","arc","globalAlpha","strokeRect","restore","drawToolPreview","get"],"sourceRoot":""}