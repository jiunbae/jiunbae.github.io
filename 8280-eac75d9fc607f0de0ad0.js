"use strict";(self.webpackChunkjiunbae_github_io=self.webpackChunkjiunbae_github_io||[]).push([[8280],{8280:function(t,i,s){s.r(i),s.d(i,{CellularAutomataEngine:function(){return r}});const e={life:{survive:[2,3],birth:[3]},highlife:{survive:[2,3],birth:[3,6]},seeds:{survive:[],birth:[2]}};function n(t,i,s){return Math.max(i,Math.min(s,t))}function h(t){const i=Array.from({length:9},()=>!1),s=Array.from({length:9},()=>!1);for(const n of e[t].survive)i[n]=!0;for(const n of e[t].birth)s[n]=!0;return{survive:i,birth:s}}let r=function(){function t(t){this.grid=new Uint8Array(0),this.next=new Uint8Array(0),this.age=new Uint16Array(0),this.cols=0,this.rows=0,this.w=1,this.h=1,this.dpr=1,this.cellSize=8,this.wrapEdges=!0,this.running=!0,this.generation=0,this.tickInterval=1e3/14,this.accumulator=0,this.rule="life",this.ruleMask=h("life"),this.animationId=0,this.lastTs=0,this.disposed=!1,this.pointerDown=!1,this.pointerId=null,this.paintValue=1,this.resizeObserver=null,this.dirty=!0,this.generationListener=null,this.animate=t=>{if(this.disposed)return;this.animationId=0;let i=!1;if(this.running){0===this.lastTs&&(this.lastTs=t);const s=Math.min(100,t-this.lastTs);this.lastTs=t,this.accumulator+=s;let e=!1;for(;this.accumulator>=this.tickInterval;)this.stepSimulation(),this.accumulator-=this.tickInterval,e=!0;e&&(i=!0,this.dirty=!0)}else this.lastTs=0,this.accumulator=0;i&&this.notifyGeneration(),this.dirty&&(this.draw(),this.dirty=!1),(this.running||this.dirty)&&this.requestFrame()},this.onPointerDown=t=>{if(0!==t.button)return;const i=this.indexFromClient(t.clientX,t.clientY);i<0||(this.pointerDown=!0,this.pointerId=t.pointerId,this.paintValue=1===this.grid[i]?0:1,this.paintCell(i,this.paintValue),this.canvas.setPointerCapture(t.pointerId))},this.onPointerMove=t=>{if(!this.pointerDown||this.pointerId!==t.pointerId)return;const i=this.indexFromClient(t.clientX,t.clientY);i<0||this.paintCell(i,this.paintValue)},this.onPointerUp=t=>{this.pointerId===t.pointerId&&(this.pointerDown=!1,this.pointerId=null,this.canvas.hasPointerCapture(t.pointerId)&&this.canvas.releasePointerCapture(t.pointerId))},this.onContextMenu=t=>{t.preventDefault()},this.container=t,this.canvas=document.createElement("canvas"),this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.canvas.style.touchAction="none",t.appendChild(this.canvas);const i=this.canvas.getContext("2d");if(!i)throw new Error("Canvas 2D context is not available");this.ctx=i,this.resizeCanvas(!0),this.randomize(.22),this.initListeners(),this.requestFrame()}var i=t.prototype;return i.setRule=function(t){this.rule!==t&&(this.rule=t,this.ruleMask=h(t))},i.setCellSize=function(t){const i=Math.round(n(t,4,22));i!==this.cellSize&&(this.cellSize=i,this.resizeCanvas(!1))},i.setSpeed=function(t){const i=1e3/n(t,1,60);this.tickInterval!==i&&(this.tickInterval=i)},i.setRunning=function(t){this.running!==t&&(this.running=t,this.lastTs=0,t&&this.requestFrame())},i.setWrapEdges=function(t){this.wrapEdges!==t&&(this.wrapEdges=t)},i.randomize=function(t){const i=n(t,0,1);for(let s=0;s<this.grid.length;s++){const t=Math.random()<i?1:0;this.grid[s]=t,this.next[s]=0,this.age[s]=1===t?1:0}this.generation=0,this.notifyGeneration(),this.markDirty()},i.clear=function(){this.grid.fill(0),this.next.fill(0),this.age.fill(0),this.generation=0,this.notifyGeneration(),this.markDirty()},i.step=function(){this.stepSimulation(),this.notifyGeneration(),this.markDirty()},i.getGeneration=function(){return this.generation},i.setGenerationListener=function(t){this.generationListener=t,this.notifyGeneration()},i.dispose=function(){var t;this.disposed=!0,this.generationListener=null,0!==this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=0),null===(t=this.resizeObserver)||void 0===t||t.disconnect(),this.resizeObserver=null,this.canvas.removeEventListener("pointerdown",this.onPointerDown),window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("pointercancel",this.onPointerUp),this.canvas.removeEventListener("contextmenu",this.onContextMenu),this.canvas.parentElement&&this.canvas.parentElement.removeChild(this.canvas)},i.stepSimulation=function(){if(0===this.cols||0===this.rows)return;const t=this.grid,i=this.next;for(let s=0;s<this.rows;s++)for(let e=0;e<this.cols;e++){const n=s*this.cols+e,h=this.countNeighbors(t,e,s),r=1===t[n];i[n]=(r?this.ruleMask.survive[h]:this.ruleMask.birth[h])?1:0}this.grid=i,this.next=t;for(let s=0;s<this.grid.length;s++)if(1===this.grid[s]){const t=this.age[s];this.age[s]=t<65535?t+1:t}else this.age[s]=0;this.generation++},i.countNeighbors=function(t,i,s){let e=0;for(let n=-1;n<=1;n++)for(let h=-1;h<=1;h++){if(0===h&&0===n)continue;let r=i+h,o=s+n;if(this.wrapEdges)r=(r+this.cols)%this.cols,o=(o+this.rows)%this.rows;else if(r<0||r>=this.cols||o<0||o>=this.rows)continue;1===t[o*this.cols+r]&&e++}return e},i.draw=function(){this.ctx.clearRect(0,0,this.w,this.h),this.ctx.fillStyle="#040812",this.ctx.fillRect(0,0,this.w,this.h);const t=this.cellSize,i=Math.max(1,t-1);for(let s=0;s<this.rows;s++)for(let e=0;e<this.cols;e++){const n=s*this.cols+e;if(0===this.grid[n])continue;const h=this.age[n],r=(185+2.1*h+.45*e+.35*s)%360,o=Math.min(74,40+1.1*h);this.ctx.fillStyle=`hsl(${r} 86% ${o}%)`,this.ctx.fillRect(e*t+.5,s*t+.5,i,i)}if(this.cellSize>=12){this.ctx.strokeStyle="rgba(124, 162, 255, 0.08)",this.ctx.lineWidth=1,this.ctx.beginPath();for(let t=0;t<=this.cols;t++){const i=t*this.cellSize+.5;this.ctx.moveTo(i,0),this.ctx.lineTo(i,this.h)}for(let t=0;t<=this.rows;t++){const i=t*this.cellSize+.5;this.ctx.moveTo(0,i),this.ctx.lineTo(this.w,i)}this.ctx.stroke()}},i.resizeCanvas=function(t){const i=this.container.getBoundingClientRect();this.w=Math.max(1,Math.floor(i.width)),this.h=Math.max(1,Math.floor(i.height)),this.dpr=Math.min(window.devicePixelRatio||1,2),this.canvas.width=Math.floor(this.w*this.dpr),this.canvas.height=Math.floor(this.h*this.dpr),this.ctx.setTransform(this.dpr,0,0,this.dpr,0,0),this.ctx.imageSmoothingEnabled=!1,this.rebuildGrid(!t)},i.rebuildGrid=function(t){const i=Math.max(8,Math.floor(this.w/this.cellSize)),s=Math.max(8,Math.floor(this.h/this.cellSize)),e=i*s,n=new Uint8Array(e),h=new Uint16Array(e);if(t&&this.cols>0&&this.rows>0){const t=Math.min(this.cols,i),e=Math.min(this.rows,s),r=Math.floor((this.cols-t)/2),o=Math.floor((this.rows-e)/2),a=Math.floor((i-t)/2),l=Math.floor((s-e)/2);for(let s=0;s<e;s++)for(let e=0;e<t;e++){const t=(o+s)*this.cols+(r+e),c=(l+s)*i+(a+e);n[c]=this.grid[t],h[c]=this.age[t]}}this.cols=i,this.rows=s,this.grid=n,this.next=new Uint8Array(e),this.age=h,this.accumulator=0,this.markDirty()},i.markDirty=function(){this.dirty=!0,this.requestFrame()},i.requestFrame=function(){this.disposed||0!==this.animationId||(this.animationId=requestAnimationFrame(this.animate))},i.notifyGeneration=function(){this.generationListener&&this.generationListener(this.generation)},i.initListeners=function(){this.resizeObserver=new ResizeObserver(()=>this.resizeCanvas(!1)),this.resizeObserver.observe(this.container),this.canvas.addEventListener("pointerdown",this.onPointerDown),window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp),window.addEventListener("pointercancel",this.onPointerUp),this.canvas.addEventListener("contextmenu",this.onContextMenu)},i.paintCell=function(t,i){this.grid[t]!==i&&(this.grid[t]=i,this.age[t]=1===i?Math.max(1,this.age[t]):0,this.markDirty())},i.indexFromClient=function(t,i){const s=this.canvas.getBoundingClientRect(),e=t-s.left,n=i-s.top;if(e<0||n<0||e>=s.width||n>=s.height)return-1;const h=e/s.width*this.w,r=n/s.height*this.h,o=Math.floor(h/this.cellSize),a=Math.floor(r/this.cellSize);return o<0||o>=this.cols||a<0||a>=this.rows?-1:a*this.cols+o},t}()}}]);
//# sourceMappingURL=8280-eac75d9fc607f0de0ad0.js.map