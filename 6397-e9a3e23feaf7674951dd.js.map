{"version":3,"file":"6397-e9a3e23feaf7674951dd.js","mappings":"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","sources":["webpack://jiunbae.github.io/./src/views/SortingLab/engine.ts"],"sourcesContent":["export type SortAlgorithm = 'quick' | 'bubble' | 'selection' | 'insertion'\nexport type Distribution = 'random' | 'reversed' | 'nearlySorted'\n\ninterface CompareOperation {\n  type: 'compare'\n  a: number\n  b: number\n}\n\ninterface SwapOperation {\n  type: 'swap'\n  a: number\n  b: number\n}\n\ntype SortOperation = CompareOperation | SwapOperation\n\nexport interface SortSnapshot {\n  running: boolean\n  done: boolean\n  algorithm: SortAlgorithm\n  size: number\n  distribution: Distribution\n  comparisons: number\n  swaps: number\n  operations: number\n  totalOperations: number\n  progress: number\n}\n\ntype SnapshotListener = (snapshot: SortSnapshot) => void\n\nfunction clamp(value: number, min: number, max: number): number {\n  return Math.max(min, Math.min(max, value))\n}\n\nfunction swap(values: number[], a: number, b: number) {\n  const temp = values[a]\n  values[a] = values[b]\n  values[b] = temp\n}\n\nexport class SortingLabEngine {\n  private canvas: HTMLCanvasElement\n  private ctx: CanvasRenderingContext2D\n\n  private values: number[] = []\n  private algorithm: SortAlgorithm = 'quick'\n  private distribution: Distribution = 'random'\n  private size = 120\n  private opsPerFrame = 80\n\n  private operations: SortOperation[] = []\n  private opIndex = 0\n  private dirty = true\n  private running = false\n  private done = false\n\n  private comparisons = 0\n  private swaps = 0\n\n  private highlightA = -1\n  private highlightB = -1\n  private highlightTtl = 0\n  private dirtyFrame = true\n  private backgroundGradient: CanvasGradient | null = null\n\n  private w = 1\n  private h = 1\n  private dpr = 1\n  private animationId = 0\n  private disposed = false\n  private resizeObserver: ResizeObserver | null = null\n  private snapshotListener: SnapshotListener | null = null\n  private snapshotDirty = true\n\n  constructor(private container: HTMLDivElement) {\n    this.canvas = document.createElement('canvas')\n    this.canvas.style.width = '100%'\n    this.canvas.style.height = '100%'\n    this.canvas.style.display = 'block'\n    container.appendChild(this.canvas)\n\n    const ctx = this.canvas.getContext('2d')\n    if (!ctx) {\n      throw new Error('Canvas 2D context is not available')\n    }\n    this.ctx = ctx\n\n    this.resizeCanvas()\n    this.shuffle('random')\n    this.initListeners()\n    this.requestFrame()\n  }\n\n  setAlgorithm(algorithm: SortAlgorithm) {\n    if (this.algorithm === algorithm) return\n    this.algorithm = algorithm\n    this.running = false\n    this.done = false\n    this.markDirty()\n  }\n\n  setDistribution(distribution: Distribution) {\n    if (this.distribution === distribution) return\n    this.shuffle(distribution)\n  }\n\n  setSize(size: number) {\n    const target = Math.round(clamp(size, 16, 360))\n    if (this.size === target) return\n    this.size = target\n    this.shuffle(this.distribution)\n  }\n\n  setSpeed(opsPerFrame: number) {\n    const next = Math.round(clamp(opsPerFrame, 1, 400))\n    if (this.opsPerFrame === next) return\n    this.opsPerFrame = next\n  }\n\n  shuffle(distribution: Distribution = this.distribution) {\n    this.distribution = distribution\n\n    const values = Array.from({ length: this.size }, (_, i) => i + 1)\n    if (distribution === 'random') {\n      for (let i = values.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1))\n        swap(values, i, j)\n      }\n    } else if (distribution === 'reversed') {\n      values.reverse()\n    } else {\n      const swaps = Math.max(1, Math.floor(this.size * 0.08))\n      for (let i = 0; i < swaps; i++) {\n        const a = Math.floor(Math.random() * values.length)\n        const b = Math.floor(Math.random() * values.length)\n        swap(values, a, b)\n      }\n    }\n\n    this.values = values\n    this.running = false\n    this.done = false\n    this.markDirty()\n  }\n\n  start() {\n    this.ensureOperations()\n    if (this.done) return\n    this.running = true\n    this.markSnapshotDirty()\n    this.markFrameDirty()\n  }\n\n  pause() {\n    if (!this.running) return\n    this.running = false\n    this.markSnapshotDirty()\n    this.markFrameDirty()\n  }\n\n  step(steps = 1) {\n    this.ensureOperations()\n    if (this.done) return\n    this.running = false\n    for (let i = 0; i < steps; i++) {\n      this.applyNextOperation()\n      if (this.done) break\n    }\n    this.markSnapshotDirty()\n    this.markFrameDirty()\n  }\n\n  getSnapshot(): SortSnapshot {\n    const total = this.operations.length\n    const progress = this.done ? 1 : total > 0 ? this.opIndex / total : 0\n    return {\n      running: this.running,\n      done: this.done,\n      algorithm: this.algorithm,\n      size: this.size,\n      distribution: this.distribution,\n      comparisons: this.comparisons,\n      swaps: this.swaps,\n      operations: this.opIndex,\n      totalOperations: total,\n      progress\n    }\n  }\n\n  setSnapshotListener(listener: SnapshotListener | null) {\n    this.snapshotListener = listener\n    this.snapshotDirty = true\n    this.flushSnapshot()\n  }\n\n  dispose() {\n    this.disposed = true\n    this.snapshotListener = null\n    if (this.animationId !== 0) {\n      cancelAnimationFrame(this.animationId)\n      this.animationId = 0\n    }\n    this.resizeObserver?.disconnect()\n    this.resizeObserver = null\n\n    if (this.canvas.parentElement) {\n      this.canvas.parentElement.removeChild(this.canvas)\n    }\n  }\n\n  private animate = () => {\n    if (this.disposed) return\n    this.animationId = 0\n\n    if (this.running) {\n      this.ensureOperations()\n      for (let i = 0; i < this.opsPerFrame; i++) {\n        this.applyNextOperation()\n        if (this.done) break\n      }\n    }\n\n    if (this.highlightTtl > 0) {\n      this.highlightTtl--\n      if (this.highlightTtl === 0) {\n        this.highlightA = -1\n        this.highlightB = -1\n        this.dirtyFrame = true\n      }\n    }\n\n    if (this.running || this.dirtyFrame) {\n      this.draw()\n      this.dirtyFrame = false\n    }\n    this.flushSnapshot()\n\n    if (this.running || this.highlightTtl > 0 || this.dirtyFrame) {\n      this.requestFrame()\n    }\n  }\n\n  private applyNextOperation() {\n    if (this.opIndex >= this.operations.length) {\n      this.running = false\n      this.done = true\n      this.markSnapshotDirty()\n      return\n    }\n\n    const op = this.operations[this.opIndex++]\n    this.highlightA = op.a\n    this.highlightB = op.b\n    this.highlightTtl = 6\n    this.dirtyFrame = true\n\n    if (op.type === 'compare') {\n      this.comparisons++\n    } else {\n      this.swaps++\n      swap(this.values, op.a, op.b)\n    }\n    this.markSnapshotDirty()\n\n    if (this.opIndex >= this.operations.length) {\n      this.running = false\n      this.done = true\n      this.markSnapshotDirty()\n    }\n  }\n\n  private draw() {\n    this.ctx.clearRect(0, 0, this.w, this.h)\n\n    if (!this.backgroundGradient) {\n      const bg = this.ctx.createLinearGradient(0, 0, 0, this.h)\n      bg.addColorStop(0, '#0f172a')\n      bg.addColorStop(0.45, '#111827')\n      bg.addColorStop(1, '#030712')\n      this.backgroundGradient = bg\n    }\n    this.ctx.fillStyle = this.backgroundGradient\n    this.ctx.fillRect(0, 0, this.w, this.h)\n\n    const n = this.values.length\n    if (n === 0) return\n\n    const barWidth = this.w / n\n    const gap = barWidth > 4 ? 1 : 0\n    const maxHeight = this.h - 18\n\n    for (let i = 0; i < n; i++) {\n      const value = this.values[i]\n      const t = value / n\n      const height = Math.max(3, t * maxHeight)\n      const x = i * barWidth + gap * 0.5\n      const y = this.h - height\n      const width = Math.max(1, barWidth - gap)\n\n      if (this.done) {\n        this.ctx.fillStyle = `hsl(${155 + t * 30} 70% ${46 + t * 14}%)`\n      } else if (i === this.highlightA) {\n        this.ctx.fillStyle = '#fb7185'\n      } else if (i === this.highlightB) {\n        this.ctx.fillStyle = '#22d3ee'\n      } else {\n        this.ctx.fillStyle = `hsl(${205 + t * 90} 72% ${38 + t * 20}%)`\n      }\n\n      this.ctx.fillRect(x, y, width, height)\n    }\n\n    this.ctx.strokeStyle = 'rgba(148, 163, 184, 0.2)'\n    this.ctx.lineWidth = 1\n    this.ctx.beginPath()\n    this.ctx.moveTo(0, this.h - 0.5)\n    this.ctx.lineTo(this.w, this.h - 0.5)\n    this.ctx.stroke()\n  }\n\n  private ensureOperations() {\n    if (!this.dirty) return\n\n    const working = [...this.values]\n    this.operations = this.generateOperations(working, this.algorithm)\n    this.opIndex = 0\n    this.comparisons = 0\n    this.swaps = 0\n    this.running = false\n    this.done = this.operations.length === 0\n    this.highlightA = -1\n    this.highlightB = -1\n    this.highlightTtl = 0\n    this.dirty = false\n    this.markSnapshotDirty()\n    this.markFrameDirty()\n  }\n\n  private generateOperations(values: number[], algorithm: SortAlgorithm): SortOperation[] {\n    if (algorithm === 'bubble') return this.buildBubbleOperations(values)\n    if (algorithm === 'selection') return this.buildSelectionOperations(values)\n    if (algorithm === 'insertion') return this.buildInsertionOperations(values)\n    return this.buildQuickOperations(values)\n  }\n\n  private buildBubbleOperations(values: number[]): SortOperation[] {\n    const ops: SortOperation[] = []\n    const n = values.length\n\n    for (let i = 0; i < n - 1; i++) {\n      for (let j = 0; j < n - i - 1; j++) {\n        ops.push({ type: 'compare', a: j, b: j + 1 })\n        if (values[j] > values[j + 1]) {\n          swap(values, j, j + 1)\n          ops.push({ type: 'swap', a: j, b: j + 1 })\n        }\n      }\n    }\n\n    return ops\n  }\n\n  private buildSelectionOperations(values: number[]): SortOperation[] {\n    const ops: SortOperation[] = []\n    const n = values.length\n\n    for (let i = 0; i < n - 1; i++) {\n      let minIndex = i\n      for (let j = i + 1; j < n; j++) {\n        ops.push({ type: 'compare', a: minIndex, b: j })\n        if (values[j] < values[minIndex]) {\n          minIndex = j\n        }\n      }\n      if (minIndex !== i) {\n        swap(values, i, minIndex)\n        ops.push({ type: 'swap', a: i, b: minIndex })\n      }\n    }\n\n    return ops\n  }\n\n  private buildInsertionOperations(values: number[]): SortOperation[] {\n    const ops: SortOperation[] = []\n    const n = values.length\n\n    for (let i = 1; i < n; i++) {\n      let j = i\n      while (j > 0) {\n        ops.push({ type: 'compare', a: j - 1, b: j })\n        if (values[j - 1] <= values[j]) break\n        swap(values, j - 1, j)\n        ops.push({ type: 'swap', a: j - 1, b: j })\n        j--\n      }\n    }\n\n    return ops\n  }\n\n  private buildQuickOperations(values: number[]): SortOperation[] {\n    const ops: SortOperation[] = []\n    const stack: Array<[number, number]> = [[0, values.length - 1]]\n\n    while (stack.length > 0) {\n      const range = stack.pop()\n      if (!range) continue\n      const [low, high] = range\n      if (low >= high) continue\n\n      const pivotIndex = this.partition(values, low, high, ops)\n      const leftSize = pivotIndex - 1 - low\n      const rightSize = high - (pivotIndex + 1)\n\n      if (leftSize > rightSize) {\n        stack.push([low, pivotIndex - 1])\n        stack.push([pivotIndex + 1, high])\n      } else {\n        stack.push([pivotIndex + 1, high])\n        stack.push([low, pivotIndex - 1])\n      }\n    }\n\n    return ops\n  }\n\n  private partition(values: number[], low: number, high: number, ops: SortOperation[]): number {\n    const pivot = values[high]\n    let i = low\n\n    for (let j = low; j < high; j++) {\n      ops.push({ type: 'compare', a: j, b: high })\n      if (values[j] < pivot) {\n        if (i !== j) {\n          swap(values, i, j)\n          ops.push({ type: 'swap', a: i, b: j })\n        }\n        i++\n      }\n    }\n\n    if (i !== high) {\n      swap(values, i, high)\n      ops.push({ type: 'swap', a: i, b: high })\n    }\n\n    return i\n  }\n\n  private markDirty() {\n    this.dirty = true\n    this.operations = []\n    this.opIndex = 0\n    this.comparisons = 0\n    this.swaps = 0\n    this.highlightA = -1\n    this.highlightB = -1\n    this.highlightTtl = 0\n    this.markSnapshotDirty()\n    this.markFrameDirty()\n  }\n\n  private markFrameDirty() {\n    this.dirtyFrame = true\n    this.requestFrame()\n  }\n\n  private markSnapshotDirty() {\n    this.snapshotDirty = true\n  }\n\n  private flushSnapshot() {\n    if (!this.snapshotDirty || !this.snapshotListener) return\n    this.snapshotListener(this.getSnapshot())\n    this.snapshotDirty = false\n  }\n\n  private requestFrame() {\n    if (this.disposed || this.animationId !== 0) return\n    this.animationId = requestAnimationFrame(this.animate)\n  }\n\n  private resizeCanvas() {\n    const rect = this.container.getBoundingClientRect()\n    this.w = Math.max(1, Math.floor(rect.width))\n    this.h = Math.max(1, Math.floor(rect.height))\n    this.dpr = Math.min(window.devicePixelRatio || 1, 2)\n\n    this.canvas.width = Math.floor(this.w * this.dpr)\n    this.canvas.height = Math.floor(this.h * this.dpr)\n    this.ctx.setTransform(this.dpr, 0, 0, this.dpr, 0, 0)\n    this.backgroundGradient = null\n    this.markFrameDirty()\n  }\n\n  private initListeners() {\n    this.resizeObserver = new ResizeObserver(() => this.resizeCanvas())\n    this.resizeObserver.observe(this.container)\n  }\n}\n"],"names":["clamp","value","min","max","Math","swap","values","a","b","temp","SortingLabEngine","container","algorithm","distribution","size","opsPerFrame","operations","opIndex","dirty","running","done","comparisons","swaps","highlightA","highlightB","highlightTtl","dirtyFrame","backgroundGradient","w","h","dpr","animationId","disposed","resizeObserver","snapshotListener","snapshotDirty","animate","this","ensureOperations","i","applyNextOperation","draw","flushSnapshot","requestFrame","canvas","document","createElement","style","width","height","display","appendChild","ctx","getContext","Error","resizeCanvas","shuffle","initListeners","_proto","prototype","setAlgorithm","markDirty","setDistribution","setSize","target","round","setSpeed","next","Array","from","length","_","floor","random","reverse","start","markSnapshotDirty","markFrameDirty","pause","step","steps","getSnapshot","total","progress","totalOperations","setSnapshotListener","listener","dispose","_this$resizeObserver","cancelAnimationFrame","disconnect","parentElement","removeChild","op","type","clearRect","bg","createLinearGradient","addColorStop","fillStyle","fillRect","n","barWidth","gap","maxHeight","t","x","y","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","working","_toConsumableArray","generateOperations","buildBubbleOperations","buildSelectionOperations","buildInsertionOperations","buildQuickOperations","ops","j","push","minIndex","stack","range","pop","low","high","pivotIndex","partition","pivot","requestAnimationFrame","rect","getBoundingClientRect","window","devicePixelRatio","setTransform","ResizeObserver","observe"],"sourceRoot":""}