"use strict";(self.webpackChunkjiunbae_github_io=self.webpackChunkjiunbae_github_io||[]).push([[358],{358:function(t,e,n){n.r(e),n.d(e,{ParticleGalaxyScene:function(){return d}});var o=n(546),i=n(3851),a=n(512),s=n(7855),r=n(4164),l=n(4797),c=n(6174);const h=8e4;let d=function(){function t(t){this.raycaster=new i.tBo,this.clock=new i.zD7,this.animationId=0,this.disposed=!1,this.attractorPositions=[],this.handleContextLost=t=>{t.preventDefault(),cancelAnimationFrame(this.animationId);const e=document.createElement("div");e.style.cssText="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.8);color:#fff;font:14px/1.5 sans-serif;cursor:pointer;z-index:100",e.textContent="WebGL context lost â€” click to reload",e.addEventListener("click",()=>location.reload()),this.container.style.position="relative",this.container.appendChild(e)},this.handleContextRestored=()=>{location.reload()},this.animate=()=>{if(this.disposed)return;this.animationId=requestAnimationFrame(this.animate);const t=this.clock.getElapsedTime();this.controls.update(),this.material&&(this.material.uniforms.uTime.value=t),this.composer.render()},this.onResize=()=>{if(this.disposed)return;const{clientWidth:t,clientHeight:e}=this.container;this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e),this.composer.setSize(t,e)},this.container=t,this.init(),this.createGalaxy(),this.animate()}var e=t.prototype;return e.addAttractor=function(t,e){if(this.attractorPositions.length>=12)return;const n=new i.I9Y(t,e);this.raycaster.setFromCamera(n,this.camera);const o=this.raycaster.intersectObject(this.galaxyPlane);if(0===o.length)return;const a=o[0].point;this.attractorPositions.push(a.clone()),this.syncAttractorUniforms()},e.clearAttractors=function(){this.attractorPositions=[],this.syncAttractorUniforms()},e.resetCamera=function(){this.camera&&this.controls&&(this.camera.position.set(0,35,45),this.controls.target.set(0,0,0),this.controls.update())},e.init=function(){const{clientWidth:t,clientHeight:e}=this.container;this.renderer=new a.JeP({antialias:!1,alpha:!1}),this.renderer.setSize(t,e),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.toneMapping=i.FV,this.renderer.toneMappingExposure=1,this.container.appendChild(this.renderer.domElement),this.renderer.domElement.addEventListener("webglcontextlost",this.handleContextLost),this.renderer.domElement.addEventListener("webglcontextrestored",this.handleContextRestored),this.scene=new i.Z58,this.scene.background=new i.Q1f(328976),this.scene.fog=new i.cRK(328976,.006),this.camera=new i.ubm(55,t/e,.1,500),this.camera.position.set(0,35,45),this.controls=new s.N(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.autoRotate=!0,this.controls.autoRotateSpeed=.3,this.controls.minDistance=10,this.controls.maxDistance=150,this.controls.maxPolarAngle=Math.PI/2.05,this.composer=new r.s(this.renderer),this.composer.addPass(new l.A(this.scene,this.camera)),this.bloomPass=new c.C(new i.I9Y(t,e),1.5,.6,.15),this.composer.addPass(this.bloomPass);const n=new i.bdM(200,200),o=new i.V9B({visible:!1});this.galaxyPlane=new i.eaF(n,o),this.galaxyPlane.rotation.x=-Math.PI/2,this.scene.add(this.galaxyPlane),window.addEventListener("resize",this.onResize)},e.createGalaxy=function(){const t=new Float32Array(24e4),e=new Float32Array(24e4),n=new Float32Array(h),o=new Float32Array(h),a=new Float32Array(h),s=new Float32Array(h);for(let i=0;i<h;i++){const r=Math.floor(4*Math.random())/4*Math.PI*2,l=Math.random(),c=4+36*Math.pow(l,.6),h=r+1.2*Math.log(1+c)+.45*this.gaussianRandom()*(c/40+.3),d=1.2*(1-c/40*.6),m=this.gaussianRandom()*d*.5;t[3*i+0]=Math.cos(h)*c,t[3*i+1]=m,t[3*i+2]=Math.sin(h)*c,e[3*i+0]=.6*(Math.random()-.5),e[3*i+1]=m,e[3*i+2]=.6*(Math.random()-.5),n[i]=.3+.7*Math.random(),c<6&&(n[i]+=.3),o[i]=.08/Math.sqrt(.5*c+1),a[i]=h,s[i]=c}const r=Math.floor(4e3);for(let i=0;i<r;i++){const r=i,l=4*Math.random(),c=Math.random()*Math.PI*2,h=1.2*this.gaussianRandom()*.8;t[3*r+0]=Math.cos(c)*l,t[3*r+1]=h,t[3*r+2]=Math.sin(c)*l,e[3*r+1]=h,n[r]=.5+.8*Math.random(),o[r]=.08*(.5+1.5*Math.random())/Math.sqrt(l+1),a[r]=c,s[r]=l}const l=new i.LoY;l.setAttribute("position",new i.THS(t,3)),l.setAttribute("aVelocity",new i.THS(e,3)),l.setAttribute("aMass",new i.THS(n,1)),l.setAttribute("aOrbitSpeed",new i.THS(o,1)),l.setAttribute("aPhase",new i.THS(a,1)),l.setAttribute("aRadius",new i.THS(s,1));const c=[];for(let h=0;h<12;h++)c.push(new i.Pq0(0,0,0));this.material=new i.BKk({transparent:!0,depthWrite:!1,blending:i.EZo,uniforms:{uTime:{value:0},uPixelRatio:{value:Math.min(window.devicePixelRatio,2)},uAttractors:{value:c},uAttractorCount:{value:0},uAttractorStrength:{value:120},uAttractorSoftening:{value:2}},vertexShader:"\n  uniform float uTime;\n  uniform float uPixelRatio;\n  uniform vec3  uAttractors[12];\n  uniform int   uAttractorCount;\n  uniform float uAttractorStrength;\n  uniform float uAttractorSoftening;\n\n  attribute vec3  aVelocity;\n  attribute float aMass;\n  attribute float aOrbitSpeed;\n  attribute float aPhase;\n  attribute float aRadius;\n\n  varying vec3 vColor;\n  varying float vAlpha;\n\n  /* Convert speed magnitude to a star colour (black-body inspired) */\n  vec3 speedToColor(float speed) {\n    // Slow (red/orange) -> medium (yellow/white) -> fast (blue/white)\n    float t = clamp(speed * 3.0, 0.0, 1.0);\n    vec3 cold = vec3(1.0, 0.35, 0.15);   // cool red-orange\n    vec3 warm = vec3(1.0, 0.85, 0.5);    // warm yellow\n    vec3 hot  = vec3(0.6, 0.75, 1.0);    // hot blue-white\n    vec3 col = mix(cold, warm, smoothstep(0.0, 0.4, t));\n    col = mix(col, hot, smoothstep(0.4, 1.0, t));\n    return col;\n  }\n\n  void main() {\n    /* ---- orbital motion ---- */\n    float angle = aPhase + uTime * aOrbitSpeed;\n    float r = aRadius;\n\n    /* base spiral position */\n    vec3 pos;\n    pos.x = cos(angle) * r;\n    pos.z = sin(angle) * r;\n    pos.y = aVelocity.y; // stored vertical offset\n\n    /* add wobble from initial velocity */\n    pos.x += sin(uTime * aVelocity.x * 0.5 + aPhase) * 0.3;\n    pos.z += cos(uTime * aVelocity.z * 0.5 + aPhase) * 0.3;\n\n    /* ---- gravitational attractors ---- */\n    vec3 totalAccel = vec3(0.0);\n    for (int i = 0; i < 12; i++) {\n      if (i >= uAttractorCount) break;\n      vec3 toAttractor = uAttractors[i] - pos;\n      float dist2 = dot(toAttractor, toAttractor) + uAttractorSoftening;\n      float force = uAttractorStrength / dist2;\n      totalAccel += normalize(toAttractor) * force;\n    }\n    pos += totalAccel * 0.02;\n\n    /* ---- velocity magnitude for colouring ---- */\n    float tangentialSpeed = aOrbitSpeed * r;\n    float attractorPull = length(totalAccel);\n    float speed = tangentialSpeed + attractorPull * 0.15;\n\n    vColor = speedToColor(speed);\n\n    /* brighter in core */\n    float coreBrightness = smoothstep(GALAXY_RADIUS, 0.0, r) * 0.4;\n    vColor += coreBrightness;\n\n    /* alpha: slightly fade outer particles */\n    vAlpha = 0.7 + 0.3 * smoothstep(GALAXY_RADIUS, 0.0, r);\n\n    /* ---- projection ---- */\n    vec4 mvPos = modelViewMatrix * vec4(pos, 1.0);\n    gl_Position = projectionMatrix * mvPos;\n\n    /* size: bigger when closer, smaller far away; mass affects size */\n    float baseSize = aMass * 1.8 + 0.8;\n    gl_PointSize = baseSize * uPixelRatio * (300.0 / -mvPos.z);\n    gl_PointSize = clamp(gl_PointSize, 0.5, 64.0);\n  }\n",fragmentShader:"\n  varying vec3 vColor;\n  varying float vAlpha;\n\n  void main() {\n    /* soft glow point-sprite */\n    float d = length(gl_PointCoord - 0.5);\n    if (d > 0.5) discard;\n\n    /* gaussian-ish glow */\n    float intensity = exp(-d * d * 8.0);\n\n    /* add a bright core with soft halo */\n    float core = smoothstep(0.15, 0.0, d);\n    vec3 col = vColor * intensity + vec3(1.0) * core * 0.3;\n\n    float alpha = intensity * vAlpha;\n    gl_FragColor = vec4(col, alpha);\n  }\n",defines:{GALAXY_RADIUS:40..toFixed(1)}}),this.points=new i.ONl(l,this.material),this.scene.add(this.points)},e.gaussianRandom=function(){let t=0,e=0;for(;0===t;)t=Math.random();for(;0===e;)e=Math.random();return Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*e)},e.syncAttractorUniforms=function(){if(!this.material)return;const t=this.material.uniforms.uAttractors.value;for(let e=0;e<12;e++)e<this.attractorPositions.length?t[e].copy(this.attractorPositions[e]):t[e].set(0,0,0);this.material.uniforms.uAttractorCount.value=this.attractorPositions.length},e.dispose=function(){this.disposed=!0,cancelAnimationFrame(this.animationId),window.removeEventListener("resize",this.onResize),this.controls.dispose(),this.points&&(this.points.geometry.dispose(),this.points.material.dispose()),this.scene.traverse(t=>{t instanceof i.eaF&&(t.geometry.dispose(),Array.isArray(t.material)?t.material.forEach(t=>t.dispose()):t.material.dispose())}),this.renderer.domElement.removeEventListener("webglcontextlost",this.handleContextLost),this.renderer.domElement.removeEventListener("webglcontextrestored",this.handleContextRestored),this.renderer.dispose(),this.composer.dispose(),this.renderer.domElement.parentElement&&this.renderer.domElement.parentElement.removeChild(this.renderer.domElement)},(0,o.A)(t,[{key:"autoRotate",get:function(){var t,e;return null===(t=null===(e=this.controls)||void 0===e?void 0:e.autoRotate)||void 0===t||t},set:function(t){this.controls&&(this.controls.autoRotate=t)}},{key:"bloomStrength",get:function(){var t,e;return null!==(t=null===(e=this.bloomPass)||void 0===e?void 0:e.strength)&&void 0!==t?t:1.5},set:function(t){this.bloomPass&&(this.bloomPass.strength=t)}},{key:"particleCount",get:function(){return h}},{key:"attractorCount",get:function(){return this.attractorPositions.length}}])}()}}]);
//# sourceMappingURL=358-3b17d4edc943abbeca6f.js.map